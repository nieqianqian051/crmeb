{"remainingRequest":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/components/uploadImg/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/components/uploadImg/index.vue","mtime":1719468447000},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":1746465018509},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/babel-loader/lib/index.js","mtime":1746465024347},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":1746465018509},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js","mtime":1746465019530}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IGdldENhdGVnb3J5TGlzdEFwaSwgbW92ZUFwaSwgb25saW5lVXBsb2FkLCBzY2FuVXBsb2FkQ29kZSwgdXBsb2FkSW1hZ2VzIH0gZnJvbSAnQC9hcGkvdXBsb2FkUGljdHVyZXMnOwppbXBvcnQgU2V0dGluZyBmcm9tICdAL3NldHRpbmcnOwppbXBvcnQgeyBnZXRDb29raWVzIH0gZnJvbSAnQC9saWJzL3V0aWwnOwppbXBvcnQgeyBzY2FuVXBsb2FkUXJjb2RlLCBzY2FuVXBsb2FkR2V0IH0gZnJvbSAnQC9hcGkvc2V0dGluZyc7CmltcG9ydCBRUkNvZGUgZnJvbSAncXJjb2RlanMyJzsKaW1wb3J0IGNvbXByZXNzSW1nIGZyb20gJ0AvdXRpbHMvY29tcHJlc3NJbWcuanMnOwppbXBvcnQgeyBpc1BpY1VwbG9hZCB9IGZyb20gJ0AvdXRpbHMvaW5kZXgnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJycsCiAgcHJvcHM6IHsKICAgIGNhdGVnb3J5TGlzdDogewogICAgICBkZWZhdWx0OiAoKSA9PiB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgICB9LAogICAgfSwKICAgIGNhdGVnb3J5SWQ6IHsKICAgICAgZGVmYXVsdDogJycsCiAgICB9LAogICAgaXNQYWdlOiB7CiAgICAgIGRlZmF1bHQ6IGZhbHNlLAogICAgfSwKICAgIGlzSWZyYW1lOiB7CiAgICAgIGRlZmF1bHQ6IGZhbHNlLAogICAgfSwKICB9LAogIHdhdGNoOiB7CiAgICB1cGxvYWRNb2RhbDogewogICAgICBoYW5kbGVyKG5ld1ZhbCkgewogICAgICAgIGlmIChuZXdWYWwpIHRoaXMucnVsZUZvcm0ucmVnaW9uID0gdGhpcy5jYXRlZ29yeUlkOwogICAgICB9LAogICAgICBpbW1lZGlhdGU6IHRydWUsCiAgICB9LAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHdlYkltZ1VybDogJycsCiAgICAgIHVwbG9hZE1vZGFsOiBmYWxzZSwKICAgICAgZmlsZVVybDogU2V0dGluZy5hcGlCYXNlVVJMICsgJy9maWxlL3VwbG9hZCcsCiAgICAgIGhlYWRlcjogewogICAgICAgICdBdXRob3JpLXphdGlvbic6ICdCZWFyZXIgJyArIGdldENvb2tpZXMoJ3Rva2VuJyksCiAgICAgIH0sCiAgICAgIHVwbG9hZERhdGE6IHt9LAogICAgICBwcm9wczogeyBjaGVja1N0cmljdGx5OiB0cnVlLCBlbWl0UGF0aDogZmFsc2UsIGxhYmVsOiAndGl0bGUnLCB2YWx1ZTogJ2lkJyB9LAogICAgICBkaXNhYmxlZDogZmFsc2UsCiAgICAgIHJ1bGVGb3JtOiB7CiAgICAgICAgdHlwZTogMCwKICAgICAgICByZWdpb246ICcnLAogICAgICAgIGltZ0xpc3Q6IFtdLAogICAgICB9LAogICAgICBydWxlczogeyB0eXBlOiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+mAieaLqea0u+WKqOi1hOa6kCcsIHRyaWdnZXI6ICdjaGFuZ2UnIH1dIH0sCiAgICAgIHFyY29kZTogJycsCiAgICAgIHNjYW5Ub2tlbjogJycsCiAgICAgIGxpbWl0OiAyMCwKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIHRpbWU6IHVuZGVmaW5lZCwKICAgIH07CiAgfSwKICBjcmVhdGVkKCkge30sCiAgbW91bnRlZCgpIHt9LAogIGJlZm9yZURlc3Ryb3koKSB7CiAgICBjbGVhckludGVydmFsKHRoaXMudGltZSk7CiAgICB0aGlzLnRpbWUgPSB1bmRlZmluZWQ7CiAgfSwKICBtZXRob2RzOiB7CiAgICByYWRpb0NoYW5nZSh0eXBlKSB7CiAgICAgIHRoaXMucnVsZUZvcm0udHlwZSA9IHR5cGU7CiAgICAgIHRoaXMucnVsZUZvcm0uaW1nTGlzdCA9IFtdOwogICAgICBjbGVhckludGVydmFsKHRoaXMudGltZSk7CiAgICAgIHRoaXMudGltZSA9IHVuZGVmaW5lZDsKICAgICAgaWYgKHR5cGUgPT0gMikgewogICAgICAgIHRoaXMuc2NhblVwbG9hZFFyY29kZSgpOwogICAgICAgIHRoaXMudGltZSA9IHNldEludGVydmFsKChlKSA9PiB7CiAgICAgICAgICB0aGlzLnNjYW5VcGxvYWRHZXQoKTsKICAgICAgICB9LCAyMDAwKTsKICAgICAgfQogICAgfSwKICAgIHNjYW5VcGxvYWRRcmNvZGUoKSB7CiAgICAgIHNjYW5VcGxvYWRRcmNvZGUodGhpcy5ydWxlRm9ybS5yZWdpb24pLnRoZW4oKHJlcykgPT4gewogICAgICAgIHRoaXMuY3JlYXRRckNvZGUocmVzLmRhdGEudXJsKTsKICAgICAgICB0aGlzLnNjYW5Ub2tlbiA9IHJlcy5kYXRhLnVybDsKICAgICAgfSk7CiAgICB9LAogICAgc2NhblVwbG9hZEdldCgpIHsKICAgICAgbGV0IHRva2VuID0gdGhpcy5zY2FuVG9rZW4uc3BsaXQoJ3Rva2VuPScpWzFdOwogICAgICBzY2FuVXBsb2FkR2V0KHRva2VuKS50aGVuKChyZXMpID0+IHsKICAgICAgICB0aGlzLnJ1bGVGb3JtLmltZ0xpc3QgPSByZXMuZGF0YTsKICAgICAgfSk7CiAgICB9LAoKICAgIGdldEltZygpIHsKICAgICAgaWYgKCF0aGlzLndlYkltZ1VybCkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+ivt+WFiOi+k+WFpeWbvueJh+WcsOWdgCcpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAodGhpcy53ZWJJbWdVcmwuaW5kZXhPZignLnBocCcpICE9IC0xKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign6K+35YWI6L6T5YWl5YW25LuW5Zu+54mH5Zyw5Z2AJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMucnVsZUZvcm0uaW1nTGlzdC5wdXNoKHsKICAgICAgICB1cmw6IHRoaXMud2ViSW1nVXJsLAogICAgICB9KTsKICAgIH0sCiAgICBhc3luYyBzdWJtaXRVcGxvYWQoKSB7CiAgICAgIGlmICghdGhpcy5ydWxlRm9ybS5pbWdMaXN0Lmxlbmd0aCkgcmV0dXJuIHRoaXMuJG1lc3NhZ2Uud2FybmluZygn6K+35YWI6YCJ5oup5Zu+54mHJyk7CiAgICAgIGlmICh0aGlzLnJ1bGVGb3JtLnR5cGUgPT0gMCkgewogICAgICAgIHRoaXMudXBsb2FkRGF0YSA9IHsKICAgICAgICAgIHBpZDogdGhpcy5ydWxlRm9ybS5yZWdpb24sCiAgICAgICAgfTsKICAgICAgICBpZiAodGhpcy5ydWxlRm9ybS5pbWdMaXN0Lmxlbmd0aCkgewogICAgICAgICAgaWYgKHRoaXMubG9hZGluZykgcmV0dXJuOwogICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5ydWxlRm9ybS5pbWdMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnJ1bGVGb3JtLmltZ0xpc3RbaV0ucmF3OwogICAgICAgICAgICBhd2FpdCB0aGlzLnVwbG9hZEl0ZW0oZmlsZSk7CiAgICAgICAgICAgIGlmIChpID09IHRoaXMucnVsZUZvcm0uaW1nTGlzdC5sZW5ndGggLSAxKSB7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfkuIrkvKDmiJDlip8nKTsKICAgICAgICAgICAgICB0aGlzLiRlbWl0KCd1cGxvYWRTdWNjZXNzJyk7CiAgICAgICAgICAgICAgdGhpcy51cGxvYWRNb2RhbCA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMuaW5pdERhdGEoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh0aGlzLnJ1bGVGb3JtLnR5cGUgPT0gMSkgewogICAgICAgIGxldCB1cmxzID0gdGhpcy5ydWxlRm9ybS5pbWdMaXN0Lm1hcCgoZSkgPT4gewogICAgICAgICAgcmV0dXJuIGUudXJsOwogICAgICAgIH0pOwogICAgICAgIGlmICh1cmxzLmxlbmd0aCkgewogICAgICAgICAgaWYgKHRoaXMubG9hZGluZykgcmV0dXJuOwogICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgICAgIG9ubGluZVVwbG9hZCh7IHBpZDogdGhpcy5ydWxlRm9ybS5yZWdpb24sIGltYWdlczogdXJscyB9KQogICAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5LiK5Lyg5oiQ5YqfJyk7CiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCd1cGxvYWRTdWNjZXNzJyk7CiAgICAgICAgICAgICAgICB0aGlzLnVwbG9hZE1vZGFsID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHRoaXMuaW5pdERhdGEoKTsKICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoZXJyLm1zZyk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMucnVsZUZvcm0udHlwZSA9PSAyKSB7CiAgICAgICAgbGV0IGF0dElkID0gdGhpcy5ydWxlRm9ybS5pbWdMaXN0Lm1hcCgoZSkgPT4gewogICAgICAgICAgcmV0dXJuIGUuYXR0X2lkOwogICAgICAgIH0pOwogICAgICAgIG1vdmVBcGkoeyBwaWQ6IHRoaXMucnVsZUZvcm0ucmVnaW9uLCBpbWFnZXM6IGF0dElkIH0pLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfkuIrkvKDmiJDlip8nKTsKICAgICAgICAgIHRoaXMuJGVtaXQoJ3VwbG9hZFN1Y2Nlc3MnKTsKICAgICAgICAgIHRoaXMudXBsb2FkTW9kYWwgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuaW5pdERhdGEoKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIHVwbG9hZEl0ZW0oZmlsZSkgewogICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCd1cGxvYWRGaWxlcycsIGZpbGUpCiAgICAgICAgdXBsb2FkSW1hZ2VzKGZvcm1EYXRhKQogICAgICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgICAgaWYgKHJlcy5jb2RlID09IDIwMCkgewogICAgICAgICAgICAgICAgLy8gdGhpcy4kZW1pdCgndXBsb2FkSW1nU3VjY2VzcycsIHJlcy5kYXRhKTsKICAgICAgICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ+S4iuS8oOWksei0pScsCiAgICAgICAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsCiAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAxMDAwLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgICAgICAuY2F0Y2goKGVycikgPT4gewogICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoZXJyLm1zZyk7CiAgICAgICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBiZWZvcmVVcGxvYWQoZmlsZSkgewogICAgICBjb25zb2xlLmxvZyhmaWxlKTsKICAgIH0sCiAgICBjcmVhdFFyQ29kZSh1cmwpIHsKICAgICAgdGhpcy4kcmVmcy5xckNvZGVVcmwuaW5uZXJIVE1MID0gJyc7CiAgICAgIHZhciBxcmNvZGUgPSBuZXcgUVJDb2RlKHRoaXMuJHJlZnMucXJDb2RlVXJsLCB7CiAgICAgICAgdGV4dDogdXJsLCAvLyDpnIDopoHovazmjaLkuLrkuoznu7TnoIHnmoTlhoXlrrkKICAgICAgICB3aWR0aDogMTYwLAogICAgICAgIGhlaWdodDogMTYwLAogICAgICAgIGNvbG9yRGFyazogJyMwMDAwMDAnLAogICAgICAgIGNvbG9yTGlnaHQ6ICcjZmZmZmZmJywKICAgICAgICBjb3JyZWN0TGV2ZWw6IFFSQ29kZS5Db3JyZWN0TGV2ZWwuSCwKICAgICAgfSk7CiAgICB9LAogICAgaGFuZGxlV2ViUmVtb3ZlKGZpbGUpIHsKICAgICAgbGV0IGluZGV4ID0gdGhpcy5ydWxlRm9ybS5pbWdMaXN0LmZpbmRJbmRleCgoZSkgPT4gewogICAgICAgIHJldHVybiBlLnVybCA9PSBmaWxlLnVybDsKICAgICAgfSk7CiAgICAgIHRoaXMucnVsZUZvcm0uaW1nTGlzdC5zcGxpY2UoaW5kZXgsIDEpOwogICAgfSwKICAgIGhhbmRsZVJlbW92ZShpbmRleCkgewogICAgICB0aGlzLnJ1bGVGb3JtLmltZ0xpc3Quc3BsaWNlKGluZGV4LCAxKTsKICAgIH0sCiAgICBoYW5kbGVQaWN0dXJlQ2FyZFByZXZpZXcoZmlsZSkgewogICAgICB0aGlzLmRpYWxvZ0ltYWdlVXJsID0gZmlsZS51cmw7CiAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IHRydWU7CiAgICB9LAogICAgaGFuZGxlRG93bmxvYWQoZmlsZSkgewogICAgICBjb25zb2xlLmxvZyhmaWxlKTsKICAgIH0sCiAgICBhc3luYyBmaWxlQ2hhbmdlKGZpbGUsIGZpbGVMaXN0KSB7CiAgICAgIGlmIChpc1BpY1VwbG9hZChmaWxlKSkgewogICAgICAgIGlmIChmaWxlLnNpemUgPj0gMjA5NzE1MikgewogICAgICAgICAgYXdhaXQgdGhpcy5jb21JbWcoZmlsZS5yYXcpLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICBmaWxlTGlzdC5tYXAoKGUpID0+IHsKICAgICAgICAgICAgICBpZiAoZS51aWQgPT09IGZpbGUudWlkKSB7CiAgICAgICAgICAgICAgICBlLnJhdyA9IHJlczsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGlzLnJ1bGVGb3JtLmltZ0xpc3QgPSBmaWxlTGlzdDsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnJ1bGVGb3JtLmltZ0xpc3QgPSBmaWxlTGlzdDsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8g5LuOcnVsZUZvcm3lr7nosaHnmoRpbWdMaXN05pWw57uE5Lit5Yig6Zmk5pyA5ZCO5LiA5Liq5YWD57SgCiAgICAgICAgdGhpcy5ydWxlRm9ybS5pbWdMaXN0LnNwbGljZSh0aGlzLnJ1bGVGb3JtLmltZ0xpc3QubGVuZ3RoLCAxKTsKICAgICAgfQogICAgfSwKICAgIGNvbUltZyhmaWxlKSB7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgICAgY29tcHJlc3NJbWcoZmlsZSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICByZXNvbHZlKHJlcyk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIGxvYWREYXRhKGl0ZW0sIGNhbGxiYWNrKSB7CiAgICAgIC8vIGdldENhdGVnb3J5TGlzdEFwaSh7CiAgICAgIC8vICAgcGlkOiBpdGVtLnZhbHVlLAogICAgICAvLyB9KQogICAgICAvLyAgIC50aGVuKGFzeW5jIChyZXMpID0+IHsKICAgICAgLy8gICAgIGNvbnN0IGRhdGEgPSByZXMuZGF0YS5saXN0OwogICAgICAvLyAgICAgY2FsbGJhY2soZGF0YSk7CiAgICAgIC8vICAgfSkKICAgICAgLy8gICAuY2F0Y2goKHJlcykgPT4ge30pOwogICAgfSwKICAgIGhhbmRsZUNoYW5nZShlKSB7CiAgICAgIGlmICh0aGlzLnJ1bGVGb3JtLnR5cGUgPT0gMikgdGhpcy5zY2FuVXBsb2FkUXJjb2RlKCk7CiAgICB9LAogICAgLy8g56e75YqoCiAgICBoYW5kbGVEcmFnU3RhcnQoZSwgaXRlbSkgewogICAgICB0aGlzLmRyYWdnaW5nID0gaXRlbTsKICAgIH0sCiAgICBoYW5kbGVEcmFnRW5kKGUsIGl0ZW0pIHsKICAgICAgdGhpcy5kcmFnZ2luZyA9IG51bGw7CiAgICB9LAogICAgaGFuZGxlRHJhZ092ZXIoZSkgewogICAgICBlLmRhdGFUcmFuc2Zlci5kcm9wRWZmZWN0ID0gJ21vdmUnOwogICAgfSwKICAgIGhhbmRsZURyYWdFbnRlcihlLCBpdGVtKSB7CiAgICAgIGUuZGF0YVRyYW5zZmVyLmVmZmVjdEFsbG93ZWQgPSAnbW92ZSc7CiAgICAgIGlmIChpdGVtID09PSB0aGlzLmRyYWdnaW5nKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNvbnN0IG5ld0l0ZW1zID0gWy4uLnRoaXMucnVsZUZvcm0uaW1nTGlzdF07CiAgICAgIGNvbnN0IHNyYyA9IG5ld0l0ZW1zLmluZGV4T2YodGhpcy5kcmFnZ2luZyk7CiAgICAgIGNvbnN0IGRzdCA9IG5ld0l0ZW1zLmluZGV4T2YoaXRlbSk7CiAgICAgIG5ld0l0ZW1zLnNwbGljZShkc3QsIDAsIC4uLm5ld0l0ZW1zLnNwbGljZShzcmMsIDEpKTsKICAgICAgdGhpcy5ydWxlRm9ybS5pbWdMaXN0ID0gbmV3SXRlbXM7CiAgICB9LAogICAgY2xvc2VkKCkgewogICAgICB0aGlzLmluaXREYXRhKCk7CiAgICAgIC8vIHNjYW5VcGxvYWRDb2RlKCkudGhlbigocmVzKSA9PiB7fSk7CiAgICB9LAogICAgY2xlYXIoKSB7CiAgICAgIHRoaXMudXBsb2FkTW9kYWwgPSBmYWxzZTsKICAgICAgdGhpcy5pbml0RGF0YSgpOwogICAgfSwKICAgIGluaXREYXRhKCkgewogICAgICB0aGlzLnJ1bGVGb3JtLnR5cGUgPSAwOwogICAgICB0aGlzLnJ1bGVGb3JtLnJlZ2lvbiA9IDA7CiAgICAgIHRoaXMuc2NhblRva2VuID0gJyc7CiAgICAgIHRoaXMud2ViSW1nVXJsID0gJyc7CiAgICAgIHRoaXMucnVsZUZvcm0uaW1nTGlzdCA9IFtdOwogICAgICBjbGVhckludGVydmFsKHRoaXMudGltZSk7CiAgICAgIHRoaXMudGltZSA9IHVuZGVmaW5lZDsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAmIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/uploadImg","sourcesContent":["<template>\n  <div>\n    <el-dialog\n        title=\"上传图片\"\n        :visible.sync=\"uploadModal\"\n        :append-to-body=\"true\"\n        :width=\"isIframe ? '100%' : '1024px'\"\n        :fullscreen=\"isIframe\"\n        @close=\"closed\"\n    >\n      <div class=\"main\" v-loading=\"loading\">\n        <el-form :model=\"ruleForm\" :rules=\"rules\" ref=\"ruleForm\" label-width=\"100px\" class=\"demo-ruleForm\">\n          <el-form-item label=\"上传方式：\" prop=\"type\">\n            <el-radio-group v-model=\"ruleForm.type\" @input=\"radioChange(ruleForm.type)\">\n              <el-radio :label=\"0\">本地上传</el-radio>\n              <!--   <el-radio :label=\"1\">网络上传</el-radio>\n                 <el-radio :label=\"2\">扫码上传</el-radio> -->\n            </el-radio-group>\n          </el-form-item>\n          <!--       <el-form-item label=\"上传至分组：\" prop=\"region\" v-show=\"ruleForm.type == 0 || ruleForm.type == 1\">\n                   <el-cascader\n                     class=\"form-width\"\n                     v-model=\"ruleForm.region\"\n                     :props=\"props\"\n                     :options=\"categoryList\"\n                     @change=\"handleChange\"\n                   ></el-cascader>\n                 </el-form-item> -->\n          <!--          <el-form-item label=\"网络图片：\" prop=\"region\" v-if=\"ruleForm.type == 1\">\n                      <el-input class=\"form-width\" v-model=\"webImgUrl\" placeholder=\"请网络图片地址\"></el-input>\n                      <span class=\"tq-text\" @click=\"getImg\">提取照片</span>\n                    </el-form-item> -->\n          <el-form-item label=\"上传图片：\" prop=\"region\" v-if=\"ruleForm.type == 0\">\n            <div class=\"acea-row\">\n              <div class=\"uploadCont\">\n                <el-upload\n                    ref=\"upload\"\n                    :action=\"fileUrl\"\n                    list-type=\"picture-card\"\n                    :on-change=\"fileChange\"\n                    :file-list=\"ruleForm.imgList\"\n                    :auto-upload=\"false\"\n                    :data=\"uploadData\"\n                    :headers=\"header\"\n                    :multiple=\"true\"\n                    :limit=\"limit\"\n                >\n                  <i slot=\"default\" class=\"el-icon-plus\"></i>\n                  <div\n                      slot=\"file\"\n                      slot-scope=\"{ file }\"\n                      draggable=\"false\"\n                      @dragstart=\"handleDragStart($event, file)\"\n                      @dragover=\"handleDragOver($event, file)\"\n                      @dragenter=\"handleDragEnter($event, file)\"\n                      @dragend=\"handleDragEnd($event, file)\"\n                  >\n                    <img class=\"el-upload-list__item-thumbnail\" :src=\"file.url\" alt=\"\" />\n                    <i class=\"el-icon-error btndel\" @click=\"handleWebRemove(file)\" />\n                  </div>\n                </el-upload>\n                <div class=\"tips\">建议上传图片最大宽度750px，不超过3MB；仅支持jpeg、png格式，可拖拽调整上传顺序</div>\n              </div>\n            </div>\n          </el-form-item>\n          <template v-if=\"ruleForm.type == 1\">\n            <div class=\"img-box pl100\">\n              <div\n                  v-for=\"(item, index) in ruleForm.imgList\"\n                  :key=\"index\"\n                  class=\"pictrue\"\n                  draggable=\"false\"\n                  @dragstart=\"handleDragStart($event, item)\"\n                  @dragover.prevent=\"handleDragOver($event, item)\"\n                  @dragenter=\"handleDragEnter($event, item)\"\n                  @dragend=\"handleDragEnd($event, item)\"\n              >\n                <img :src=\"item.url\" />\n                <i class=\"el-icon-error btndel\" @click=\"handleRemove(index)\" />\n              </div>\n            </div>\n          </template>\n          <!--       <div class=\"code-image\" v-if=\"ruleForm.type == 2\">\n                   <div class=\"left\">\n                     <el-form-item label=\"上传至分组：\" prop=\"region\">\n                       <el-cascader\n                         class=\"form-width\"\n                         v-model=\"ruleForm.region\"\n                         :props=\"props\"\n                         :options=\"categoryList\"\n                         @change=\"handleChange\"\n                       ></el-cascader>\n                     </el-form-item>\n                     <el-form-item label=\"二维码：\" prop=\"region\">\n                       <div class=\"code\" ref=\"qrCodeUrl\"></div>\n                       <div class=\"trip\">扫描二维码，快速上传手机图片</div>\n                       <div class=\"trip-small\">建议使用手机浏览器</div>\n                     </el-form-item>\n                   </div>\n                   <div class=\"right\">\n                     <el-button size=\"small\" @click=\"scanUploadGet\">刷新图库</el-button>\n                     <div class=\"tip\">刷新图库按钮，可显示移动端上传成功的图片</div>\n                     <div class=\"img-box\">\n                       <div\n                         v-for=\"(item, index) in ruleForm.imgList\"\n                         :key=\"index\"\n                         class=\"pictrue\"\n                         draggable=\"false\"\n                         @dragstart=\"handleDragStart($event, item)\"\n                         @dragover.prevent=\"handleDragOver($event, item)\"\n                         @dragenter=\"handleDragEnter($event, item)\"\n                         @dragend=\"handleDragEnd($event, item)\"\n                       >\n                         <img :src=\"item.att_dir\" />\n                         <i class=\"el-icon-error btndel\" @click=\"handleWebRemove(item)\" />\n                       </div>\n                     </div>\n                   </div>\n                 </div> -->\n        </el-form>\n      </div>\n\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"clear\">取 消</el-button>\n        <el-button type=\"primary\" :disabled=\"!ruleForm.imgList.length\" @click=\"submitUpload\">确 定</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { getCategoryListApi, moveApi, onlineUpload, scanUploadCode, uploadImages } from '@/api/uploadPictures';\nimport Setting from '@/setting';\nimport { getCookies } from '@/libs/util';\nimport { scanUploadQrcode, scanUploadGet } from '@/api/setting';\nimport QRCode from 'qrcodejs2';\nimport compressImg from '@/utils/compressImg.js';\nimport { isPicUpload } from '@/utils/index';\nexport default {\n  name: '',\n  props: {\n    categoryList: {\n      default: () => {\n        return [];\n      },\n    },\n    categoryId: {\n      default: '',\n    },\n    isPage: {\n      default: false,\n    },\n    isIframe: {\n      default: false,\n    },\n  },\n  watch: {\n    uploadModal: {\n      handler(newVal) {\n        if (newVal) this.ruleForm.region = this.categoryId;\n      },\n      immediate: true,\n    },\n  },\n  data() {\n    return {\n      webImgUrl: '',\n      uploadModal: false,\n      fileUrl: Setting.apiBaseURL + '/file/upload',\n      header: {\n        'Authori-zation': 'Bearer ' + getCookies('token'),\n      },\n      uploadData: {},\n      props: { checkStrictly: true, emitPath: false, label: 'title', value: 'id' },\n      disabled: false,\n      ruleForm: {\n        type: 0,\n        region: '',\n        imgList: [],\n      },\n      rules: { type: [{ required: true, message: '请选择活动资源', trigger: 'change' }] },\n      qrcode: '',\n      scanToken: '',\n      limit: 20,\n      loading: false,\n      time: undefined,\n    };\n  },\n  created() {},\n  mounted() {},\n  beforeDestroy() {\n    clearInterval(this.time);\n    this.time = undefined;\n  },\n  methods: {\n    radioChange(type) {\n      this.ruleForm.type = type;\n      this.ruleForm.imgList = [];\n      clearInterval(this.time);\n      this.time = undefined;\n      if (type == 2) {\n        this.scanUploadQrcode();\n        this.time = setInterval((e) => {\n          this.scanUploadGet();\n        }, 2000);\n      }\n    },\n    scanUploadQrcode() {\n      scanUploadQrcode(this.ruleForm.region).then((res) => {\n        this.creatQrCode(res.data.url);\n        this.scanToken = res.data.url;\n      });\n    },\n    scanUploadGet() {\n      let token = this.scanToken.split('token=')[1];\n      scanUploadGet(token).then((res) => {\n        this.ruleForm.imgList = res.data;\n      });\n    },\n\n    getImg() {\n      if (!this.webImgUrl) {\n        this.$message.error('请先输入图片地址');\n        return;\n      }\n      if (this.webImgUrl.indexOf('.php') != -1) {\n        this.$message.error('请先输入其他图片地址');\n        return;\n      }\n      this.ruleForm.imgList.push({\n        url: this.webImgUrl,\n      });\n    },\n    async submitUpload() {\n      if (!this.ruleForm.imgList.length) return this.$message.warning('请先选择图片');\n      if (this.ruleForm.type == 0) {\n        this.uploadData = {\n          pid: this.ruleForm.region,\n        };\n        if (this.ruleForm.imgList.length) {\n          if (this.loading) return;\n          this.loading = true;\n          for (let i = 0; i < this.ruleForm.imgList.length; i++) {\n            const file = this.ruleForm.imgList[i].raw;\n            await this.uploadItem(file);\n            if (i == this.ruleForm.imgList.length - 1) {\n              this.$message.success('上传成功');\n              this.$emit('uploadSuccess');\n              this.uploadModal = false;\n              this.loading = false;\n              this.initData();\n            }\n          }\n        }\n      } else if (this.ruleForm.type == 1) {\n        let urls = this.ruleForm.imgList.map((e) => {\n          return e.url;\n        });\n        if (urls.length) {\n          if (this.loading) return;\n          this.loading = true;\n          onlineUpload({ pid: this.ruleForm.region, images: urls })\n              .then((res) => {\n                this.$message.success('上传成功');\n                this.$emit('uploadSuccess');\n                this.uploadModal = false;\n                this.loading = false;\n                this.initData();\n              })\n              .catch((err) => {\n                this.loading = false;\n                this.$message.error(err.msg);\n              });\n        }\n      } else if (this.ruleForm.type == 2) {\n        let attId = this.ruleForm.imgList.map((e) => {\n          return e.att_id;\n        });\n        moveApi({ pid: this.ruleForm.region, images: attId }).then((res) => {\n          this.$message.success('上传成功');\n          this.$emit('uploadSuccess');\n          this.uploadModal = false;\n          this.initData();\n        });\n      }\n    },\n    uploadItem(file) {\n      return new Promise((resolve, reject) => {\n        const formData = new FormData();\n        formData.append('uploadFiles', file)\n        uploadImages(formData)\n            .then((res) => {\n              if (res.code == 200) {\n                // this.$emit('uploadImgSuccess', res.data);\n                resolve();\n              } else {\n                this.loading = false;\n                this.$message({\n                  message: '上传失败',\n                  type: 'error',\n                  duration: 1000,\n                });\n              }\n            })\n            .catch((err) => {\n              this.loading = false;\n              this.$message.error(err.msg);\n            });\n      });\n    },\n    beforeUpload(file) {\n      console.log(file);\n    },\n    creatQrCode(url) {\n      this.$refs.qrCodeUrl.innerHTML = '';\n      var qrcode = new QRCode(this.$refs.qrCodeUrl, {\n        text: url, // 需要转换为二维码的内容\n        width: 160,\n        height: 160,\n        colorDark: '#000000',\n        colorLight: '#ffffff',\n        correctLevel: QRCode.CorrectLevel.H,\n      });\n    },\n    handleWebRemove(file) {\n      let index = this.ruleForm.imgList.findIndex((e) => {\n        return e.url == file.url;\n      });\n      this.ruleForm.imgList.splice(index, 1);\n    },\n    handleRemove(index) {\n      this.ruleForm.imgList.splice(index, 1);\n    },\n    handlePictureCardPreview(file) {\n      this.dialogImageUrl = file.url;\n      this.dialogVisible = true;\n    },\n    handleDownload(file) {\n      console.log(file);\n    },\n    async fileChange(file, fileList) {\n      if (isPicUpload(file)) {\n        if (file.size >= 2097152) {\n          await this.comImg(file.raw).then((res) => {\n            fileList.map((e) => {\n              if (e.uid === file.uid) {\n                e.raw = res;\n              }\n            });\n            this.ruleForm.imgList = fileList;\n          });\n        } else {\n          this.ruleForm.imgList = fileList;\n        }\n      } else {\n        // 从ruleForm对象的imgList数组中删除最后一个元素\n        this.ruleForm.imgList.splice(this.ruleForm.imgList.length, 1);\n      }\n    },\n    comImg(file) {\n      return new Promise((resolve, reject) => {\n        compressImg(file).then((res) => {\n          resolve(res);\n        });\n      });\n    },\n    loadData(item, callback) {\n      // getCategoryListApi({\n      //   pid: item.value,\n      // })\n      //   .then(async (res) => {\n      //     const data = res.data.list;\n      //     callback(data);\n      //   })\n      //   .catch((res) => {});\n    },\n    handleChange(e) {\n      if (this.ruleForm.type == 2) this.scanUploadQrcode();\n    },\n    // 移动\n    handleDragStart(e, item) {\n      this.dragging = item;\n    },\n    handleDragEnd(e, item) {\n      this.dragging = null;\n    },\n    handleDragOver(e) {\n      e.dataTransfer.dropEffect = 'move';\n    },\n    handleDragEnter(e, item) {\n      e.dataTransfer.effectAllowed = 'move';\n      if (item === this.dragging) {\n        return;\n      }\n      const newItems = [...this.ruleForm.imgList];\n      const src = newItems.indexOf(this.dragging);\n      const dst = newItems.indexOf(item);\n      newItems.splice(dst, 0, ...newItems.splice(src, 1));\n      this.ruleForm.imgList = newItems;\n    },\n    closed() {\n      this.initData();\n      // scanUploadCode().then((res) => {});\n    },\n    clear() {\n      this.uploadModal = false;\n      this.initData();\n    },\n    initData() {\n      this.ruleForm.type = 0;\n      this.ruleForm.region = 0;\n      this.scanToken = '';\n      this.webImgUrl = '';\n      this.ruleForm.imgList = [];\n      clearInterval(this.time);\n      this.time = undefined;\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n::v-deep .el-dialog__title {\n  font-size: 16px;\n}\n.main {\n  min-height: 410px;\n}\n.pictrue {\n  width: 60px !important;\n  height: 60px !important;\n  border: 1px dotted rgba(0, 0, 0, 0.1);\n  margin-right: 10px;\n  position: relative;\n  cursor: pointer;\n\n  img {\n    width: 100%;\n    height: 100%;\n  }\n}\n.btndel {\n  position: absolute;\n  z-index: 1;\n  font-size: 18px;\n  right: -5px;\n  top: -5px;\n  color: #999;\n}\n.form-width {\n  width: 280px;\n}\n.tq-text {\n  margin-left: 14px;\n  font-size: 12px;\n  font-weight: 400;\n  color: var(--prev-color-primary);\n  cursor: pointer;\n}\n.uploadCont ::v-deep .el-upload--picture-card,\n::v-deep .el-upload-list--picture-card .el-upload-list__item {\n  width: 64px;\n  height: 64px;\n  line-height: 72px;\n  overflow: inherit;\n}\n.uploadCont ::v-deep .el-upload--picture-card,\n::v-deep .el-upload-list--picture-card .el-upload-list__item img {\n  width: 64px !important;\n  height: 64px !important;\n  border-radius: 6px;\n  object-fit: cover;\n}\n.pl100 {\n  padding-left: 100px;\n}\n.img-box {\n  display: flex;\n  flex-wrap: wrap;\n}\n.tips {\n  font-size: 12px;\n  color: #bbbbbb;\n}\n.code-image {\n  display: flex;\n  margin-top: 12px;\n  .left {\n    display: flex;\n    flex-direction: column;\n    margin-right: 20px;\n    align-items: center;\n    .code {\n      border: 1px solid #dddddd;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 200px;\n      height: 200px;\n      border-radius: 4px;\n      .code-img {\n        width: 160px;\n        height: 160px;\n      }\n    }\n    .form-width {\n      width: 200px;\n    }\n    .code {\n      margin-bottom: 14px;\n    }\n    .trip {\n      color: #333333;\n      text-align: center;\n      line-height: 18px;\n    }\n    .trip-small {\n      font-size: 12px;\n      font-weight: 400;\n      color: #bbbbbb;\n      text-align: center;\n      line-height: 16px;\n    }\n  }\n  .right {\n    margin-top: 62px;\n    .tip {\n      font-size: 12px;\n      font-weight: 400;\n      color: #bbbbbb;\n      margin: 10px 0;\n    }\n  }\n}\n</style>\n"]}]}