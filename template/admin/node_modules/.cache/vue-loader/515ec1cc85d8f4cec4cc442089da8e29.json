{"remainingRequest":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/pages/kefu/pc/components/msgWindow.vue?vue&type=style&index=1&id=0805965c&lang=css","dependencies":[{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/pages/kefu/pc/components/msgWindow.vue","mtime":1719467759000},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/css-loader/index.js","mtime":1746465018503},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1746465020031},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/postcss-loader/src/index.js","mtime":1746465019371},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":1746465018509},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js","mtime":1746465019530}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CkBrZXlmcmFtZXMgbXltb3ZlIHsKICAwJSB7CiAgICBoZWlnaHQ6IDA7CiAgfQogIDEwMCUgewogICAgaGVpZ2h0OiAxNTBweDsKICB9Cn0K"},{"version":3,"sources":["msgWindow.vue"],"names":[],"mappings":";AA+sBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"msgWindow.vue","sourceRoot":"src/pages/kefu/pc/components","sourcesContent":["<template>\n  <div class=\"msg-box\">\n    <div class=\"head\">\n      <div class=\"tab-bar\">\n        <a\n          href=\"javascript:;\"\n          class=\"tab-item\"\n          :class=\"{ on: item.key == tabCur }\"\n          v-for=\"(item, index) in tabList\"\n          :key=\"index\"\n          @click=\"bindTab(item)\"\n          >{{ item.title }}</a\n        >\n      </div>\n      <div class=\"search-box\">\n        <el-input placeholder=\"搜索快捷回复\" style=\"width: 100%\" v-model=\"searchTxt\" />\n      </div>\n    </div>\n    <div class=\"main\">\n      <div class=\"left-box\">\n        <vue-scroll :ops=\"ops\">\n          <div class=\"left-item\" v-if=\"tabCur\">\n            <p>分组</p>\n            <span class=\"iconfont iconaddto\" @click=\"openAddSort\"></span>\n          </div>\n          <div\n            class=\"left-item\"\n            v-for=\"(item, index) in sortList\"\n            :key=\"index\"\n            :class=\"{ on: cateId == item.id }\"\n            @click=\"selectSort(item)\"\n          >\n            <p>{{ item.name }}</p>\n            <template v-if=\"tabCur\">\n              <span class=\"iconfont iconDot\" @click.top=\"bindEdit(item, scope.$index)\"></span>\n\n              <div class=\"edit-wrapper\" v-show=\"item.isEdit\">\n                <div class=\"edit-item\" @click=\"editSort(item)\">编辑</div>\n                <div class=\"edit-item\" @click=\"delSort(item, '删除分类', scope.$index)\">删除</div>\n              </div>\n              <div class=\"edit-bg\" v-show=\"item.isEdit\" @click.stop=\"item.isEdit = false\"></div>\n            </template>\n          </div>\n        </vue-scroll>\n      </div>\n      <div class=\"right-box\">\n        <div v-infinite-scroll=\"handleReachBottom\" class=\"right-scroll\">\n          <div class=\"msg-item add-box\" v-if=\"tabCur\" style=\"margin-top: 0\">\n            <div class=\"box2\">\n              <el-input\n                class=\"input-box\"\n                v-model=\"addMsg.title\"\n                placeholder=\"输入标题（选填）\"\n                style=\"width: 100%\"\n                @on-focus=\"bindFocus\"\n              />\n              <div class=\"conBox\" :class=\"{ active: addMsg.isEdit }\">\n                <div class=\"content\">\n                  <el-input v-model=\"addMsg.message\" type=\"textarea\" :rows=\"4\" placeholder=\"请输入内容\" />\n                </div>\n                <div class=\"bom\">\n                  <div class=\"select\">\n                    <el-select v-model=\"addMsg.cateId\" style=\"width: 100px\" size=\"small\">\n                      <el-option v-for=\"item in sortList\" :value=\"item.id\" :key=\"item.id\">{{ item.name }} </el-option>\n                    </el-select>\n                  </div>\n                  <div class=\"btns-box\">\n                    <el-button @click.stop=\"addMsg.isEdit = false\">取消</el-button>\n                    <el-button type=\"primary\" @click.stop=\"bindAdd\">保存</el-button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"msg-item\" v-for=\"(item, index) in list\" :key=\"index\" v-if=\"item.id\">\n            <div class=\"box1\" v-if=\"!item.isEdit\">\n              <div class=\"txt-box\" @click=\"bindRadio(item)\">\n                <span class=\"title\" v-if=\"item.title\">{{ item.title | filtersTitle }}</span>\n                <span v-if=\"item.message\">{{ item.message | filtersCon }}</span>\n              </div>\n              <div class=\"edit-box\" v-if=\"tabCur\">\n                <span class=\"iconfont iconbianji\" @click.stop=\"editMsg(item)\"></span>\n                <span class=\"iconfont iconshanchu\" @click.stop=\"delMsg(item, '删除话术', index)\"></span>\n              </div>\n            </div>\n            <div class=\"box2\" v-else>\n              <el-input class=\"input-box\" v-model=\"item.title\" placeholder=\"输入标题（选填）\" style=\"width: 100%\" />\n              <div class=\"content\">\n                <el-input v-model=\"item.message\" type=\"textarea\" :rows=\"4\" placeholder=\"请输入内容\" />\n              </div>\n              <div class=\"bom\">\n                <div class=\"select\">\n                  <el-select v-model=\"cateId\" style=\"width: 100px\" size=\"small\">\n                    <el-option v-for=\"item in sortList\" :value=\"item.id\" :key=\"item.id\" :label=\"item.name\"></el-option>\n                  </el-select>\n                </div>\n                <div class=\"btns-box\">\n                  <el-button @click.stop=\"item.isEdit = false\">取消</el-button>\n                  <el-button type=\"primary\" @click.stop=\"updataMsg(item)\">保存</el-button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <el-dialog :visible.sync=\"isAddSort\" :title=\"maskTitle\" width=\"304px\" class=\"class-box\">\n      <div class=\"item\">\n        <span>分组名称：</span>\n        <el-input v-model=\"classTitle\" placeholder=\"分组名称\" />\n      </div>\n      <div class=\"item\">\n        <span>分组排序：</span>\n        <el-input v-model=\"classSort\" placeholder=\"输入排序\" />\n      </div>\n      <div class=\"btn\"></div>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button type=\"primary\" @click=\"addServiceCate\">确定</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport {\n  speeChcraft,\n  serviceCate,\n  serviceCateUpdate,\n  addSpeeChcraft,\n  addServiceCate,\n  editServiceCate,\n} from '@/api/kefu';\nexport default {\n  name: 'msgWindow',\n  data() {\n    return {\n      ops: {\n        vuescroll: {\n          mode: 'native',\n          enable: false,\n          tips: {\n            deactive: 'Push to Load',\n            active: 'Release to Load',\n            start: 'Loading...',\n            beforeDeactive: 'Load Successfully!',\n          },\n          auto: false,\n          autoLoadDistance: 0,\n          pullRefresh: {\n            enable: false,\n          },\n          pushLoad: {\n            enable: false,\n            auto: true,\n            autoLoadDistance: 10,\n          },\n        },\n        bar: {\n          background: '#393232',\n          opacity: '.5',\n          size: '2px',\n        },\n      },\n      isScroll: true,\n      page: 1,\n      limit: 15,\n      tabCur: 1,\n      tabList: [\n        {\n          title: '个人库',\n          key: 1,\n        },\n        {\n          title: '公共库',\n          key: 0,\n        },\n      ],\n      searchTxt: '', // 搜索\n      list: [\n        {\n          isEdit: false,\n        },\n      ], // 列表\n      model1: '',\n      msgTitle: '', // 填写的标题\n      sortList: [], // 分类\n      cateId: '', // 选中的id\n      addMsg: {\n        title: '',\n        message: '',\n        cateId: '',\n        isEdit: false,\n      },\n      isAddSort: false, // 添加分类\n      classTitle: '', // 分类名称\n      classSort: '', // 分类排序\n      maskTitle: '', // 弹窗标题\n      editObj: {}, // 编辑分类对象\n    };\n  },\n  filters: {\n    filtersTitle(val) {\n      let len = 37;\n      if (val.length > len) {\n        let data = val.substring(0, len);\n        return `${data}...`;\n      } else {\n        return val;\n      }\n    },\n    filtersCon(val) {\n      let len = 113;\n      if (val.length > len) {\n        let data = val.substring(0, len);\n        return `${data}...`;\n      } else {\n        return val;\n      }\n    },\n  },\n  mounted() {\n    let self = this;\n    this.serviceCate();\n    this.$nextTick(() => {\n      this.scroll = new BScroll(this.$refs.wrapper, {\n        mouseWheel: {\n          speed: 20,\n          invert: false,\n          easeTime: 300,\n        },\n        scrollbar: true,\n        disableMouse: true,\n        // and so on\n      });\n    });\n  },\n  methods: {\n    // 打开编辑\n    editMsg(item) {\n      item.isEdit = true;\n      this.cateId = item.cate_id;\n    },\n    // 编辑框\n    bindEdit(item, index) {\n      //   if (index == 0) {\n      //     return;\n      //   } else {\n      item.isEdit = !item.isEdit;\n      //   }\n    },\n    // 头部选择\n    bindTab(item) {\n      this.tabCur = item.key;\n      this.cateId = '';\n      this.sortList = [];\n      this.isScroll = true;\n      this.page = 1;\n      this.list = [];\n      this.serviceCate();\n    },\n    // 搜索\n    bindSearch() {\n      this.isScroll = true;\n      this.page = 1;\n      this.list = [];\n      this.getList();\n    },\n    // 选择分类\n    selectSort(item) {\n      if (this.cateId == item.id) {\n        return;\n      }\n      this.sortList.forEach((el, index) => {\n        if (el.id != item.id) {\n          el.isEdit = false;\n        }\n      });\n      this.cateId = item.id;\n      this.isScroll = true;\n      this.page = 1;\n      this.list = [];\n      this.getList();\n    },\n    // 删除分类\n    delSort(row, tit, num) {\n      let delfromData = {\n        title: tit,\n        num: num,\n        url: `/service/cate/${row.id}`,\n        method: 'DELETE',\n        ids: '',\n        kefu: true,\n      };\n      this.$modalSure(delfromData)\n        .then((res) => {\n          this.$message.success(res.msg);\n          this.isScroll = true;\n          this.page = 1;\n          this.list = [];\n          this.cateId = '';\n          this.serviceCate();\n        })\n        .catch((res) => {\n          this.$message.error(res.msg);\n        });\n    },\n    // 获取分类\n    serviceCate() {\n      serviceCate({\n        type: this.tabCur,\n      }).then((res) => {\n        let obj = {\n          id: '',\n          name: '全部',\n        };\n        res.data.data.forEach((el, index) => {\n          el.isEdit = false;\n        });\n        // res.data.data.unshift(obj)\n        this.sortList = res.data.data;\n        if (this.cateId === '') {\n          this.cateId = res.data.data[0].id;\n        }\n        this.getList();\n      });\n    },\n    // 获取列表\n    getList() {\n      if (!this.isScroll) return;\n      speeChcraft({\n        page: this.page,\n        limit: this.limit,\n        title: this.searchTxt,\n        cate_id: this.cateId,\n        type: this.tabCur,\n      }).then((res) => {\n        this.isScroll = res.data.length >= this.limit;\n        res.data.forEach((el, index) => {\n          el.isEdit = false;\n        });\n        this.page++;\n        this.list = this.list.concat(res.data);\n      });\n    },\n    // 修改话术\n    updataMsg(item) {\n      serviceCateUpdate(item.id, {\n        title: item.title,\n        cate_id: this.cateId,\n        message: item.message,\n      })\n        .then((res) => {\n          this.$message.success('修改成功');\n          item.isEdit = false;\n        })\n        .catch((error) => {\n          this.$message.error(error.msg);\n          item.isEdit = true;\n        });\n    },\n    // 添加框显示\n    bindFocus() {\n      this.list.forEach((el, item) => {\n        el.isEdit = false;\n      });\n      this.addMsg.isEdit = true;\n    },\n    // 打开添加窗口\n    openAddSort() {\n      this.isAddSort = true;\n      this.maskTitle = '添加分组';\n      this.editObj.id = 0;\n    },\n    // 添加话术\n    bindAdd() {\n      addSpeeChcraft({\n        title: this.addMsg.title,\n        cate_id: this.addMsg.cateId,\n        message: this.addMsg.message,\n      })\n        .then((res) => {\n          this.addMsg.title = '';\n          this.addMsg.message = '';\n          this.addMsg.cateId = '';\n          this.addMsg.isEdit = false;\n          this.$message.success(res.msg);\n          res.data.isEdit = false;\n          this.page = 1;\n          this.list = [];\n          this.isScroll = true;\n          this.serviceCate();\n        })\n        .catch((error) => {\n          this.$message.error(error.msg);\n        });\n    },\n    // 删除\n    delMsg(row, tit, num, type) {\n      let delfromData = {\n        title: tit,\n        num: num,\n        url: `service/speechcraft/${row.id}`,\n        method: 'DELETE',\n        ids: '',\n        kefu: true,\n      };\n      this.$modalSure(delfromData)\n        .then((res) => {\n          this.$message.success(res.msg);\n          this.list.splice(num, 1);\n        })\n        .catch((res) => {\n          this.$message.error(res.msg);\n        });\n    },\n    // 添加分类\n    addServiceCate() {\n      if (this.editObj.id) {\n        editServiceCate(this.editObj.id, {\n          name: this.classTitle,\n          sort: this.classSort,\n        })\n          .then((res) => {\n            this.classTitle = '';\n            this.classSort = '';\n            this.$message.success(res.msg);\n            this.isAddSort = false;\n            this.page = 1;\n            this.list = [];\n            this.isScroll = true;\n            this.serviceCate();\n          })\n          .catch((error) => {\n            this.classTitle = '';\n            this.classSort = '';\n            this.$message.error(error.msg);\n          });\n      } else {\n        addServiceCate({\n          name: this.classTitle,\n          sort: this.classSort,\n        })\n          .then((res) => {\n            this.classTitle = '';\n            this.classSort = '';\n            this.$message.success(res.msg);\n            this.isAddSort = false;\n            this.page = 1;\n            this.list = [];\n            this.isScroll = true;\n            this.serviceCate();\n          })\n          .catch((error) => {\n            this.classTitle = '';\n            this.classSort = '';\n            this.$message.error(error.msg);\n          });\n      }\n    },\n    // 编辑分类\n    editSort(item) {\n      this.classSort = item.sort;\n      this.classTitle = item.name;\n      this.isAddSort = true;\n      this.maskTitle = '编辑分组';\n      this.editObj = item;\n    },\n    handleReachBottom() {\n      this.getList();\n    },\n    bindRadio(data) {\n      this.$emit('activeTxt', data.message);\n    },\n  },\n};\n</script>\n\n<style lang=\"stylus\" scoped>\n.head {\n\n  .tab-bar {\n    display: flex;\n\n    .tab-item {\n      margin-right: 24px;\n      color: #999;\n      font-size: 14px;\n      font-weight: 500;\n\n      &.on {\n        color: #333333;\n      }\n    }\n  }\n\n  .search-box {\n    margin-top: 15px;\n  }\n}\n\n.main {\n  display: flex;\n  margin-top: 15px;\n  height: 365px;\n\n  .left-box {\n    width: 106px;\n    height: 100%;\n    border-right: 1px solid #ECECEC;\n    overflow: hidden;\n\n    .left-item {\n      position: relative;\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      height: 36px;\n      padding: 0 10px 0 14px;\n      font-size: 13px;\n      cursor: pointer;\n\n      &.on {\n        background: #F0FAFE;\n        color: var(--prev-color-primary);\n        border-right: 2px solid var(--prev-color-primary);\n\n        .iconDot {\n          z-index: 1;\n          opacity: 1;\n        }\n      }\n\n      &:nth-child(1).on, &:nth-child(2).on {\n        .iconDot {\n          display: none;\n        }\n      }\n\n      .iconaddto {\n        font-size: 12px;\n      }\n\n      .iconDot {\n        z-index: -1;\n        opacity: 0;\n      }\n\n      .edit-wrapper {\n        z-index: 50;\n        position: absolute;\n        right: -2px;\n        top: -4px;\n        background: #fff;\n        width: 80px;\n        box-shadow: 0 1px 6px rgba(0, 0, 0, 0.2);\n        border-radius: 4px;\n\n        .edit-item {\n          padding: 8px 16px;\n          color: #666 !important;\n          cursor: pointer;\n        }\n      }\n\n      .edit-bg {\n        z-index: 40;\n        position: fixed;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        background: transparent;\n      }\n    }\n  }\n\n  .right-box {\n    flex: 1;\n    padding: 0 12px;\n    overflow-x: hidden;\n\n    .msg-item {\n      margin-top: 12px;\n      transition: all 0.3s ease;\n      cursor: pointer;\n\n      .box1 {\n        position: relative;\n        display: flex;\n\n        .txt-box {\n          flex: 1;\n          font-size: 12px;\n          color: #999999;\n\n          .title {\n            max-width: 370px;\n            margin-right: 5px;\n            color: #333;\n            font-weight: 700;\n          }\n        }\n\n        .edit-box {\n          z-index: -1;\n          opacity: 0;\n          position: absolute;\n          right: 7px;\n          top: 0;\n          width: 60px;\n          height: 30px;\n          background: #fff;\n\n          .iconfont {\n            margin: 0 8px;\n            color: #000000;\n            font-size: 16px;\n            cursor: pointer;\n          }\n        }\n      }\n\n      .box2 {\n        padding-bottom: 15px;\n        border-radius: 5px;\n        background: #F5F5F5;\n\n        .input-box {\n          border-bottom: 1px solid #EEEEEE;\n\n          ::v-deep .ivu-input {\n            background: transparent;\n            border: 0;\n            border-radius: 0;\n          }\n        }\n\n        .content {\n          font-size: 12px;\n          padding: 12px 11px 0;\n          color: #333333;\n        }\n\n        .bom {\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          padding: 0 20px 0 11px;\n          margin-top: 10px;\n\n          button {\n            margin-left: 8px;\n            width: 70px;\n          }\n        }\n      }\n\n      &:hover {\n        transition: all 0.3s ease;\n\n        .box1 .edit-box {\n          z-index: 1;\n          opacity: 1;\n          transition: all 0.3s ease;\n        }\n      }\n    }\n\n    .add-box {\n      border-radius: 0;\n      margin-bottom: 10px;\n\n      .box2 {\n        padding-bottom: 0;\n        border-radius: 0;\n\n        .conBox {\n          height: 0;\n          overflow: hidden;\n\n          &.active {\n            animation: mymove 0.4s ease;\n            animation-iteration-count: 1;\n            animation-fill-mode: forwards;\n          }\n        }\n      }\n    }\n  }\n}\n\n.right-scroll {\n  ::v-deep .ivu-scroll-container .ivu-scroll-loader:nth-child(1) {\n    display: none;\n  }\n}\n\n.class-box {\n  .item {\n    display: flex;\n    align-items: center;\n    margin-bottom: 20px;\n\n    &:last-child {\n      margin-bottom: 0;\n    }\n\n    input {\n      flex: 1;\n    }\n\n    span {\n      width: 80px;\n      font-size: 12px;\n    }\n  }\n}\n</style>\n<style>\n@keyframes mymove {\n  0% {\n    height: 0;\n  }\n  100% {\n    height: 150px;\n  }\n}\n</style>\n"]}]}