{"remainingRequest":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/components/wangEditor/index.vue?vue&type=style&index=0&id=465675e3&lang=stylus&scoped=true","dependencies":[{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/components/wangEditor/index.vue","mtime":1720711269000},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/css-loader/index.js","mtime":1746465018503},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1746465020031},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/postcss-loader/src/index.js","mtime":1746465019371},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/stylus-loader/index.js","mtime":1746465207601},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":1746465018509},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js","mtime":1746465019530}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5ib3R0b20gewogIG1hcmdpbi1ib3R0b206IDEwcHg7CiAgY3Vyc29yOiBwb2ludGVyOwp9CgoubW9uYWNvLWJveCA6OnYtZGVlcCAuZWwtdGV4dGFyZWFfX2lubmVyIHsKICBoZWlnaHQ6IDYwMHB4Owp9Cgo6OnYtZGVlcCAudy1lLXRvb2xiYXIgewogIHotaW5kZXg6IDIgIWltcG9ydGFudDsKfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAyNA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/wangEditor","sourcesContent":["<template>\n  <div>\n    <div v-show=\"!monacoBox\">\n      <div ref=\"wang-editor\" class=\"wang-editor\" />\n    </div>\n    <div v-if=\"monacoBox\">\n      <el-button type=\"primary\" class=\"bottom\" @click=\"getHtmlint\" v-if=\"content\">可视化界面</el-button>\n      <monaco class=\"monaco-box\" @change=\"changeValue\" :value=\"newHtml\" />\n    </div>\n\n    <el-dialog :visible.sync=\"modalPic\" width=\"1024px\" title=\"上传图片\" :close-on-click-modal=\"false\">\n      <uploadPictures v-if=\"modalPic\" :isChoice=\"isChoice\" @getPic=\"getPic\" @getPicD=\"getPicD\"></uploadPictures>\n    </el-dialog>\n\n\n\n    <el-dialog :visible.sync=\"modalVideo\" width=\"720px\" title=\"上传视频\" :close-on-click-modal=\"false\">\n      <uploadVideo v-if=\"modalVideo\" @getVideo=\"getvideo\"></uploadVideo>\n    </el-dialog>\n  </div>\n</template>\n<script>\nimport monaco from './monaco';\nimport E from 'wangeditor';\nimport AlertMenu from './editor';\nimport HtmlMenu from './html';\nimport uploadPictures from '@/components/uploadPictures';\nimport uploadVideo from '@/components/uploadVideo2';\nimport { getCookies } from '@/libs/util';\n\nimport util from '../../utils/bus';\n\nexport default {\n  name: 'Index',\n  components: {\n    uploadPictures,\n    uploadVideo,\n    monaco,\n  },\n  props: {\n    content: {\n      type: String,\n      default: '',\n    },\n  },\n\n  data() {\n    return {\n      monacoBox: false,\n      value: '',\n      modalPic: false,\n      isChoice: '多选',\n      picTit: 'danFrom',\n      img: '',\n      modalVideo: false,\n      editor: null,\n      uploadSize: 2,\n      video: '',\n\n      // header: {\n      //   \"Authori-zation\": \"Bearer \" + getCookies(\"token\"),\n      // },\n    };\n  },\n  watch: {\n    content(val) {\n      this.editor.txt.html(val);\n    },\n  },\n  created() {\n    // window.getvideoint = this.getvideoint;\n    // window.getHtmlint = this.getHtmlint;\n  },\n  mounted() {\n    this.createEditor();\n    util.$on('Video', (Video) => {\n      this.getvideoint();\n    });\n    util.$on('Html', (Html) => {\n      this.getHtmlint();\n    });\n  },\n\n  methods: {\n    changeValue(value) {\n      this.newHtml = value;\n      this.$emit('editorContent', value);\n\n      this.$emit('input', value);\n    },\n    // 获取多张图信息\n    getPic(pc) {\n      let _this = this;\n      _this.img = pc.att_dir;\n      _this.modalPic = false;\n      this.editor.cmd.do('insertHTML', `<img src=\"${_this.img}\" style=\"max-width:100%;\"/>`);\n    },\n    getimg() {\n      this.modalPic = true;\n      this.isChoice = '多选';\n    },\n    getvideoint() {\n      this.modalVideo = true;\n    },\n    getHtmlint() {\n      if(this.content){\n        this.monacoBox = !this.monacoBox;\n        this.value = this.newHtml;\n        if (!this.monacoBox) {\n          this.editor.txt.html(this.newHtml);\n        }\n      }\n    },\n    getPicD(data) {\n      let _this = this;\n      _this.modalPic = false;\n\n      data.map((d) => {\n        this.editor.cmd.do('insertHTML', `<img src=\"${d.url}\" style=\"max-width:100%;\"/>`);\n      });\n    },\n    getvideo(data) {\n      let _this = this;\n      _this.modalVideo = false;\n      this.video = data;\n      let videoHTML =\n          '<video src=\"' + this.video + '\" controls style=\"max-width:100%;min-height:500rpx\"></video><p><br></p>';\n      this.editor.cmd.do('insertHTML', videoHTML);\n    },\n\n    createEditor() {\n      let _this = this;\n      const menuKey = 'alertMenuKey';\n      const html = 'alertHtml';\n      this.editor = new E(this.$refs['wang-editor']);\n\n      this.editor.menus.extend(menuKey, AlertMenu);\n      this.editor.menus.extend(html, HtmlMenu);\n      this.editor.config.menus = this.editor.config.menus.concat(html);\n      this.editor.config.menus = this.editor.config.menus.concat(menuKey);\n      this.editor.config.uploadImgFromMedia = function () {\n        _this.getimg();\n      };\n      // this.editor.config.uploadVideoHeaders = _this.header;\n      this.editor.config.height = 600;\n      this.editor.config.menus = [\n        'alertHtml',\n        'head',\n        'bold',\n        'fontSize',\n        'fontName',\n        'italic',\n        'underline',\n        'strikeThrough',\n        'indent',\n        'lineHeight',\n        'foreColor',\n        'backColor',\n        'link',\n        'list',\n        \"todo\",\n        'justify',\n        'quote',\n        'emoticon',\n        'image',\n        'alertMenuKey',\n        \"table\",\n        'code',\n        'splitLine',\n      ];\n\t  this.editor.config.css = ['./wangEditor.css']\n\t  // 或者直接在这里添加样式规则\n\t  this.editor.config.onchange = html => {\n\t    // 这里可以动态的修改样式\n\t    document.querySelector('.w-e-text-container').style.fontFamily = \"'Medium', 'Regular'\"\n\t  }\n\t  // 配置字体\n\t  this.editor.config.fontNames = [\n\t\t  'Medium',\n\t\t  'Regular',\n\t      '黑体',\n\t      '仿宋',\n\t      '楷体',\n\t      '标楷体',\n\t      '华文仿宋',\n\t      '华文楷体',\n\t      '宋体',\n\t      '微软雅黑',\n\t      'Arial',\n\t      'Tahoma',\n\t      'Verdana',\n\t      'Times New Roman',\n\t      'Courier New',\n\t  ]\n      // 配置全屏功能按钮是否展示\n      //   this.editor.config.showFullScreen = false\n      this.editor.config.uploadImgShowBase64 = false;\n      //   this.editor.config.uploadImgAccept = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp']\n      this.editor.config.zIndex = 0;\n      //   this.editor.config.uploadImgMaxSize = this.uploadSize * 1024 * 1024\n      this.editor.config.compatibleMode = () => {\n        // 返回 true 表示使用兼容模式；返回 false 使用标准模式\n        return true;\n      };\n      this.editor.config.onchange = (newHtml) => {\n        this.newHtml = newHtml;\n        this.$emit('editorContent', newHtml);\n      };\n      this.editor.config.onchangeTimeout = 300; // change后多久更新数据\n\n      this.editor.create();\n    },\n  },\n};\n</script>\n\n<style lang=\"stylus\" scoped>\n.bottom {\n  margin-bottom: 10px;\n  cursor: pointer;\n}\n\n.monaco-box ::v-deep .el-textarea__inner {\n  height: 600px;\n}\n\n::v-deep .w-e-toolbar {\n  z-index: 2 !important;\n}\n</style>\n"]}]}