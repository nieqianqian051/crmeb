{"remainingRequest":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/pages/statistic/user/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/pages/statistic/user/index.vue","mtime":1719467759000},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":1746465018509},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/babel-loader/lib/index.js","mtime":1746465024347},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":1746465018509},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js","mtime":1746465019530}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB1c2VySW5mbyBmcm9tICcuL2NvbXBvbmVudHMvdXNlckluZm8nOwppbXBvcnQgd2VjaGV0SW5mbyBmcm9tICcuL2NvbXBvbmVudHMvd2VjaGV0SW5mbyc7CmltcG9ydCB1c2VyUmVnaW9uIGZyb20gJy4vY29tcG9uZW50cy91c2VyUmVnaW9uJzsKaW1wb3J0IHsgc3RhdGlzdGljVXNlckV4Y2VsIH0gZnJvbSAnQC9hcGkvc3RhdGlzdGljJzsKaW1wb3J0IHsgZm9ybWF0RGF0ZSB9IGZyb20gJ0AvdXRpbHMvdmFsaWRhdGUnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ2luZGV4JywKICBjb21wb25lbnRzOiB7CiAgICB1c2VySW5mbywKICAgIHdlY2hldEluZm8sCiAgICB1c2VyUmVnaW9uLAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGZvcm1JbmxpbmU6IHsKICAgICAgICBjaGFubmVsX3R5cGU6ICcnLAogICAgICAgIGRhdGE6ICcnLAogICAgICB9LAogICAgICBjaGFubmVsX3R5cGU6ICdhbGwnLAogICAgICB0aW1lVmFsOiBbXSwKICAgICAgaXNTaG93OiBmYWxzZSwKICAgICAgcGlja2VyT3B0aW9uczogdGhpcy4kdGltZU9wdGlvbnMsCiAgICB9OwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKCk7CiAgICBjb25zdCBzdGFydCA9IG5ldyBEYXRlKCk7CiAgICBzdGFydC5zZXRUaW1lKHN0YXJ0LnNldFRpbWUobmV3IERhdGUobmV3IERhdGUoKS5nZXRGdWxsWWVhcigpLCBuZXcgRGF0ZSgpLmdldE1vbnRoKCksIG5ldyBEYXRlKCkuZ2V0RGF0ZSgpIC0gMjkpKSk7CiAgICB0aGlzLnRpbWVWYWwgPSBbc3RhcnQsIGVuZF07CiAgICB0aGlzLmZvcm1JbmxpbmUuZGF0YSA9IGZvcm1hdERhdGUoc3RhcnQsICd5eXl5L01NL2RkJykgKyAnLScgKyBmb3JtYXREYXRlKGVuZCwgJ3l5eXkvTU0vZGQnKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGNoYW5nZVR4dCgpIHsKICAgICAgdGhpcy5mb3JtSW5saW5lLmNoYW5uZWxfdHlwZSA9IHRoaXMuY2hhbm5lbF90eXBlID09PSAnYWxsJyA/ICcnIDogdGhpcy5jaGFubmVsX3R5cGU7CiAgICB9LAogICAgLy8g5a+85Ye6CiAgICBleGNlbCgpIHsKICAgICAgc3RhdGlzdGljVXNlckV4Y2VsKHRoaXMuZm9ybUlubGluZSkudGhlbihhc3luYyAocmVzKSA9PiB7CiAgICAgICAgcmVzLmRhdGEudXJsLm1hcCgoaXRlbSkgPT4gewogICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBpdGVtOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDlhbfkvZPml6XmnJ8KICAgIG9uY2hhbmdlVGltZShlKSB7CiAgICAgIHRoaXMudGltZVZhbCA9IGU7CiAgICAgIHRoaXMuZm9ybUlubGluZS5kYXRhID0gdGhpcy50aW1lVmFsID8gdGhpcy50aW1lVmFsLmpvaW4oJy0nKSA6ICcnOwogICAgfSwKICAgIGhhbmRsZVN1Ym1pdCgpIHsKICAgICAgdGhpcy4kcmVmcy51c2VySW5mb3MuZ2V0U3RhdGlzdGljcygpOwogICAgICB0aGlzLiRyZWZzLnVzZXJJbmZvcy5nZXRUcmVuZCgpOwogICAgICB0aGlzLiRyZWZzLnVzZXJSZWdpb25zLmdldFRyZW5kKCk7CiAgICAgIHRoaXMuJHJlZnMudXNlclJlZ2lvbnMuZ2V0U2V4KCk7CiAgICAgIGlmICh0aGlzLmZvcm1JbmxpbmUuY2hhbm5lbF90eXBlID09PSAnd2VjaGF0JykgewogICAgICAgIHRoaXMuaXNTaG93ID0gdHJ1ZTsKICAgICAgICB0aGlzLiRyZWZzLndlY2hldEluZm9zLmdldFN0YXRpc3RpY3MoKTsKICAgICAgICB0aGlzLiRyZWZzLndlY2hldEluZm9zLmdldFRyZW5kKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5pc1Nob3cgPSBmYWxzZTsKICAgICAgfQogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAqDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/statistic/user","sourcesContent":["<template>\n  <div class=\"article-manager\">\n    <el-card :bordered=\"false\" shadow=\"never\" class=\"ivu-mb-16\" :body-style=\"{ padding: 0 }\">\n      <div class=\"padding-add\">\n        <el-form ref=\"formInline\" label-width=\"80px\" label-position=\"right\" :model=\"formInline\" inline>\n          <el-form-item label=\"用户渠道：\">\n            <el-select\n              clearable\n              v-model=\"channel_type\"\n              placeholder=\"请选择用户渠道\"\n              @change=\"changeTxt\"\n              class=\"form_content_width\"\n            >\n              <el-option value=\"all\" label=\"全部\"></el-option>\n              <el-option value=\"wechat\" label=\"公众号\"></el-option>\n              <el-option value=\"routine\" label=\"小程序\"></el-option>\n              <el-option value=\"h5\" label=\"H5\"></el-option>\n              <el-option value=\"pc\" label=\"PC\"></el-option>\n              <el-option value=\"app\" label=\"APP\"></el-option>\n            </el-select>\n          </el-form-item>\n          <el-form-item label=\"选择时间:\">\n            <el-date-picker\n              clearable\n              v-model=\"timeVal\"\n              type=\"daterange\"\n              :editable=\"false\"\n              @change=\"onchangeTime\"\n              format=\"yyyy/MM/dd\"\n              value-format=\"yyyy/MM/dd\"\n              start-placeholder=\"开始日期\"\n              end-placeholder=\"结束日期\"\n              :picker-options=\"pickerOptions\"\n              style=\"width: 250px\"\n              class=\"mr20\"\n            ></el-date-picker>\n          </el-form-item>\n          <el-form-item>\n            <el-button type=\"primary\" @click=\"handleSubmit('formInline')\">查询</el-button>\n          </el-form-item>\n          <el-form-item>\n            <el-button @click=\"excel\">导出</el-button>\n          </el-form-item>\n        </el-form>\n      </div>\n    </el-card>\n    <user-info :formInline=\"formInline\" ref=\"userInfos\" key=\"1\"></user-info>\n    <wechet-info :formInline=\"formInline\" ref=\"wechetInfos\" v-if=\"isShow\" key=\"2\"></wechet-info>\n    <user-region :formInline=\"formInline\" ref=\"userRegions\" key=\"3\"></user-region>\n  </div>\n</template>\n\n<script>\nimport userInfo from './components/userInfo';\nimport wechetInfo from './components/wechetInfo';\nimport userRegion from './components/userRegion';\nimport { statisticUserExcel } from '@/api/statistic';\nimport { formatDate } from '@/utils/validate';\nexport default {\n  name: 'index',\n  components: {\n    userInfo,\n    wechetInfo,\n    userRegion,\n  },\n  data() {\n    return {\n      formInline: {\n        channel_type: '',\n        data: '',\n      },\n      channel_type: 'all',\n      timeVal: [],\n      isShow: false,\n      pickerOptions: this.$timeOptions,\n    };\n  },\n  created() {\n    const end = new Date();\n    const start = new Date();\n    start.setTime(start.setTime(new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate() - 29)));\n    this.timeVal = [start, end];\n    this.formInline.data = formatDate(start, 'yyyy/MM/dd') + '-' + formatDate(end, 'yyyy/MM/dd');\n  },\n  methods: {\n    changeTxt() {\n      this.formInline.channel_type = this.channel_type === 'all' ? '' : this.channel_type;\n    },\n    // 导出\n    excel() {\n      statisticUserExcel(this.formInline).then(async (res) => {\n        res.data.url.map((item) => {\n          window.location.href = item;\n        });\n      });\n    },\n    // 具体日期\n    onchangeTime(e) {\n      this.timeVal = e;\n      this.formInline.data = this.timeVal ? this.timeVal.join('-') : '';\n    },\n    handleSubmit() {\n      this.$refs.userInfos.getStatistics();\n      this.$refs.userInfos.getTrend();\n      this.$refs.userRegions.getTrend();\n      this.$refs.userRegions.getSex();\n      if (this.formInline.channel_type === 'wechat') {\n        this.isShow = true;\n        this.$refs.wechetInfos.getStatistics();\n        this.$refs.wechetInfos.getTrend();\n      } else {\n        this.isShow = false;\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\n.ivu-form-item {\n  padding-bottom: 10px;\n  margin-bottom: 0;\n}\n</style>\n"]}]}