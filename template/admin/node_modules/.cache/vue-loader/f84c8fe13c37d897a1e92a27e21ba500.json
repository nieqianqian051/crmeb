{"remainingRequest":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/pages/setting/user/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/pages/setting/user/index.vue","mtime":1720712868000},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":1746465018509},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/babel-loader/lib/index.js","mtime":1746465024347},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":1746465018509},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js","mtime":1746465019530}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IHVwZHRhZUFkbWluIH0gZnJvbSAnQC9hcGkvdXNlcic7CmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAndnVleCc7CmltcG9ydCBDcm9wcGVySW1nIGZyb20gJ0AvY29tcG9uZW50cy9jcm9wcGVySW1nJzsKaW1wb3J0IHsgZ2V0Q29va2llcyB9IGZyb20gJ0AvbGlicy91dGlsJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdzZXR0aW5nX3VzZXInLAogIGNvbXBvbmVudHM6IHsgQ3JvcHBlckltZyB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBTdGF0ZSgnbWVkaWEnLCBbJ2lzTW9iaWxlJ10pLAogICAgLi4ubWFwU3RhdGUoJ3VzZXJMZXZlbCcsIFsnY2F0ZWdvcnlJZCddKSwKICAgIGxhYmVsV2lkdGgoKSB7CiAgICAgIHJldHVybiB0aGlzLmlzTW9iaWxlID8gdW5kZWZpbmVkIDogJzgwcHgnOwogICAgfSwKICAgIGxhYmVsUG9zaXRpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLmlzTW9iaWxlID8gJ3RvcCcgOiAncmlnaHQnOwogICAgfSwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBhY2NvdW50OiAnJywKICAgICAgYXZhdGFyTW9hZGw6IGZhbHNlLAoJICBxckNvZGU6ICcnLAkgCiAgICAgIGZvcm1WYWxpZGF0ZTogewogICAgICAgIGF2YXRhcjogJycsCiAgICAgICAgcmVhbE5hbWU6ICcnLAogICAgICAgIHB3ZDogJycsCiAgICAgICAgbmV3UHdkOiAnJywKICAgICAgICBjb25mUHdkOiAnJywKICAgICAgfSwKICAgICAgcnVsZVZhbGlkYXRlOiB7CiAgICAgICAgcmVhbE5hbWU6IFt7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn5oKo55qE5aeT5ZCN5LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2JsdXInIH1dLAogICAgICB9LAogICAgfTsKICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmFjY291bnQgPSB0aGlzLiRzdG9yZS5zdGF0ZS51c2VySW5mby51c2VySW5mby5hY2NvdW50OwogICAgdGhpcy5mb3JtVmFsaWRhdGUuaGVhZFBpYyA9IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJJbmZvLnVzZXJJbmZvLmhlYWRQaWM7CiAgICB0aGlzLmZvcm1WYWxpZGF0ZS5yZWFsTmFtZSA9IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJJbmZvLnVzZXJJbmZvLnJlYWxOYW1lOwoJbGV0IGJpbmFyeSA9ICIiOwoJY29uc3QgYnl0ZXMgPSBuZXcgVWludDhBcnJheSh0aGlzLiRyb3V0ZS5wYXJhbXMuZGF0YSkKCWZvcihsZXQgaSA9IDA7IGk8IGJ5dGVzLmJ5dGVMZW5ndGg7IGkrKykgewoJCWJpbmFyeSArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGJ5dGVzW2ldKQoJfQoJdGhpcy5xckNvZGUgPSAiZGF0YTppbWFnZS9wbmc7YmFzZTY0LCIgKyB3aW5kb3cuYnRvYShiaW5hcnkpOwogIH0sCiAgY3JlYXRlZCgpIHsKCSAKICB9LAogIG1ldGhvZHM6IHsKICAgIHVwbG9hZEltZ1N1Y2Nlc3MoZGF0YSkgewogICAgICB0aGlzLmF2YXRhck1vYWRsID0gZmFsc2U7CiAgICAgIHRoaXMuZm9ybVZhbGlkYXRlLmhlYWRQaWMgPSBkYXRhOwogICAgfSwKICAgIGhhbmRsZVN1Ym1pdChuYW1lKSB7CiAgICAgIHRoaXMuJHJlZnNbbmFtZV0udmFsaWRhdGUoKHZhbGlkKSA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBsZXQgZGF0YSA9IHsKICAgICAgICAgICAgYWNjb3VudCA6IHRoaXMuYWNjb3VudCwKICAgICAgICAgICAgaGVhZFBpYzogdGhpcy5mb3JtVmFsaWRhdGUuaGVhZFBpYywKICAgICAgICAgICAgcmVhbE5hbWU6IHRoaXMuZm9ybVZhbGlkYXRlLnJlYWxOYW1lLAogICAgICAgICAgICBwd2Q6IHRoaXMuZm9ybVZhbGlkYXRlLnB3ZCwKICAgICAgICAgICAgbmV3UHdkOiB0aGlzLmZvcm1WYWxpZGF0ZS5uZXdQd2QsCiAgICAgICAgICAgIGNvbmZpcm1Qd2Q6IHRoaXMuZm9ybVZhbGlkYXRlLmNvbmZpcm1Qd2QKICAgICAgICAgIH0KICAgICAgICAgIHVwZHRhZUFkbWluKGRhdGEpCiAgICAgICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3VzZXJJbmZvL3VzZXJSZWFsTmFtZScsIHRoaXMuZm9ybVZhbGlkYXRlLnJlYWxOYW1lKTsKICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3VzZXJJbmZvL3VzZXJSZWFsSGVhZFBpYycsIHRoaXMuZm9ybVZhbGlkYXRlLmhlYWRQaWMpOwogICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcyhyZXMubXNnKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLmNhdGNoKChyZXMpID0+IHsKICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpOwogICAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHRoaXMuZm9ybVZhbGlkYXRlLm5ld1B3ZCAhPT0gdGhpcy5mb3JtVmFsaWRhdGUuY29uZmlybVB3ZCkgewogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfmgqjovpPlhaXnmoTmlrDlr4bnoIHkuI7ml6flr4bnoIHkuI3kuIDoh7QnKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAkDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/setting/user","sourcesContent":["<template>\n  <div>\n    <el-card :bordered=\"false\" shadow=\"never\" class=\"ivu-mt\">\n      <el-form\n        ref=\"formValidate\"\n        :model=\"formValidate\"\n        :rules=\"ruleValidate\"\n        label-width=\"160px\"\n        label-position=\"right\"\n      >\n        \n\t\t<el-form-item label=\"问卷调查二维码：\">\n\t\t  <div >\n\t\t    <img :src=\"qrCode\" alt=\"\" style=\"width: 150px;height: 150px;\"/>\n\t\t  </div>\n\t\t</el-form-item>\n\t\t<el-form-item label=\"头像：\">\n\t\t  <div class=\"avatar\" @click=\"avatarMoadl = true\">\n\t\t    <img v-if=\"formValidate.headPic\" :src=\"formValidate.headPic\" alt=\"\" />\n\t\t    <img v-else src=\"../../../assets/images/f.png\" alt=\"\" />\n\t\t  </div>\n\t\t</el-form-item>\n        <el-form-item label=\"账号：\" prop=\"\">\n          <el-input type=\"text\" v-model=\"account\" :disabled=\"true\" class=\"input\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"姓名：\" prop=\"real_name\">\n          <el-input type=\"text\" v-model=\"formValidate.realName\" class=\"input\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"原始密码：\">\n          <el-input type=\"password\" v-model=\"formValidate.pwd\" class=\"input\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"新密码：\">\n          <el-input type=\"password\" v-model=\"formValidate.newPwd\" class=\"input\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"确认新密码：\">\n          <el-input type=\"password\" v-model=\"formValidate.confirmPwd\" class=\"input\"></el-input>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"handleSubmit('formValidate')\">提交</el-button>\n        </el-form-item>\n      </el-form>\n    </el-card>\n\t\t\t\n    <el-dialog :visible.sync=\"avatarMoadl\" title=\"头像上传\" width=\"720px\">\n      <CropperImg v-if=\"avatarMoadl\" @uploadImgSuccess=\"uploadImgSuccess\"></CropperImg>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { updtaeAdmin } from '@/api/user';\nimport { mapState } from 'vuex';\nimport CropperImg from '@/components/cropperImg';\nimport { getCookies } from '@/libs/util';\nexport default {\n  name: 'setting_user',\n  components: { CropperImg },\n  computed: {\n    ...mapState('media', ['isMobile']),\n    ...mapState('userLevel', ['categoryId']),\n    labelWidth() {\n      return this.isMobile ? undefined : '80px';\n    },\n    labelPosition() {\n      return this.isMobile ? 'top' : 'right';\n    },\n  },\n  data() {\n    return {\n      account: '',\n      avatarMoadl: false,\n\t  qrCode: '',\t \n      formValidate: {\n        avatar: '',\n        realName: '',\n        pwd: '',\n        newPwd: '',\n        confPwd: '',\n      },\n      ruleValidate: {\n        realName: [{ required: true, message: '您的姓名不能为空', trigger: 'blur' }],\n      },\n    };\n  },\n  mounted() {\n    this.account = this.$store.state.userInfo.userInfo.account;\n    this.formValidate.headPic = this.$store.state.userInfo.userInfo.headPic;\n    this.formValidate.realName = this.$store.state.userInfo.userInfo.realName;\n\tlet binary = \"\";\n\tconst bytes = new Uint8Array(this.$route.params.data)\n\tfor(let i = 0; i< bytes.byteLength; i++) {\n\t\tbinary += String.fromCharCode(bytes[i])\n\t}\n\tthis.qrCode = \"data:image/png;base64,\" + window.btoa(binary);\n  },\n  created() {\n\t \n  },\n  methods: {\n    uploadImgSuccess(data) {\n      this.avatarMoadl = false;\n      this.formValidate.headPic = data;\n    },\n    handleSubmit(name) {\n      this.$refs[name].validate((valid) => {\n        if (valid) {\n          let data = {\n            account : this.account,\n            headPic: this.formValidate.headPic,\n            realName: this.formValidate.realName,\n            pwd: this.formValidate.pwd,\n            newPwd: this.formValidate.newPwd,\n            confirmPwd: this.formValidate.confirmPwd\n          }\n          updtaeAdmin(data)\n            .then((res) => {\n              this.$store.commit('userInfo/userRealName', this.formValidate.realName);\n              this.$store.commit('userInfo/userRealHeadPic', this.formValidate.headPic);\n              this.$message.success(res.msg);\n            })\n            .catch((res) => {\n              this.$message.error(res.msg);\n            });\n        } else {\n          if (this.formValidate.newPwd !== this.formValidate.confirmPwd) {\n            this.$message.error('您输入的新密码与旧密码不一致');\n          }\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.input {\n  width: 400px;\n}\n.avatar {\n  width: 80px;\n  height: 80px;\n  img {\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    border: 1px solid #f2f2f2;\n  }\n}\n</style>\n"]}]}