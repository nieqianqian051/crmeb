{"remainingRequest":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/pages/setting/user/index.vue?vue&type=style&index=0&id=4c78f5b1&lang=scss&scoped=true","dependencies":[{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/pages/setting/user/index.vue","mtime":1720712868000},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/css-loader/index.js","mtime":1746465018503},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1746465020031},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/postcss-loader/src/index.js","mtime":1746465019371},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/sass-loader/dist/cjs.js","mtime":1746465018452},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":1746465018509},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js","mtime":1746465019530}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5pbnB1dCB7CiAgd2lkdGg6IDQwMHB4Owp9Ci5hdmF0YXIgewogIHdpZHRoOiA4MHB4OwogIGhlaWdodDogODBweDsKICBpbWcgewogICAgd2lkdGg6IDEwMCU7CiAgICBoZWlnaHQ6IDEwMCU7CiAgICBib3JkZXItcmFkaXVzOiA1MCU7CiAgICBib3JkZXI6IDFweCBzb2xpZCAjZjJmMmYyOwogIH0KfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAuIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/setting/user","sourcesContent":["<template>\n  <div>\n    <el-card :bordered=\"false\" shadow=\"never\" class=\"ivu-mt\">\n      <el-form\n        ref=\"formValidate\"\n        :model=\"formValidate\"\n        :rules=\"ruleValidate\"\n        label-width=\"160px\"\n        label-position=\"right\"\n      >\n        \n\t\t<el-form-item label=\"问卷调查二维码：\">\n\t\t  <div >\n\t\t    <img :src=\"qrCode\" alt=\"\" style=\"width: 150px;height: 150px;\"/>\n\t\t  </div>\n\t\t</el-form-item>\n\t\t<el-form-item label=\"头像：\">\n\t\t  <div class=\"avatar\" @click=\"avatarMoadl = true\">\n\t\t    <img v-if=\"formValidate.headPic\" :src=\"formValidate.headPic\" alt=\"\" />\n\t\t    <img v-else src=\"../../../assets/images/f.png\" alt=\"\" />\n\t\t  </div>\n\t\t</el-form-item>\n        <el-form-item label=\"账号：\" prop=\"\">\n          <el-input type=\"text\" v-model=\"account\" :disabled=\"true\" class=\"input\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"姓名：\" prop=\"real_name\">\n          <el-input type=\"text\" v-model=\"formValidate.realName\" class=\"input\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"原始密码：\">\n          <el-input type=\"password\" v-model=\"formValidate.pwd\" class=\"input\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"新密码：\">\n          <el-input type=\"password\" v-model=\"formValidate.newPwd\" class=\"input\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"确认新密码：\">\n          <el-input type=\"password\" v-model=\"formValidate.confirmPwd\" class=\"input\"></el-input>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"handleSubmit('formValidate')\">提交</el-button>\n        </el-form-item>\n      </el-form>\n    </el-card>\n\t\t\t\n    <el-dialog :visible.sync=\"avatarMoadl\" title=\"头像上传\" width=\"720px\">\n      <CropperImg v-if=\"avatarMoadl\" @uploadImgSuccess=\"uploadImgSuccess\"></CropperImg>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { updtaeAdmin } from '@/api/user';\nimport { mapState } from 'vuex';\nimport CropperImg from '@/components/cropperImg';\nimport { getCookies } from '@/libs/util';\nexport default {\n  name: 'setting_user',\n  components: { CropperImg },\n  computed: {\n    ...mapState('media', ['isMobile']),\n    ...mapState('userLevel', ['categoryId']),\n    labelWidth() {\n      return this.isMobile ? undefined : '80px';\n    },\n    labelPosition() {\n      return this.isMobile ? 'top' : 'right';\n    },\n  },\n  data() {\n    return {\n      account: '',\n      avatarMoadl: false,\n\t  qrCode: '',\t \n      formValidate: {\n        avatar: '',\n        realName: '',\n        pwd: '',\n        newPwd: '',\n        confPwd: '',\n      },\n      ruleValidate: {\n        realName: [{ required: true, message: '您的姓名不能为空', trigger: 'blur' }],\n      },\n    };\n  },\n  mounted() {\n    this.account = this.$store.state.userInfo.userInfo.account;\n    this.formValidate.headPic = this.$store.state.userInfo.userInfo.headPic;\n    this.formValidate.realName = this.$store.state.userInfo.userInfo.realName;\n\tlet binary = \"\";\n\tconst bytes = new Uint8Array(this.$route.params.data)\n\tfor(let i = 0; i< bytes.byteLength; i++) {\n\t\tbinary += String.fromCharCode(bytes[i])\n\t}\n\tthis.qrCode = \"data:image/png;base64,\" + window.btoa(binary);\n  },\n  created() {\n\t \n  },\n  methods: {\n    uploadImgSuccess(data) {\n      this.avatarMoadl = false;\n      this.formValidate.headPic = data;\n    },\n    handleSubmit(name) {\n      this.$refs[name].validate((valid) => {\n        if (valid) {\n          let data = {\n            account : this.account,\n            headPic: this.formValidate.headPic,\n            realName: this.formValidate.realName,\n            pwd: this.formValidate.pwd,\n            newPwd: this.formValidate.newPwd,\n            confirmPwd: this.formValidate.confirmPwd\n          }\n          updtaeAdmin(data)\n            .then((res) => {\n              this.$store.commit('userInfo/userRealName', this.formValidate.realName);\n              this.$store.commit('userInfo/userRealHeadPic', this.formValidate.headPic);\n              this.$message.success(res.msg);\n            })\n            .catch((res) => {\n              this.$message.error(res.msg);\n            });\n        } else {\n          if (this.formValidate.newPwd !== this.formValidate.confirmPwd) {\n            this.$message.error('您输入的新密码与旧密码不一致');\n          }\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.input {\n  width: 400px;\n}\n.avatar {\n  width: 80px;\n  height: 80px;\n  img {\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    border: 1px solid #f2f2f2;\n  }\n}\n</style>\n"]}]}