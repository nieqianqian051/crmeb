{"remainingRequest":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/pages/setting/storeService/speechcraft.vue?vue&type=style&index=0&id=662899e6&scoped=true&lang=stylus","dependencies":[{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/pages/setting/storeService/speechcraft.vue","mtime":1719467759000},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/css-loader/index.js","mtime":1746465018503},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1746465020031},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/postcss-loader/src/index.js","mtime":1746465019371},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/stylus-loader/index.js","mtime":1746465207601},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":1746465018509},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js","mtime":1746465019530}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5zaG93T257CiAgICBjb2xvcjogIzJkOGNmMDsKICAgIGJhY2tncm91bmQ6ICNmMGZhZmY7CiAgICB6LWluZGV4OiAyOwp9Ci50YWJCb3hfaW1nCiAgICB3aWR0aCAzNnB4CiAgICBoZWlnaHQgMzZweAogICAgYm9yZGVyLXJhZGl1czo0cHg7CiAgICBjdXJzb3IgcG9pbnRlcgogICAgaW1nCiAgICAgICAgd2lkdGggMTAwJQogICAgICAgIGhlaWdodCAxMDAlCi5tb2RlbEJveAogICAgOjp2LWRlZXAgCiAgICAuaXZ1LXRhYmxlLWhlYWRlcgogICAgICAgIHdpZHRoIDEwMCUgIWltcG9ydGFudAoudHJlZXMtY29hZGQKICAgIHdpZHRoOiAxMDAlOwogICAgaGVpZ2h0OiAzODVweDsKICAgIC5zY29sbGhpZGUKICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICBoZWlnaHQ6IDEwMCU7CiAgICAgICAgb3ZlcmZsb3cteDogaGlkZGVuOwogICAgICAgIG92ZXJmbG93LXk6IHNjcm9sbDsKLy8gbWFyZ2luLWxlZnQ6IDE4cHg7Ci5zY29sbGhpZGU6Oi13ZWJraXQtc2Nyb2xsYmFyIHsKICAgIGRpc3BsYXk6IG5vbmU7Cn0KOjp2LWRlZXAgLml2dS1tZW51LXZlcnRpY2FsIC5pdnUtbWVudS1pdGVtLWdyb3VwLXRpdGxlewogICAgZGlzcGxheTogbm9uZTsKfQo6OnYtZGVlcCAuaXZ1LW1lbnUtdmVydGljYWwuaXZ1LW1lbnUtbGlnaHQ6YWZ0ZXJ7CiAgICBkaXNwbGF5IG5vbmUKfQoKLmxlZnQtd3JhcHBlcgogICAgaGVpZ2h0IDkwNHB4CiAgICBiYWNrZ3JvdW5kICNmZmYKICAgIGJvcmRlci1yaWdodCAxcHggc29saWQgI2YyZjJmMgoubWVudS1pdGVtCiAgICB6LWluZGV4IDUwCiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICBkaXNwbGF5IGZsZXgKICAgIGp1c3RpZnktY29udGVudCBzcGFjZS1iZXR3ZWVuCiAgICB3b3JkLWJyZWFrIGJyZWFrLWFsbAogICAgLmljb24tYm94CiAgICAgICAgei1pbmRleCAzCiAgICAgICAgcG9zaXRpb24gYWJzb2x1dGUKICAgICAgICByaWdodCAyMHB4CiAgICAgICAgdG9wIDUwJQogICAgICAgIHRyYW5zZm9ybSB0cmFuc2xhdGVZKC01MCUpCiAgICAgICAgZGlzcGxheSBub25lCiAgICAmOmhvdmVyIC5pY29uLWJveAogICAgICAgIGRpc3BsYXkgYmxvY2sKICAgIC5yaWdodC1tZW51CiAgICAgICAgei1pbmRleCAxMAogICAgICAgIHBvc2l0aW9uIGFic29sdXRlCiAgICAgICAgcmlnaHQ6IC0xMDZweDsKICAgICAgICB0b3A6IC0xMXB4OwogICAgICAgIHdpZHRoIGF1dG8KICAgICAgICBtaW4td2lkdGg6IDEyMXB4Owo="},{"version":3,"sources":["speechcraft.vue"],"names":[],"mappings":";AA2hBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"speechcraft.vue","sourceRoot":"src/pages/setting/storeService","sourcesContent":["<template>\n  <div>\n    <el-row class=\"ivu-mt box-wrapper\">\n      <el-col v-bind=\"grid1\" class=\"left-wrapper\">\n        <div class=\"tree_tit\" @click=\"addSort\">\n          <i class=\"el-icon-circle-plus\"></i>\n          添加分类\n        </div>\n        <div class=\"tree\">\n          <el-tree\n            :data=\"labelSort\"\n            node-key=\"id\"\n            default-expand-all\n            highlight-current\n            :expand-on-click-node=\"false\"\n            @node-click=\"bindMenuItem\"\n            :current-node-key=\"treeId\"\n          >\n            <span class=\"custom-tree-node\" slot-scope=\"{ data }\">\n              <span class=\"file-name\">\n                <img v-if=\"!data.pid\" class=\"icon\" src=\"@/assets/images/file.jpg\" />\n                {{ data.name }}</span\n              >\n              <span v-show=\"data.id !== '' && data.id !== 0\">\n                <el-dropdown @command=\"(command) => clickMenu(data, command)\">\n                  <i class=\"el-icon-more el-icon--right\"></i>\n                  <template slot=\"dropdown\">\n                    <el-dropdown-menu>\n                      <el-dropdown-item command=\"1\">编辑分类</el-dropdown-item>\n                      <el-dropdown-item v-if=\"data.id\" command=\"2\">删除分类</el-dropdown-item>\n                    </el-dropdown-menu>\n                  </template>\n                </el-dropdown>\n              </span>\n            </span>\n          </el-tree>\n        </div>\n      </el-col>\n      <el-col v-bind=\"grid2\" ref=\"rightBox\">\n        <el-card :bordered=\"false\" shadow=\"never\">\n          <el-row class=\"mb14\">\n            <el-col :span=\"24\">\n              <el-button v-auth=\"['setting-store_service-add']\" type=\"primary\" @click=\"add\">添加话术</el-button>\n              <!-- <el-button v-auth=\"['setting-store_service-add']\" type=\"success\" @click=\"addSort\">添加分类</el-button> -->\n            </el-col>\n          </el-row>\n          <el-table\n            :data=\"tableList\"\n            v-loading=\"loading\"\n            highlight-current-row\n            no-userFrom-text=\"暂无数据\"\n            no-filtered-userFrom-text=\"暂无筛选结果\"\n          >\n            <el-table-column label=\"ID\" width=\"80\">\n              <template slot-scope=\"scope\">\n                <span>{{ scope.row.id }}</span>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"分类\" min-width=\"120\">\n              <template slot-scope=\"scope\">\n                <span>{{ scope.row.cate_name }}</span>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"标题\" min-width=\"120\">\n              <template slot-scope=\"scope\">\n                <el-tooltip placement=\"top\" :open-delay=\"600\">\n                  <div slot=\"content\">{{ scope.row.title }}</div>\n                  <span class=\"line2\">{{ scope.row.title }}</span>\n                </el-tooltip>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"详情\" min-width=\"120\">\n              <template slot-scope=\"scope\">\n                <el-tooltip placement=\"top\" :open-delay=\"600\">\n                  <div slot=\"content\">{{ scope.row.message }}</div>\n                  <span class=\"line2\">{{ scope.row.message }}</span>\n                </el-tooltip>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"排序\" min-width=\"120\">\n              <template slot-scope=\"scope\">\n                <span>{{ scope.row.sort }}</span>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"添加时间\" min-width=\"150\">\n              <template slot-scope=\"scope\">\n                <span>{{ scope.row.add_time }}</span>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"操作\" fixed=\"right\" width=\"170\">\n              <template slot-scope=\"scope\">\n                <a @click=\"edit(scope.row)\">编辑</a>\n                <el-divider direction=\"vertical\"></el-divider>\n                <a @click=\"del(scope.row, '删除客服', scope.$index)\">删除</a>\n              </template>\n            </el-table-column>\n          </el-table>\n          <div class=\"acea-row row-right page\">\n            <pagination\n              v-if=\"total\"\n              :total=\"total\"\n              :page.sync=\"tableFrom.page\"\n              :limit.sync=\"tableFrom.limit\"\n              @pagination=\"getList\"\n            />\n          </div>\n        </el-card>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex';\nimport {\n  wechatSpeechcraft,\n  speechcraftCreate,\n  speechcraftEdit,\n  speechcraftcate,\n  speechcraftcateCreate,\n  speechcraftcateEdit,\n} from '@/api/setting';\nexport default {\n  name: 'index',\n  filters: {\n    typeFilter(status) {\n      const statusMap = {\n        wechat: '微信用户',\n        routine: '小程序用户',\n      };\n      return statusMap[status];\n    },\n  },\n  computed: {\n    ...mapState('media', ['isMobile']),\n    labelWidth() {\n      return this.isMobile ? undefined : '80px';\n    },\n    labelPosition() {\n      return this.isMobile ? 'top' : 'right';\n    },\n  },\n  data() {\n    return {\n      treeId: '',\n      grid1: {\n        xl: 4,\n        lg: 4,\n        md: 6,\n        sm: 8,\n        xs: 0,\n      },\n      grid2: {\n        xl: 20,\n        lg: 20,\n        md: 18,\n        sm: 16,\n        xs: 24,\n      },\n      isChat: true,\n      formValidate3: {\n        page: 1,\n        limit: 15,\n      },\n      total3: 0,\n      loading3: false,\n      modals3: false,\n      tableList3: [],\n      columns3: [\n        {\n          title: '用户名称',\n          key: 'nickname',\n          width: 200,\n        },\n        {\n          title: '客服头像',\n          slot: 'headimgurl',\n        },\n        {\n          title: '操作',\n          slot: 'action',\n        },\n      ],\n      formValidate5: {\n        page: 1,\n        limit: 15,\n        uid: 0,\n        to_uid: 0,\n        id: 0,\n      },\n      total5: 0,\n      loading5: false,\n      tableList5: [],\n      FromData: null,\n      formValidate: {\n        page: 1,\n        limit: 15,\n        data: '',\n        type: '',\n        nickname: '',\n      },\n      tableList2: [],\n      modals: false,\n      total: 0,\n      tableFrom: {\n        page: 1,\n        limit: 15,\n        cate_id: 0,\n      },\n      timeVal: [],\n      fromList: {\n        title: '选择时间',\n        custom: true,\n        fromTxt: [\n          { text: '全部', val: '' },\n          { text: '今天', val: 'today' },\n          { text: '昨天', val: 'yesterday' },\n          { text: '最近7天', val: 'lately7' },\n          { text: '最近30天', val: 'lately30' },\n          { text: '本月', val: 'month' },\n          { text: '本年', val: 'year' },\n        ],\n      },\n      loading: false,\n      tableList: [],\n\n      loading2: false,\n      total2: 0,\n      addFrom: {\n        uids: [],\n      },\n      selections: [],\n      rows: {},\n      rowRecord: {},\n      theme3: 'light',\n      labelSort: [],\n      sortName: '',\n      current: 0,\n    };\n  },\n  created() {\n    this.getUserLabelAll();\n  },\n  methods: {\n    getUserLabelAll(key) {\n      speechcraftcate().then((res) => {\n        let data = res.data.data;\n        let obj = {\n          name: '全部',\n          id: '',\n        };\n        data.unshift(obj);\n        data.forEach((el) => {\n          el.status = false;\n        });\n        if (!key) {\n          this.sortName = data[0].id;\n          this.tableFrom.cate_id = data[0].id;\n          this.getList();\n        }\n        this.labelSort = data;\n      });\n    },\n    // 添加分类\n    addSort() {\n      this.$modalForm(speechcraftcateCreate()).then(() => this.getUserLabelAll());\n    },\n    //编辑标签\n    labelEdit(item) {\n      this.$modalForm(speechcraftcateEdit(item.id)).then(() => this.getUserLabelAll(1));\n    },\n    deleteSort(row, tit) {\n      let num = this.labelSort.findIndex((e) => {\n        return e.id == row.id;\n      });\n      let delfromData = {\n        title: tit,\n        num: num,\n        url: `app/wechat/speechcraftcate/${row.id}`,\n        method: 'DELETE',\n        ids: '',\n      };\n      this.$modalSure(delfromData)\n        .then((res) => {\n          this.$message.success(res.msg);\n          this.labelSort.splice(num, 1);\n          this.labelSort = [];\n          this.getUserLabelAll();\n        })\n        .catch((res) => {\n          this.$message.error(res.msg);\n        });\n    },\n    // 点击菜单\n    clickMenu(data, name) {\n      if (name == 1) {\n        this.labelEdit(data);\n      } else if (name == 2) {\n        this.deleteSort(data, '删除分类');\n      }\n    },\n    // 显示标签小菜单\n    showMenu(item) {\n      this.labelSort.forEach((el) => {\n        if (el.id == item.id) {\n          el.status = item.status ? false : true;\n        } else {\n          el.status = false;\n        }\n      });\n    },\n    bindMenuItem(name, index) {\n      this.tableFrom.page = 1;\n      this.current = index;\n      this.labelSort.forEach((el) => {\n        el.status = false;\n      });\n      this.tableFrom.cate_id = name.id;\n      this.getList();\n    },\n    cancel() {\n      this.formValidate = {\n        page: 1,\n        limit: 15,\n        data: '',\n        type: '',\n        nickname: '',\n      };\n    },\n    handleReachBottom() {\n      return new Promise((resolve) => {\n        this.formValidate.page = this.formValidate.page + 1;\n        setTimeout(() => {\n          // this.loading2 = true;\n          kefucreateApi(this.formValidate)\n            .then(async (res) => {\n              let data = res.data;\n              // this.tableList2 = data.list;\n              if (data.list.length > 0) {\n                for (let i = 0; i < data.list.length; i++) {\n                  this.tableList2.push(data.list[i]);\n                }\n              }\n              this.total2 = data.count;\n              this.loading2 = false;\n            })\n            .catch((res) => {\n              this.loading2 = false;\n              this.$message.error(res.msg);\n            });\n          resolve();\n        }, 2000);\n      });\n    },\n    // 查看对话\n    look(row) {\n      this.isChat = false;\n      this.rowRecord = row;\n      this.getChatlist();\n    },\n    // 查看对话列表\n    getChatlist() {\n      this.loading5 = true;\n      this.formValidate5.uid = this.rows.uid;\n      this.formValidate5.to_uid = this.rowRecord.uid;\n      this.formValidate5.id = this.rows.id;\n      kefuChatlistApi(this.formValidate5)\n        .then(async (res) => {\n          let data = res.data;\n          this.tableList5 = data.list;\n          this.total5 = data.count;\n          this.loading5 = false;\n        })\n        .catch((res) => {\n          this.loading5 = false;\n          this.$message.error(res.msg);\n        });\n    },\n    pageChange5(index) {\n      this.formValidate5.page = index;\n      this.getChatlist();\n    },\n    // 修改成功\n    submitFail() {\n      this.getList();\n    },\n    // 聊天记录\n    record(row) {\n      this.rows = row;\n      this.modals3 = true;\n      this.isChat = true;\n      this.getListRecord();\n    },\n    // 聊天记录列表\n    getListRecord() {\n      this.loading3 = true;\n      kefuRecordApi(this.formValidate3, this.rows.id)\n        .then(async (res) => {\n          let data = res.data;\n          this.tableList3 = data.list ? data.list : [];\n          this.total3 = data.count;\n          this.loading3 = false;\n        })\n        .catch((res) => {\n          this.loading3 = false;\n          this.$message.error(res.msg);\n        });\n    },\n    pageChange3(index) {\n      this.formValidate3.page = index;\n      this.getListRecord();\n    },\n    // 编辑\n    edit(row) {\n      this.$modalForm(speechcraftEdit(row.id)).then(() => this.getList());\n    },\n    // 添加\n    add() {\n      this.$modalForm(speechcraftCreate()).then(() => this.getList());\n    },\n    // 全选\n    onSelectTab(selection) {\n      this.selections = selection;\n      let data = [];\n      this.selections.map((item) => {\n        data.push(item.uid);\n      });\n      this.addFrom.uids = data;\n    },\n    // 具体日期\n    onchangeTime(e) {\n      this.timeVal = e;\n      this.formValidate.data = this.timeVal ? this.timeVal.join('-') : '';\n      this.formValidate.page = 1;\n      this.getListService();\n    },\n    // 选择时间\n    selectChange(tab) {\n      this.formValidate.data = tab;\n      this.timeVal = [];\n      this.formValidate.page = 1;\n      this.getListService();\n    },\n    // 客服列表\n    getListService() {\n      this.loading2 = true;\n      kefucreateApi(this.formValidate)\n        .then(async (res) => {\n          let data = res.data;\n          this.tableList2 = data.list;\n          this.total2 = data.count;\n          this.tableList2.map((item) => {\n            item._isChecked = false;\n          });\n          this.loading2 = false;\n        })\n        .catch((res) => {\n          this.loading2 = false;\n          this.$message.error(res.msg);\n        });\n    },\n    pageChange2(pageIndex) {\n      this.formValidate.page = pageIndex;\n      this.getListService();\n      this.addFrom.uids = [];\n    },\n    // 搜索\n    userSearchs() {\n      this.formValidate.page = 1;\n      this.getListService();\n    },\n    // 删除\n    del(row, tit, num) {\n      let delfromData = {\n        title: tit,\n        num: num,\n        url: `/app/wechat/speechcraft/${row.id}`,\n        method: 'DELETE',\n        ids: '',\n      };\n      this.$modalSure(delfromData)\n        .then((res) => {\n          this.$message.success(res.msg);\n          this.tableList.splice(num, 1);\n        })\n        .catch((res) => {\n          this.$message.error(res.msg);\n        });\n    },\n    // 列表\n    getList() {\n      this.loading = true;\n      wechatSpeechcraft(this.tableFrom)\n        .then(async (res) => {\n          let data = res.data;\n          this.tableList = data.list;\n          this.total = res.data.count;\n          this.loading = false;\n        })\n        .catch((res) => {\n          this.loading = false;\n          this.$message.error(res.msg);\n        });\n    },\n    // 修改是否显示\n    onchangeIsShow(row) {\n      let data = {\n        id: row.id,\n        status: row.status,\n      };\n      kefusetStatusApi(data)\n        .then(async (res) => {\n          this.$message.success(res.msg);\n        })\n        .catch((res) => {\n          this.$message.error(res.msg);\n        });\n    },\n    // 添加客服\n    putRemark() {\n      if (this.addFrom.uids.length === 0) {\n        return this.$message.warning('请选择要添加的客服');\n      }\n      kefuAddApi(this.addFrom)\n        .then(async (res) => {\n          this.$message.success(res.msg);\n          this.modals = false;\n          this.getList();\n        })\n        .catch((res) => {\n          this.loading = false;\n          this.$message.error(res.msg);\n        });\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"stylus\">\n.showOn{\n    color: #2d8cf0;\n    background: #f0faff;\n    z-index: 2;\n}\n.tabBox_img\n    width 36px\n    height 36px\n    border-radius:4px;\n    cursor pointer\n    img\n        width 100%\n        height 100%\n.modelBox\n    ::v-deep \n    .ivu-table-header\n        width 100% !important\n.trees-coadd\n    width: 100%;\n    height: 385px;\n    .scollhide\n        width: 100%;\n        height: 100%;\n        overflow-x: hidden;\n        overflow-y: scroll;\n// margin-left: 18px;\n.scollhide::-webkit-scrollbar {\n    display: none;\n}\n::v-deep .ivu-menu-vertical .ivu-menu-item-group-title{\n    display: none;\n}\n::v-deep .ivu-menu-vertical.ivu-menu-light:after{\n    display none\n}\n\n.left-wrapper\n    height 904px\n    background #fff\n    border-right 1px solid #f2f2f2\n.menu-item\n    z-index 50\n    position: relative;\n    display flex\n    justify-content space-between\n    word-break break-all\n    .icon-box\n        z-index 3\n        position absolute\n        right 20px\n        top 50%\n        transform translateY(-50%)\n        display none\n    &:hover .icon-box\n        display block\n    .right-menu\n        z-index 10\n        position absolute\n        right: -106px;\n        top: -11px;\n        width auto\n        min-width: 121px;\n</style>\n"]}]}