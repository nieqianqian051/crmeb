{"remainingRequest":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/layout/component/columnsAside.vue?vue&type=style&index=0&id=689455a9&scoped=true&lang=scss","dependencies":[{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/layout/component/columnsAside.vue","mtime":1719467759000},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/css-loader/index.js","mtime":1746465018503},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1746465020031},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/postcss-loader/src/index.js","mtime":1746465019371},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/sass-loader/dist/cjs.js","mtime":1746465018452},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":1746465018509},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js","mtime":1746465019530}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5sYXlvdXQtY29sdW1ucy1hc2lkZSB7CiAgd2lkdGg6IDcwcHg7CiAgaGVpZ2h0OiAxMDAlOwogIGJhY2tncm91bmQ6IHZhcigtLXByZXYtYmctY29sdW1uc01lbnVCYXIpOwogIGJveC1zaGFkb3c6IDAgMXB4IDRweCByZ2JhKDAsIDIxLCA0MSwgMC4wOCk7CiAgYm9yZGVyLXJpZ2h0OiAxcHggc29saWQgdmFyKC0tcHJldi1ib3JkZXItY29sb3ItbGlnaHRlcik7CgogIHVsIHsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIGxpIHsKICAgICAgY29sb3I6IHZhcigtLXByZXYtYmctY29sdW1uc01lbnVCYXJDb2xvcik7CiAgICAgIHdpZHRoOiAxMDAlOwogICAgICBoZWlnaHQ6IDUwcHg7CiAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgIHotaW5kZXg6IDE7CiAgICAgIC5jb2x1bW5zLXZlcnRpY2FsIHsKICAgICAgICBtYXJnaW46IGF1dG87CiAgICAgICAgLmNvbHVtbnMtdmVydGljYWwtdGl0bGUgewogICAgICAgICAgcGFkZGluZy10b3A6IDFweDsKICAgICAgICB9CiAgICAgIH0KICAgICAgLmNvbHVtbnMtaG9yaXpvbnRhbCB7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICBoZWlnaHQ6IDUwcHg7CiAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgICAgICBwYWRkaW5nOiAwIDVweDsKICAgICAgICBpIHsKICAgICAgICAgIG1hcmdpbi1yaWdodDogM3B4OwogICAgICAgIH0KICAgICAgICBhIHsKICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAuY29sdW1ucy1ob3Jpem9udGFsLXRpdGxlIHsKICAgICAgICAgICAgcGFkZGluZy10b3A6IDFweDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgYSB7CiAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiBub25lOwogICAgICAgIGNvbG9yOiB2YXIoLS1wcmV2LWJnLWNvbHVtbnNNZW51QmFyQ29sb3IpOwogICAgICB9CiAgICB9CiAgICAvLyBsaTpob3ZlciB7CiAgICAvLyAgIGJhY2tncm91bmQ6IHZhcigtLXByZXYtY29sb3ItcHJpbWFyeSk7CiAgICAvLyAgIGNvbG9yOiB2YXIoLS1wcmV2LWJnLWNvbHVtbnNNZW51QmFyQ29sb3IpOwogICAgLy8gfQogICAgLmxheW91dC1jb2x1bW5zIHsKICAgICAgdHJhbnNpdGlvbjogMC4zcyBlYXNlLWluLW91dDsKICAgIH0KICAgIC5sYXlvdXQtY29sdW1ucy1hY3RpdmUsCiAgICAubGF5b3V0LWNvbHVtbnMtYWN0aXZlIGEgewogICAgICBjb2xvcjogdmFyKC0tcHJldi1iZy1jb2x1bW5zTWVudUFjdGl2ZUNvbG9yKTsKICAgICAgdHJhbnNpdGlvbjogMC4zcyBlYXNlLWluLW91dDsKICAgIH0KCiAgICAuY29sdW1ucy1yb3VuZCB7CiAgICAgIGJhY2tncm91bmQ6IHZhcigtLXByZXYtY29sb3ItcHJpbWFyeSk7CiAgICAgIC8vIGNvbG9yOiB2YXIoLS1wcmV2LWNvbG9yLXRleHQtd2hpdGUpOwogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIGxlZnQ6IDUwJTsKICAgICAgdG9wOiAycHg7CiAgICAgIGhlaWdodDogNTBweDsKICAgICAgd2lkdGg6IDY1cHg7CiAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWCgtNTAlKTsKICAgICAgei1pbmRleDogMDsKICAgICAgdHJhbnNpdGlvbjogMC4zcyBlYXNlLWluLW91dDsKICAgICAgYm9yZGVyLXJhZGl1czogNXB4OwogICAgfQogICAgLmNvbHVtbnMtY2FyZCB7CiAgICAgIEBleHRlbmQgLmNvbHVtbnMtcm91bmQ7CiAgICAgIHRvcDogMDsKICAgICAgaGVpZ2h0OiA1MHB4OwogICAgICB3aWR0aDogMTAwJTsKICAgICAgYm9yZGVyLXJhZGl1czogMDsKICAgIH0KICB9Cn0K"},{"version":3,"sources":["columnsAside.vue"],"names":[],"mappings":";AA8MA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"columnsAside.vue","sourceRoot":"src/layout/component","sourcesContent":["<template>\n  <div class=\"layout-columns-aside\">\n    <el-scrollbar>\n      <Logo />\n      <ul>\n        <li\n          v-for=\"(v, k) in columnsAsideList\"\n          :key=\"k\"\n          @click=\"onColumnsAsideMenuClick(v)\"\n          ref=\"columnsAsideOffsetTopRefs\"\n          class=\"layout-columns\"\n          :class=\"{ 'layout-columns-active': v.k === liIndex }\"\n          :title=\"$t(v.title)\"\n        >\n          <div :class=\"setColumnsAsidelayout\" v-if=\"!v.isLink || (v.isLink && v.isIframe)\">\n            <i :class=\"'el-icon-' + v.icon\"></i>\n            <div class=\"font12\">\n              {{\n                $t(v.title) && $t(v.title).length >= 4\n                  ? $t(v.title).substr(0, setColumnsAsidelayout === 'columns-vertical' ? 4 : 3)\n                  : $t(v.title)\n              }}\n            </div>\n          </div>\n          <div :class=\"setColumnsAsidelayout\" v-else>\n            <a :href=\"v.isLink\" target=\"_blank\">\n              <i :class=\"'el-icon-' + v.icon\"></i>\n              <div class=\"font12\">\n                {{\n                  $t(v.title) && $t(v.title).length >= 4\n                    ? $t(v.title).substr(0, setColumnsAsidelayout === 'columns-vertical' ? 4 : 3)\n                    : $t(v.title)\n                }}\n              </div>\n            </a>\n          </div>\n        </li>\n        <div ref=\"columnsAsideActiveRef\" :class=\"setColumnsAsideStyle\"></div>\n      </ul>\n    </el-scrollbar>\n  </div>\n</template>\n\n<script>\nimport { getMenuSider, getHeaderName, findFirstNonNullChildren } from '@/libs/system';\nimport Logo from '@/layout/logo/index.vue';\nimport { mapState } from 'vuex';\n\nexport default {\n  name: 'layoutColumnsAside',\n  components: { Logo },\n  data() {\n    return {\n      columnsAsideList: [],\n      liIndex: 0,\n      difference: 0,\n      routeSplit: [],\n    };\n  },\n  computed: {\n    // 设置分栏高亮风格\n    setColumnsAsideStyle() {\n      return this.$store.state.themeConfig.themeConfig.columnsAsideStyle;\n    },\n    // 设置分栏布局风格\n    setColumnsAsidelayout() {\n      return this.$store.state.themeConfig.themeConfig.columnsAsideLayout;\n    },\n    Layout() {\n      return this.$store.state.themeConfig.themeConfig.Layout;\n    },\n    routesList() {\n      this.$store.state.routesList.routesList;\n    },\n    ...mapState('menu', ['activePath']),\n  },\n  beforeDestroy() {\n    this.bus.$off('routesListChange');\n  },\n  mounted() {\n    this.bus.$on('routesListChange', () => {\n      this.setFilterRoutes();\n    });\n    this.setFilterRoutes();\n  },\n  methods: {\n    // 设置菜单高亮位置移动\n    setColumnsAsideMove(k) {\n      if (k === undefined) return false;\n      const els = this.$refs.columnsAsideOffsetTopRefs;\n      this.liIndex = k;\n      this.$refs.columnsAsideActiveRef.style.top = `${els[k].offsetTop + this.difference}px`;\n    },\n    // 菜单高亮点击事件\n    onColumnsAsideMenuClick(v) {\n      let { path, redirect } = v;\n      if (v.children) {\n        this.$router.push(findFirstNonNullChildren(v.children).path);\n      } else {\n        this.$router.push(path);\n      }\n      // 一个路由设置自动收起菜单\n      if (!v.children || v.children.length <= 1) this.$store.state.themeConfig.themeConfig.isCollapse = true;\n      else if (v.children.length > 1) this.$store.state.themeConfig.themeConfig.isCollapse = false;\n      // this.bus.$emit('setSendColumnsChildren', getMenuSider(this.columnsAsideList, path));\n    },\n    // 设置高亮动态位置\n    onColumnsAsideDown(k) {\n      this.$nextTick(() => {\n        this.setColumnsAsideMove(k);\n      });\n    },\n    // 设置/过滤路由（非静态路由/是否显示在菜单中）\n    setFilterRoutes() {\n      if (this.$store.state.routesList.routesList.length <= 0) return false;\n      this.columnsAsideList = this.filterRoutesFun(this.$store.state.routesList.routesList);\n      //   const resData = getHeaderName(this.$route.path, this.columnsAsideList);\n      const resData = this.setSendChildren(getHeaderName(this.$route, this.columnsAsideList));\n      if (!resData.children) {\n        this.bus.$emit('setSendColumnsChildren', []);\n        this.$store.commit('menus/childMenuList', []);\n\n        this.$store.state.themeConfig.themeConfig.isCollapse = true;\n        return false;\n      }\n      this.bus.$emit('oneCatName', resData.item[0].title);\n      this.onColumnsAsideDown(resData.item[0].k);\n      // 刷新时，初始化一个路由设置自动收起菜单\n      resData.children.length > 0\n        ? (this.$store.state.themeConfig.themeConfig.isCollapse = false)\n        : (this.$store.state.themeConfig.themeConfig.isCollapse = true);\n      this.bus.$emit('setSendColumnsChildren', resData?.children || []);\n      this.$store.commit('menus/childMenuList', resData?.children || []);\n    },\n    // 传送当前子级数据到菜单中\n    setSendChildren(path) {\n      let currentData = {};\n      this.columnsAsideList.map((v, k) => {\n        v['k'] = k;\n        if (v.path === path) {\n          currentData['item'] = [{ ...v }];\n          //   currentData['children'] = [{ ...v }];\n          if (v.children) currentData['children'] = v.children;\n        }\n      });\n      return currentData;\n    },\n    // 路由过滤递归函数\n    filterRoutesFun(arr) {\n      return arr\n        .filter((item) => item.path)\n        .map((item) => {\n          item = Object.assign({}, item);\n          if (item.children) item.children = this.filterRoutesFun(item.children);\n          return item;\n        });\n    },\n    // tagsView 点击时，根据路由查找下标 columnsAsideList，实现左侧菜单高亮\n    setColumnsMenuHighlight(path) {\n      // this.routeSplit = path.split('/');\n      // this.routeSplit.shift();\n      // const routeFirst = `/${this.routeSplit[0]}`;\n      const currentSplitRoute = this.columnsAsideList.find((v) => v.path === path);\n      if (!currentSplitRoute) {\n        // this.onColumnsAsideDown(0);\n        return false;\n      }\n      // 延迟拿值，防止取不到\n      setTimeout(() => {\n        this.onColumnsAsideDown(currentSplitRoute.k);\n      }, 0);\n    },\n  },\n  watch: {\n    // 监听 vuex 数据变化\n    '$store.state': {\n      handler(val) {\n        val.themeConfig.themeConfig.columnsAsideStyle === 'columnsRound'\n          ? (this.difference = 3)\n          : (this.difference = 0);\n        if (val.routesList.routesList.length === this.columnsAsideList.length) return false;\n      },\n      deep: true,\n    },\n    // 监听路由的变化\n    $route: {\n      handler(to) {\n        this.setColumnsMenuHighlight(to.path);\n        let HeadName = getHeaderName(to, this.columnsAsideList);\n        let asideList = getMenuSider(this.columnsAsideList, HeadName)[0]?.children;\n        const resData = this.setSendChildren(HeadName);\n        if (resData.item) {\n          this.onColumnsAsideDown(resData.item[0].k);\n          this.bus.$emit('oneCatName', resData.item[0].title);\n        } else {\n          this.onColumnsAsideDown(0);\n        }\n        this.$store.commit('menus/childMenuList', asideList || []);\n      },\n      deep: true,\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.layout-columns-aside {\n  width: 70px;\n  height: 100%;\n  background: var(--prev-bg-columnsMenuBar);\n  box-shadow: 0 1px 4px rgba(0, 21, 41, 0.08);\n  border-right: 1px solid var(--prev-border-color-lighter);\n\n  ul {\n    position: relative;\n    li {\n      color: var(--prev-bg-columnsMenuBarColor);\n      width: 100%;\n      height: 50px;\n      text-align: center;\n      display: flex;\n      cursor: pointer;\n      position: relative;\n      z-index: 1;\n      .columns-vertical {\n        margin: auto;\n        .columns-vertical-title {\n          padding-top: 1px;\n        }\n      }\n      .columns-horizontal {\n        display: flex;\n        height: 50px;\n        width: 100%;\n        align-items: center;\n        justify-content: center;\n        padding: 0 5px;\n        i {\n          margin-right: 3px;\n        }\n        a {\n          display: flex;\n          .columns-horizontal-title {\n            padding-top: 1px;\n          }\n        }\n      }\n      a {\n        text-decoration: none;\n        color: var(--prev-bg-columnsMenuBarColor);\n      }\n    }\n    // li:hover {\n    //   background: var(--prev-color-primary);\n    //   color: var(--prev-bg-columnsMenuBarColor);\n    // }\n    .layout-columns {\n      transition: 0.3s ease-in-out;\n    }\n    .layout-columns-active,\n    .layout-columns-active a {\n      color: var(--prev-bg-columnsMenuActiveColor);\n      transition: 0.3s ease-in-out;\n    }\n\n    .columns-round {\n      background: var(--prev-color-primary);\n      // color: var(--prev-color-text-white);\n      position: absolute;\n      left: 50%;\n      top: 2px;\n      height: 50px;\n      width: 65px;\n      transform: translateX(-50%);\n      z-index: 0;\n      transition: 0.3s ease-in-out;\n      border-radius: 5px;\n    }\n    .columns-card {\n      @extend .columns-round;\n      top: 0;\n      height: 50px;\n      width: 100%;\n      border-radius: 0;\n    }\n  }\n}\n</style>\n"]}]}