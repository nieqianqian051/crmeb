{"remainingRequest":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/pages/system/maintain/systemDatabackup/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/pages/system/maintain/systemDatabackup/index.vue","mtime":1719467759000},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":1746465018509},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/babel-loader/lib/index.js","mtime":1746465024347},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":1746465018509},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js","mtime":1746465019530}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7CiAgYmFja3VwTGlzdEFwaSwKICBiYWNrdXBSZWFkTGlzdEFwaSwKICBiYWNrdXBCYWNrdXBBcGksCiAgYmFja3VwT3B0aW1pemVBcGksCiAgYmFja3VwUmVwYWlyQXBpLAogIGZpbGVzTGlzdEFwaSwKICBmaWxlc0Rvd25sb2FkQXBpLAogIGZpbGVzSW1wb3J0QXBpLAogIHVwZGF0ZU1hcmssCn0gZnJvbSAnQC9hcGkvc3lzdGVtJzsKaW1wb3J0IFNldHRpbmcgZnJvbSAnQC9zZXR0aW5nJzsKaW1wb3J0IHsgZ2V0Q29va2llcyB9IGZyb20gJ0AvbGlicy91dGlsJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnc3lzdGVtRGF0YWJhY2t1cCcsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG1vZGFsczogZmFsc2UsCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICB0YWJMaXN0OiBbXSwKICAgICAgdGFiTGlzdDI6IFtdLAogICAgICBzZWxlY3Rpb25MaXN0OiBbXSwKICAgICAgdGFiTGlzdDM6IFtdLAogICAgICByb3dzOiB7fSwKICAgICAgZGF0YUxpc3Q6IHt9LAogICAgICBsb2FkaW5nMjogZmFsc2UsCiAgICAgIGxvYWRpbmczOiBmYWxzZSwKICAgICAgbWFya01vZGFsOiBmYWxzZSwKICAgICAgbWFyazogJycsCiAgICAgIGhlYWRlcjoge30sCiAgICAgIFRva2VuOiAnJywKICAgICAgY2hhbmdlTWFya0RhdGE6IHsKICAgICAgICB0YWJsZTogJycsCiAgICAgICAgbWFyazogJycsCiAgICAgICAgdHlwZTogJycsCiAgICAgICAgZmllbGQ6ICcnLAogICAgICB9LAogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBmaWxlVXJsKCkgewogICAgICBjb25zdCBzZWFyY2ggPSAnL2FkbWluYXBpLyc7CiAgICAgIGNvbnN0IHN0YXJ0ID0gU2V0dGluZy5hcGlCYXNlVVJMLmluZGV4T2Yoc2VhcmNoKTsKICAgICAgcmV0dXJuIFNldHRpbmcuYXBpQmFzZVVSTC5zdWJzdHJpbmcoMCwgc3RhcnQpOyAvLyDmiKrlj5blrZfnrKbkuLIKICAgIH0sCiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRUb2tlbigpOwogICAgdGhpcy5nZXRMaXN0KCk7CiAgICB0aGlzLmdldGZpbGVMaXN0KCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBlZGl0TWFyayhyb3csIHR5cGUpIHsKICAgICAgdGhpcy5jaGFuZ2VNYXJrRGF0YS50YWJsZSA9IHJvdy5uYW1lIHx8IHJvdy5UQUJMRV9OQU1FOwogICAgICB0aGlzLmNoYW5nZU1hcmtEYXRhLmZpZWxkID0gcm93LkNPTFVNTl9OQU1FIHx8ICcnOwogICAgICB0aGlzLmNoYW5nZU1hcmtEYXRhLnR5cGUgPSByb3cuQ09MVU1OX1RZUEUgfHwgJyc7CiAgICAgIHRoaXMuY2hhbmdlTWFya0RhdGEuaXNfZmllbGQgPSB0eXBlOwogICAgICB0aGlzLm1hcmtNb2RhbCA9IHRydWU7CiAgICB9LAogICAgb2soKSB7CiAgICAgIHRoaXMuY2hhbmdlTWFya0RhdGEubWFyayA9IHRoaXMubWFyazsKICAgICAgdXBkYXRlTWFyayh0aGlzLmNoYW5nZU1hcmtEYXRhKS50aGVuKChyZXMpID0+IHsKICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MocmVzLm1zZyk7CiAgICAgICAgaWYgKHRoaXMuY2hhbmdlTWFya0RhdGEuaXNfZmllbGQpIHsKICAgICAgICAgIHRoaXMuSW5mbyh7IG5hbWU6IHRoaXMuY2hhbmdlTWFya0RhdGEudGFibGUsIGNvbW1lbnQ6IHRoaXMucm93cy5jb21tZW50IH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmdldExpc3QoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGNhbmNlbCgpIHsKICAgICAgdGhpcy5tYXJrID0gJyc7CiAgICB9LAogICAgLy8g5a+85YWlCiAgICBJbXBvcnRGaWxlKHJvdykgewogICAgICBmaWxlc0ltcG9ydEFwaSh7CiAgICAgICAgcGFydDogcm93LnBhcnQsCiAgICAgICAgdGltZTogcm93LnRpbWUsCiAgICAgIH0pCiAgICAgICAgLnRoZW4oYXN5bmMgKHJlcykgPT4gewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKHJlcy5tc2cpOwogICAgICAgICAgdGhpcy5nZXRmaWxlTGlzdCgpOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMubXNnKTsKICAgICAgICB9KTsKICAgIH0sCiAgICAvLyDliKDpmaTlpIfku73orrDlvZXooagKICAgIGRlbChyb3csIHRpdCwgbnVtKSB7CiAgICAgIGxldCBkZWxmcm9tRGF0YSA9IHsKICAgICAgICB0aXRsZTogdGl0LAogICAgICAgIG51bTogbnVtLAogICAgICAgIHVybDogYHN5c3RlbS9iYWNrdXAvZGVsX2ZpbGVgLAogICAgICAgIG1ldGhvZDogJ0RFTEVURScsCiAgICAgICAgaWRzOiB7CiAgICAgICAgICBmaWxlbmFtZTogcm93LnRpbWUsCiAgICAgICAgfSwKICAgICAgfTsKICAgICAgdGhpcy4kbW9kYWxTdXJlKGRlbGZyb21EYXRhKQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcyhyZXMubXNnKTsKICAgICAgICAgIHRoaXMudGFiTGlzdC5zcGxpY2UobnVtLCAxKTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpOwogICAgICAgIH0pOwogICAgfSwKICAgIC8vIOS4iuS8oOWktOmDqHRva2VuCiAgICBnZXRUb2tlbigpIHsKICAgICAgdGhpcy5Ub2tlbiA9IGdldENvb2tpZXMoJ3Rva2VuJyk7CiAgICB9LAogICAgZG93bmxvYWQocm93KSB7CiAgICAgIGxldCBkYXRhID0gewogICAgICAgIHRpbWU6IHJvdy50aW1lLAogICAgICB9OwogICAgICBmaWxlc0Rvd25sb2FkQXBpKGRhdGEpCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgaWYgKHJlcy5kYXRhLmtleSkgewogICAgICAgICAgICB3aW5kb3cub3BlbihTZXR0aW5nLmFwaUJhc2VVUkwgKyAnL2Rvd25sb2FkP2tleT0nICsgcmVzLmRhdGEua2V5KTsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcyk7CiAgICAgICAgfSk7CiAgICB9LAogICAgLy8g5a+85Ye65aSH5Lu96K6w5b2V6KGoCiAgICBleHBvcnREYXRhKCkgewogICAgICBjb25zdCBjb2x1bW5zID0gdGhpcy5jb2x1bW5zLnNsaWNlKDEsIDcpOwogICAgICB0aGlzLiRyZWZzLnNlbGVjdGlvbi5leHBvcnRDc3YoewogICAgICAgIGZpbGVuYW1lOiAn5a+85Ye6JywKICAgICAgICBjb2x1bW5zOiBjb2x1bW5zLAogICAgICAgIGRhdGE6IHRoaXMudGFiTGlzdDIsCiAgICAgIH0pOwogICAgfSwKICAgIC8vIOWFqOmAiQogICAgb25TZWxlY3RUYWIoc2VsZWN0aW9uKSB7CiAgICAgIHRoaXMuc2VsZWN0aW9uTGlzdCA9IHNlbGVjdGlvbjsKICAgICAgbGV0IHRhYmxlcyA9IFtdOwogICAgICB0aGlzLnNlbGVjdGlvbkxpc3QubWFwKChpdGVtKSA9PiB7CiAgICAgICAgdGFibGVzLnB1c2goaXRlbS5uYW1lKTsKICAgICAgfSk7CiAgICAgIHRoaXMuZGF0YUxpc3QgPSB7CiAgICAgICAgdGFibGVzOiB0YWJsZXMuam9pbignLCcpLAogICAgICB9OwogICAgfSwKICAgIC8vIOWkh+S7veihqAogICAgZ2V0QmFja3VwKCkgewogICAgICBpZiAodGhpcy5zZWxlY3Rpb25MaXN0Lmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ+ivt+mAieaLqeihqCcpOwogICAgICB9CiAgICAgIGJhY2t1cEJhY2t1cEFwaSh0aGlzLmRhdGFMaXN0KQogICAgICAgIC50aGVuKGFzeW5jIChyZXMpID0+IHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcyhyZXMubXNnKTsKICAgICAgICAgIHRoaXMuZ2V0ZmlsZUxpc3QoKTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLm1zZyk7CiAgICAgICAgfSk7CiAgICB9LAogICAgLy8g5aSH5Lu96K6w5b2V6KGo5YiX6KGoCiAgICBnZXRmaWxlTGlzdCgpIHsKICAgICAgdGhpcy5sb2FkaW5nMyA9IHRydWU7CiAgICAgIGZpbGVzTGlzdEFwaSgpCiAgICAgICAgLnRoZW4oYXN5bmMgKHJlcykgPT4gewogICAgICAgICAgbGV0IGRhdGEgPSByZXMuZGF0YTsKICAgICAgICAgIHRoaXMudGFiTGlzdCA9IGRhdGEubGlzdDsKICAgICAgICAgIHRoaXMubG9hZGluZzMgPSBmYWxzZTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLmxvYWRpbmczID0gZmFsc2U7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpOwogICAgICAgIH0pOwogICAgfSwKICAgIC8vIOS8mOWMluihqAogICAgZ2V0T3B0aW1pemUoKSB7CiAgICAgIGlmICh0aGlzLnNlbGVjdGlvbkxpc3QubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2Uud2FybmluZygn6K+36YCJ5oup6KGoJyk7CiAgICAgIH0KICAgICAgYmFja3VwT3B0aW1pemVBcGkodGhpcy5kYXRhTGlzdCkKICAgICAgICAudGhlbihhc3luYyAocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MocmVzLm1zZyk7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKHJlcykgPT4gewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMubXNnKTsKICAgICAgICB9KTsKICAgIH0sCiAgICAvLyDkv67lpI3ooagKICAgIGdldFJlcGFpcigpIHsKICAgICAgaWYgKHRoaXMuc2VsZWN0aW9uTGlzdC5sZW5ndGggPT09IDApIHsKICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS53YXJuaW5nKCfor7fpgInmi6nooagnKTsKICAgICAgfQogICAgICBiYWNrdXBSZXBhaXJBcGkodGhpcy5kYXRhTGlzdCkKICAgICAgICAudGhlbihhc3luYyAocmVzKSA9PiB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MocmVzLm1zZyk7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKHJlcykgPT4gewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMubXNnKTsKICAgICAgICB9KTsKICAgIH0sCiAgICAvLyDmlbDmja7lupPliJfooagKICAgIGdldExpc3QoKSB7CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgIGJhY2t1cExpc3RBcGkoKQogICAgICAgIC50aGVuKGFzeW5jIChyZXMpID0+IHsKICAgICAgICAgIGxldCBkYXRhID0gcmVzLmRhdGE7CiAgICAgICAgICB0aGlzLnRhYkxpc3QyID0gZGF0YS5saXN0OwogICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKHJlcykgPT4gewogICAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpOwogICAgICAgIH0pOwogICAgfSwKICAgIC8vIOivpuaDhQogICAgSW5mbyhyb3cpIHsKICAgICAgdGhpcy5yb3dzID0gcm93OwogICAgICB0aGlzLm1vZGFscyA9IHRydWU7CiAgICAgIHRoaXMubG9hZGluZzIgPSB0cnVlOwogICAgICBsZXQgZGF0YSA9IHsKICAgICAgICB0YWJsZW5hbWU6IHJvdy5uYW1lLAogICAgICB9OwogICAgICBiYWNrdXBSZWFkTGlzdEFwaShkYXRhKQogICAgICAgIC50aGVuKGFzeW5jIChyZXMpID0+IHsKICAgICAgICAgIGxldCBkYXRhID0gcmVzLmRhdGE7CiAgICAgICAgICB0aGlzLnRhYkxpc3QzID0gZGF0YS5saXN0OwogICAgICAgICAgdGhpcy5sb2FkaW5nMiA9IGZhbHNlOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChyZXMpID0+IHsKICAgICAgICAgIHRoaXMubG9hZGluZzIgPSBmYWxzZTsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzLm1zZyk7CiAgICAgICAgfSk7CiAgICB9LAogICAgaXNFZGl0TWFyayhyb3cpIHsKICAgICAgcm93LmlzX2VkaXQgPSB0cnVlOwogICAgICB0aGlzLiRuZXh0VGljaygoZSkgPT4gewogICAgICAgIHRoaXMuJHJlZnMubWFyay5mb2N1cygpOwogICAgICB9KTsKICAgIH0sCiAgICBpc0VkaXRCbHVyKHJvdywgdHlwZSkgewogICAgICByb3cuaXNfZWRpdCA9IGZhbHNlOwogICAgICB0aGlzLmNoYW5nZU1hcmtEYXRhLnRhYmxlID0gcm93Lm5hbWUgfHwgcm93LlRBQkxFX05BTUU7CiAgICAgIHRoaXMuY2hhbmdlTWFya0RhdGEuZmllbGQgPSByb3cuQ09MVU1OX05BTUUgfHwgJyc7CiAgICAgIHRoaXMuY2hhbmdlTWFya0RhdGEudHlwZSA9IHJvdy5DT0xVTU5fVFlQRSB8fCAnJzsKICAgICAgdGhpcy5jaGFuZ2VNYXJrRGF0YS5pc19maWVsZCA9IHR5cGU7CiAgICAgIHRoaXMuY2hhbmdlTWFya0RhdGEubWFyayA9IHR5cGUgPyByb3cuQ09MVU1OX0NPTU1FTlQgOiByb3cuY29tbWVudDsKCiAgICAgIHVwZGF0ZU1hcmsodGhpcy5jaGFuZ2VNYXJrRGF0YSkKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAvLyB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MocmVzLm1zZyk7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGVycikgPT4gewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihlcnIubXNnKTsKICAgICAgICB9KTsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAqLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/system/maintain/systemDatabackup","sourcesContent":["<template>\n  <div>\n    <el-card :bordered=\"false\" :body-style=\"{ padding: '0 20px 20px' }\">\n      <el-tabs>\n        <el-tab-pane label=\"数据库列表\">\n          <!--          <el-card :bordered=\"false\" shadow=\"never\" class=\"tableBox\">-->\n          <div class=\"mb10\">\n            <!--              <span class=\"ivu-pl-8 mr10\">数据库表列表</span>-->\n            <el-button type=\"primary\" @click=\"getBackup\">备份</el-button>\n            <el-button type=\"primary\" @click=\"getOptimize\">优化表</el-button>\n            <el-button type=\"primary\" @click=\"getRepair\">修复表</el-button>\n            <el-button type=\"primary\" @click=\"exportData(1)\">导出文件</el-button>\n          </div>\n          <el-table\n            ref=\"selection\"\n            :data=\"tabList2\"\n            v-loading=\"loading\"\n            empty-text=\"暂无数据\"\n            @select=\"onSelectTab\"\n            @select-all=\"onSelectTab\"\n            class=\"mt14\"\n          >\n            <el-table-column type=\"selection\" width=\"55\"> </el-table-column>\n            <el-table-column label=\"表名称\" min-width=\"100\">\n              <template slot-scope=\"scope\">\n                <span>{{ scope.row.name }}</span>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"备注\" min-width=\"100\">\n              <template slot-scope=\"scope\">\n                <div class=\"mark\">\n                  <div v-if=\"scope.row.is_edit\" class=\"table-mark\" @click=\"isEditMark(scope.row)\">\n                    {{ scope.row.comment }}\n                  </div>\n                  <el-input ref=\"mark\" v-else v-model=\"scope.row.comment\" @blur=\"isEditBlur(scope.row, 0)\"></el-input>\n                </div>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"类型\" min-width=\"100\">\n              <template slot-scope=\"scope\">\n                <span>{{ scope.row.engine }}</span>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"大小\" min-width=\"100\">\n              <template slot-scope=\"scope\">\n                <span>{{ scope.row.data_length }}</span>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"更新时间\" min-width=\"100\">\n              <template slot-scope=\"scope\">\n                <span>{{ scope.row.update_time }}</span>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"行数\" min-width=\"100\">\n              <template slot-scope=\"scope\">\n                <span>{{ scope.row.rows }}</span>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"操作\" fixed=\"right\" width=\"70\">\n              <template slot-scope=\"scope\">\n                <a @click=\"Info(scope.row)\">详情</a>\n              </template>\n            </el-table-column>\n          </el-table>\n          <!--          </el-card>-->\n          <!-- 详情模态框-->\n          <el-drawer\n            :visible.sync=\"modals\"\n            :wrapperClosable=\"false\"\n            :size=\"740\"\n            :title=\"'[ ' + rows.name + ' ]' + rows.comment\"\n          >\n            <el-table\n              ref=\"selection\"\n              :data=\"tabList3\"\n              v-loading=\"loading2\"\n              empty-text=\"暂无数据\"\n              max-height=\"600\"\n              size=\"small\"\n            >\n              <el-table-column label=\"字段名\" min-width=\"100\">\n                <template slot-scope=\"scope\">\n                  <span>{{ scope.row.COLUMN_NAME }}</span>\n                </template>\n              </el-table-column>\n              <el-table-column label=\"数据类型\" min-width=\"100\">\n                <template slot-scope=\"scope\">\n                  <span>{{ scope.row.COLUMN_TYPE }}</span>\n                </template>\n              </el-table-column>\n              <el-table-column label=\"默认值\" min-width=\"100\">\n                <template slot-scope=\"scope\">\n                  <span>{{ scope.row.COLUMN_DEFAULT }}</span>\n                </template>\n              </el-table-column>\n              <el-table-column label=\"允许非空\" min-width=\"100\">\n                <template slot-scope=\"scope\">\n                  <span>{{ scope.row.IS_NULLABLE }}</span>\n                </template>\n              </el-table-column>\n              <el-table-column label=\"自动递增\" min-width=\"100\">\n                <template slot-scope=\"scope\">\n                  <span>{{ scope.row.EXTRA }}</span>\n                </template>\n              </el-table-column>\n              <el-table-column label=\"备注\" min-width=\"100\">\n                <template slot-scope=\"scope\">\n                  <div class=\"mark\">\n                    <div v-if=\"scope.row.is_edit\" class=\"table-mark\" @click=\"isEditMark(scope.row)\">\n                      {{ scope.row.COLUMN_COMMENT }}\n                    </div>\n                    <el-input\n                      ref=\"mark\"\n                      v-else\n                      v-model=\"scope.row.COLUMN_COMMENT\"\n                      @blur=\"isEditBlur(scope.row, 1)\"\n                    ></el-input>\n                  </div>\n                </template>\n              </el-table-column>\n            </el-table>\n          </el-drawer>\n        </el-tab-pane>\n        <el-tab-pane label=\"备份列表\">\n          <el-table\n            ref=\"selection\"\n            :data=\"tabList\"\n            v-loading=\"loading3\"\n            empty-text=\"暂无数据\"\n            highlight-current-row\n            size=\"small\"\n          >\n            <el-table-column label=\"备份名称\" min-width=\"200\">\n              <template slot-scope=\"scope\">\n                <span>{{ scope.row.filename }}</span>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"part\" min-width=\"100\">\n              <template slot-scope=\"scope\">\n                <span>{{ scope.row.part }}</span>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"大小\" min-width=\"100\">\n              <template slot-scope=\"scope\">\n                <span>{{ scope.row.size }}</span>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"compress\" min-width=\"100\">\n              <template slot-scope=\"scope\">\n                <span>{{ scope.row.compress }}</span>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"时间\" min-width=\"100\">\n              <template slot-scope=\"scope\">\n                <span>{{ scope.row.backtime }}</span>\n              </template>\n            </el-table-column>\n            <el-table-column label=\"操作\" fixed=\"right\" width=\"140\">\n              <template slot-scope=\"scope\">\n                <a @click=\"ImportFile(scope.row)\">导入</a>\n                <el-divider direction=\"vertical\"></el-divider>\n                <a @click=\"del(scope.row, '删除该备份', scope.$index)\">删除</a>\n                <el-divider direction=\"vertical\"></el-divider>\n                <a @click=\"download(scope.row)\">下载</a>\n              </template>\n            </el-table-column>\n          </el-table>\n        </el-tab-pane>\n      </el-tabs>\n    </el-card>\n    <el-dialog :visible.sync=\"markModal\" width=\"470px\" title=\"修改备注\" @closed=\"cancel\">\n      <el-input v-model=\"mark\"></el-input>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"cancel\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"ok\">确 定</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport {\n  backupListApi,\n  backupReadListApi,\n  backupBackupApi,\n  backupOptimizeApi,\n  backupRepairApi,\n  filesListApi,\n  filesDownloadApi,\n  filesImportApi,\n  updateMark,\n} from '@/api/system';\nimport Setting from '@/setting';\nimport { getCookies } from '@/libs/util';\n\nexport default {\n  name: 'systemDatabackup',\n  data() {\n    return {\n      modals: false,\n      loading: false,\n      tabList: [],\n      tabList2: [],\n      selectionList: [],\n      tabList3: [],\n      rows: {},\n      dataList: {},\n      loading2: false,\n      loading3: false,\n      markModal: false,\n      mark: '',\n      header: {},\n      Token: '',\n      changeMarkData: {\n        table: '',\n        mark: '',\n        type: '',\n        field: '',\n      },\n    };\n  },\n  computed: {\n    fileUrl() {\n      const search = '/adminapi/';\n      const start = Setting.apiBaseURL.indexOf(search);\n      return Setting.apiBaseURL.substring(0, start); // 截取字符串\n    },\n  },\n  created() {\n    this.getToken();\n    this.getList();\n    this.getfileList();\n  },\n  methods: {\n    editMark(row, type) {\n      this.changeMarkData.table = row.name || row.TABLE_NAME;\n      this.changeMarkData.field = row.COLUMN_NAME || '';\n      this.changeMarkData.type = row.COLUMN_TYPE || '';\n      this.changeMarkData.is_field = type;\n      this.markModal = true;\n    },\n    ok() {\n      this.changeMarkData.mark = this.mark;\n      updateMark(this.changeMarkData).then((res) => {\n        this.$message.success(res.msg);\n        if (this.changeMarkData.is_field) {\n          this.Info({ name: this.changeMarkData.table, comment: this.rows.comment });\n        } else {\n          this.getList();\n        }\n      });\n    },\n    cancel() {\n      this.mark = '';\n    },\n    // 导入\n    ImportFile(row) {\n      filesImportApi({\n        part: row.part,\n        time: row.time,\n      })\n        .then(async (res) => {\n          this.$message.success(res.msg);\n          this.getfileList();\n        })\n        .catch((res) => {\n          this.loading = false;\n          this.$message.error(res.msg);\n        });\n    },\n    // 删除备份记录表\n    del(row, tit, num) {\n      let delfromData = {\n        title: tit,\n        num: num,\n        url: `system/backup/del_file`,\n        method: 'DELETE',\n        ids: {\n          filename: row.time,\n        },\n      };\n      this.$modalSure(delfromData)\n        .then((res) => {\n          this.$message.success(res.msg);\n          this.tabList.splice(num, 1);\n        })\n        .catch((res) => {\n          this.$message.error(res.msg);\n        });\n    },\n    // 上传头部token\n    getToken() {\n      this.Token = getCookies('token');\n    },\n    download(row) {\n      let data = {\n        time: row.time,\n      };\n      filesDownloadApi(data)\n        .then((res) => {\n          if (res.data.key) {\n            window.open(Setting.apiBaseURL + '/download?key=' + res.data.key);\n          }\n        })\n        .catch((res) => {\n          this.$message.error(res);\n        });\n    },\n    // 导出备份记录表\n    exportData() {\n      const columns = this.columns.slice(1, 7);\n      this.$refs.selection.exportCsv({\n        filename: '导出',\n        columns: columns,\n        data: this.tabList2,\n      });\n    },\n    // 全选\n    onSelectTab(selection) {\n      this.selectionList = selection;\n      let tables = [];\n      this.selectionList.map((item) => {\n        tables.push(item.name);\n      });\n      this.dataList = {\n        tables: tables.join(','),\n      };\n    },\n    // 备份表\n    getBackup() {\n      if (this.selectionList.length === 0) {\n        return this.$message.warning('请选择表');\n      }\n      backupBackupApi(this.dataList)\n        .then(async (res) => {\n          this.$message.success(res.msg);\n          this.getfileList();\n        })\n        .catch((res) => {\n          this.loading = false;\n          this.$message.error(res.msg);\n        });\n    },\n    // 备份记录表列表\n    getfileList() {\n      this.loading3 = true;\n      filesListApi()\n        .then(async (res) => {\n          let data = res.data;\n          this.tabList = data.list;\n          this.loading3 = false;\n        })\n        .catch((res) => {\n          this.loading3 = false;\n          this.$message.error(res.msg);\n        });\n    },\n    // 优化表\n    getOptimize() {\n      if (this.selectionList.length === 0) {\n        return this.$message.warning('请选择表');\n      }\n      backupOptimizeApi(this.dataList)\n        .then(async (res) => {\n          this.$message.success(res.msg);\n        })\n        .catch((res) => {\n          this.$message.error(res.msg);\n        });\n    },\n    // 修复表\n    getRepair() {\n      if (this.selectionList.length === 0) {\n        return this.$message.warning('请选择表');\n      }\n      backupRepairApi(this.dataList)\n        .then(async (res) => {\n          this.$message.success(res.msg);\n        })\n        .catch((res) => {\n          this.$message.error(res.msg);\n        });\n    },\n    // 数据库列表\n    getList() {\n      this.loading = true;\n      backupListApi()\n        .then(async (res) => {\n          let data = res.data;\n          this.tabList2 = data.list;\n          this.loading = false;\n        })\n        .catch((res) => {\n          this.loading = false;\n          this.$message.error(res.msg);\n        });\n    },\n    // 详情\n    Info(row) {\n      this.rows = row;\n      this.modals = true;\n      this.loading2 = true;\n      let data = {\n        tablename: row.name,\n      };\n      backupReadListApi(data)\n        .then(async (res) => {\n          let data = res.data;\n          this.tabList3 = data.list;\n          this.loading2 = false;\n        })\n        .catch((res) => {\n          this.loading2 = false;\n          this.$message.error(res.msg);\n        });\n    },\n    isEditMark(row) {\n      row.is_edit = true;\n      this.$nextTick((e) => {\n        this.$refs.mark.focus();\n      });\n    },\n    isEditBlur(row, type) {\n      row.is_edit = false;\n      this.changeMarkData.table = row.name || row.TABLE_NAME;\n      this.changeMarkData.field = row.COLUMN_NAME || '';\n      this.changeMarkData.type = row.COLUMN_TYPE || '';\n      this.changeMarkData.is_field = type;\n      this.changeMarkData.mark = type ? row.COLUMN_COMMENT : row.comment;\n\n      updateMark(this.changeMarkData)\n        .then((res) => {\n          // this.$message.success(res.msg);\n        })\n        .catch((err) => {\n          this.$message.error(err.msg);\n        });\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"stylus\">\n::v-deep .el-tabs__item {\n  height: 54px !important;\n  line-height: 54px !important;\n}\n.tableBox ::v-deep .ivu-table-header table\n   border none !important\n\n.table-mark{\n  cursor: text;\n}\n.table-mark:hover{\n  border:1px solid #c2c2c2;\n  padding: 3px 5px\n}\n.mark ::v-deep .ivu-input{\n    background: #fff;\n    border-radius: .39rem;\n}\n.mark ::v-deep .ivu-input, .ivu-input:hover, .ivu-input:focus {\n    border: transparent;\n    box-shadow: none;\n}\n</style>\n"]}]}