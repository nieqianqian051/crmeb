{"remainingRequest":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/babel-loader/lib/index.js!/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/pages/kefu/pc/components/chatList.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/pages/kefu/pc/components/chatList.vue","mtime":1719467759000},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/babel.config.js","mtime":1679965410000},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/.babelrc","mtime":1679965410000},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":1746465018509},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/babel-loader/lib/index.js","mtime":1746465024347},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":1746465018509},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js","mtime":1746465019530}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc3BsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgeyBTb2NrZXQgfSBmcm9tICdAL2xpYnMvc29ja2V0JzsKaW1wb3J0IGRheWpzIGZyb20gJ2RheWpzJzsKaW1wb3J0IHsgcmVjb3JkIH0gZnJvbSAnQC9hcGkva2VmdSc7CmltcG9ydCB7IEhhcHB5U2Nyb2xsIH0gZnJvbSAndnVlLWhhcHB5LXNjcm9sbCc7CmltcG9ydCBlbXB0eSBmcm9tICcuLi8uLi9jb21wb25lbnRzL2VtcHR5JzsKaW1wb3J0IHsgZm9yRWFjaCB9IGZyb20gJy4uLy4uLy4uLy4uL2xpYnMvdG9vbHMnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ2NoYXRMaXN0JywKICBwcm9wczogewogICAgdXNlck9ubGluZTogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIGRlZmF1bHQ6IGZ1bmN0aW9uIF9kZWZhdWx0KCkgewogICAgICAgIHJldHVybiB7fTsKICAgICAgfQogICAgfSwKICAgIG5ld1JlY29yZWQ6IHsKICAgICAgdHlwZTogT2JqZWN0LAogICAgICBkZWZhdWx0OiBmdW5jdGlvbiBfZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4ge307CiAgICAgIH0KICAgIH0sCiAgICBzZWFyY2hEYXRhOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogJycKICAgIH0KICB9LAogIGNvbXBvbmVudHM6IHsKICAgIEhhcHB5U2Nyb2xsOiBIYXBweVNjcm9sbCwKICAgIGVtcHR5OiBlbXB0eQogIH0sCiAgd2F0Y2g6IHsKICAgIHVzZXJPbmxpbmU6IHsKICAgICAgaGFuZGxlcjogZnVuY3Rpb24gaGFuZGxlcihuVmFsLCBvVmFsKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgICBpZiAoblZhbC5oYXNPd25Qcm9wZXJ0eSgndG9fdWlkJykpIHsKICAgICAgICAgIHRoaXMudXNlckxpc3QuZm9yRWFjaChmdW5jdGlvbiAoZWwsIGluZGV4KSB7CiAgICAgICAgICAgIGlmIChlbC50b191aWQgPT0gblZhbC50b191aWQpIHsKICAgICAgICAgICAgICBlbC5vbmxpbmUgPSBuVmFsLm9ubGluZTsKICAgICAgICAgICAgICBpZiAoblZhbC5vbmxpbmUgPT0gMSkgewogICAgICAgICAgICAgICAgX3RoaXMuJG5vdGlmeS5pbmZvKHsKICAgICAgICAgICAgICAgICAgdGl0bGU6ICfkuIrnur/pgJrnn6UnLAogICAgICAgICAgICAgICAgICBtZXNzYWdlOiAiIi5jb25jYXQoZWwubmlja25hbWUsICJcdTRFMEFcdTdFQkYiKQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRlZXA6IHRydWUKICAgIH0sCiAgICBzZWFyY2hEYXRhOiB7CiAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uIGhhbmRsZXIoblZhbCwgb1ZhbCkgewogICAgICAgIGlmIChuVmFsICE9IG9WYWwpIHsKICAgICAgICAgIHRoaXMubmlja25hbWUgPSBuVmFsOwogICAgICAgICAgdGhpcy5wYWdlID0gMTsKICAgICAgICAgIHRoaXMuaXNTY3JvbGwgPSB0cnVlOwogICAgICAgICAgdGhpcy51c2VyTGlzdCA9IFtdOwogICAgICAgICAgdGhpcy5nZXRMaXN0KCk7CiAgICAgICAgfQogICAgICB9LAogICAgICBkZWVwOiB0cnVlCiAgICB9CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaGRUYWJDdXI6IDAsCiAgICAgIGhkVGFiOiBbewogICAgICAgIGtleTogMCwKICAgICAgICB0aXRsZTogJ+eUqOaIt+WIl+ihqCcKICAgICAgfSwgewogICAgICAgIGtleTogMSwKICAgICAgICB0aXRsZTogJ+a4uOWuouWIl+ihqCcKICAgICAgfV0sCiAgICAgIHVzZXJMaXN0OiBbXSwKICAgICAgY3VySWQ6ICcnLAogICAgICBwYWdlOiAxLAogICAgICBsaW1pdDogMTUsCiAgICAgIGlzU2Nyb2xsOiB0cnVlLAogICAgICBuaWNrbmFtZTogJycsCiAgICAgIGlzU2VhcmNoOiBmYWxzZSwKICAgICAgb3BzOiB7CiAgICAgICAgdnVlc2Nyb2xsOiB7CiAgICAgICAgICBtb2RlOiAnbmF0aXZlJywKICAgICAgICAgIGVuYWJsZTogZmFsc2UsCiAgICAgICAgICB0aXBzOiB7CiAgICAgICAgICAgIGRlYWN0aXZlOiAnUHVzaCB0byBMb2FkJywKICAgICAgICAgICAgYWN0aXZlOiAnUmVsZWFzZSB0byBMb2FkJywKICAgICAgICAgICAgc3RhcnQ6ICdMb2FkaW5nLi4uJywKICAgICAgICAgICAgYmVmb3JlRGVhY3RpdmU6ICdMb2FkIFN1Y2Nlc3NmdWxseSEnCiAgICAgICAgICB9LAogICAgICAgICAgYXV0bzogZmFsc2UsCiAgICAgICAgICBhdXRvTG9hZERpc3RhbmNlOiAwLAogICAgICAgICAgcHVsbFJlZnJlc2g6IHsKICAgICAgICAgICAgZW5hYmxlOiBmYWxzZQogICAgICAgICAgfSwKICAgICAgICAgIHB1c2hMb2FkOiB7CiAgICAgICAgICAgIGVuYWJsZTogdHJ1ZSwKICAgICAgICAgICAgYXV0bzogdHJ1ZSwKICAgICAgICAgICAgYXV0b0xvYWREaXN0YW5jZTogMTAKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGJhcjogewogICAgICAgICAgYmFja2dyb3VuZDogJyMzOTMyMzInLAogICAgICAgICAgb3BhY2l0eTogJy41JywKICAgICAgICAgIHNpemU6ICc1cHgnCiAgICAgICAgfQogICAgICB9CiAgICB9OwogIH0sCiAgZmlsdGVyczogewogICAgdG9EYXk6IGZ1bmN0aW9uIHRvRGF5KHZhbHVlKSB7CiAgICAgIGlmICghdmFsdWUpIHJldHVybiAnJzsKICAgICAgcmV0dXJuIGRheWpzLnVuaXgodmFsdWUpLmZvcm1hdCgnTeaciETml6UgSEg6bW0nKTsKICAgIH0KICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgIHZhciB0aGF0ID0gdGhpczsKICAgIFNvY2tldC50aGVuKGZ1bmN0aW9uICh3cykgewogICAgICAvL+eUqOaIt+i9rOaOpQogICAgICB3cy4kb24oJ3RyYW5zZmVyJywgZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICB2YXIgc3RhdHVzID0gZmFsc2U7CiAgICAgICAgdGhhdC51c2VyTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChlbCwgaW5kZXgsIGFycikgewogICAgICAgICAgaWYgKGRhdGEucmVjb3JlZC5pZCA9PSBlbC5pZCkgewogICAgICAgICAgICBzdGF0dXMgPSB0cnVlOwogICAgICAgICAgICBpZiAoZGF0YS5yZWNvcmVkLmlzX3RvdXJpc3QgPT0gdGhhdC5oZFRhYkN1cikgewogICAgICAgICAgICAgIHZhciBvbGRWYWwgPSBkYXRhLnJlY29yZWQ7CiAgICAgICAgICAgICAgYXJyLnNwbGljZShpbmRleCwgMSk7CiAgICAgICAgICAgICAgaWYgKGluZGV4ID09IDApIHsKICAgICAgICAgICAgICAgIF90aGlzMi4kZW1pdCgnc2V0RGF0YUlkJywgb2xkVmFsKTsKICAgICAgICAgICAgICAgIG9sZFZhbC5tc3NhZ2VfbnVtID0gMDsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgYXJyLnVuc2hpZnQob2xkVmFsKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBfdGhpczIuJG5vdGlmeS5pbmZvKHsKICAgICAgICAgICAgICB0aXRsZTogJ+aCqOacieS4gOadoei9rOaOpea2iOaBr++8gScKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgaWYgKCFzdGF0dXMpIHsKICAgICAgICAgIGlmIChkYXRhLnJlY29yZWQuaXNfdG91cmlzdCA9PSBfdGhpczIuaGRUYWJDdXIpIF90aGlzMi51c2VyTGlzdC51bnNoaWZ0KGRhdGEucmVjb3JlZCk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgd3MuJG9uKCdtc3NhZ2VfbnVtJywgZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICBpZiAoZGF0YS5yZWNvcmVkLmlkKSB7CiAgICAgICAgICB2YXIgc3RhdHVzID0gZmFsc2U7CiAgICAgICAgICB0aGF0LnVzZXJMaXN0LmZvckVhY2goZnVuY3Rpb24gKGVsLCBpbmRleCwgYXJyKSB7CiAgICAgICAgICAgIGlmIChkYXRhLnJlY29yZWQuaWQgPT0gZWwuaWQpIHsKICAgICAgICAgICAgICBzdGF0dXMgPSB0cnVlOwogICAgICAgICAgICAgIGlmIChkYXRhLnJlY29yZWQuaXNfdG91cmlzdCA9PSB0aGF0LmhkVGFiQ3VyKSB7CiAgICAgICAgICAgICAgICB2YXIgb2xkVmFsID0gZGF0YS5yZWNvcmVkOwogICAgICAgICAgICAgICAgYXJyLnNwbGljZShpbmRleCwgMSk7CiAgICAgICAgICAgICAgICBhcnIudW5zaGlmdChvbGRWYWwpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoIXN0YXR1cykgewogICAgICAgICAgICBpZiAoZGF0YS5yZWNvcmVkLmlzX3RvdXJpc3QgPT0gX3RoaXMyLmhkVGFiQ3VyKSBfdGhpczIudXNlckxpc3QudW5zaGlmdChkYXRhLnJlY29yZWQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoZGF0YS5yZWNvcmVkLmlzX3RvdXJpc3QgIT0gX3RoaXMyLmhkVGFiQ3VyICYmIGRhdGEucmVjb3JlZC5pZCkgewogICAgICAgICAgX3RoaXMyLiRub3RpZnkuaW5mbyh7CiAgICAgICAgICAgIHRpdGxlOiBfdGhpczIuaGRUYWJDdXIgPyAn55So5oi35Y+R5p2l5raI5oGv5ZWm77yBJyA6ICfmuLjlrqLlj5HmnaXmtojmga/llabvvIEnCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSk7CiAgICB0aGlzLmJ1cy4kb24oJ2NoYW5nZScsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgIF90aGlzMi5uaWNrbmFtZSA9IGRhdGE7CiAgICB9KTsKICAgIHRoaXMuZ2V0TGlzdCgpOwogIH0sCiAgbWV0aG9kczogewogICAgLy/liIfmjaIKICAgIGNoYW5nZVRhYjogZnVuY3Rpb24gY2hhbmdlVGFiKGl0ZW0pIHsKICAgICAgaWYgKHRoaXMuaGRUYWJDdXIgPT0gaXRlbS5rZXkpIHJldHVybjsKICAgICAgdGhpcy5oZFRhYkN1ciA9IGl0ZW0ua2V5OwogICAgICB0aGlzLmlzU2Nyb2xsID0gdHJ1ZTsKICAgICAgdGhpcy5wYWdlID0gMTsKICAgICAgdGhpcy51c2VyTGlzdCA9IFtdOwogICAgICB0aGlzLiRlbWl0KCdjaGFuZ2VUeXBlJywgaXRlbS5rZXkpOwogICAgICB0aGlzLmdldExpc3QoKTsKICAgIH0sCiAgICBnZXRMaXN0OiBmdW5jdGlvbiBnZXRMaXN0KCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKICAgICAgaWYgKCF0aGlzLmlzU2Nyb2xsKSByZXR1cm47CiAgICAgIHJlY29yZCh7CiAgICAgICAgbmlja25hbWU6IHRoaXMubmlja25hbWUsCiAgICAgICAgcGFnZTogdGhpcy5wYWdlLAogICAgICAgIGxpbWl0OiB0aGlzLmxpbWl0LAogICAgICAgIGlzX3RvdXJpc3Q6IHRoaXMuaGRUYWJDdXIKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgaWYgKHJlcy5kYXRhLmxlbmd0aCA+IDApIHsKICAgICAgICAgIHJlcy5kYXRhWzBdLm1zc2FnZV9udW0gPSAwOwogICAgICAgICAgX3RoaXMzLmlzU2Nyb2xsID0gcmVzLmRhdGEubGVuZ3RoID49IF90aGlzMy5saW1pdDsKICAgICAgICAgIF90aGlzMy51c2VyTGlzdCA9IF90aGlzMy51c2VyTGlzdC5jb25jYXQocmVzLmRhdGEpOwogICAgICAgICAgaWYgKF90aGlzMy5wYWdlID09IDEgJiYgcmVzLmRhdGEubGVuZ3RoID4gMCAmJiAhX3RoaXMzLmlzU2VhcmNoKSB7CiAgICAgICAgICAgIF90aGlzMy5jdXJJZCA9IHJlcy5kYXRhWzBdLmlkOwogICAgICAgICAgICBfdGhpczMuJGVtaXQoJ3NldERhdGFJZCcsIHJlcy5kYXRhWzBdKTsKICAgICAgICAgIH0KICAgICAgICAgIF90aGlzMy5wYWdlKys7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF90aGlzMy4kZW1pdCgnc2V0RGF0YUlkJywgMCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBjaGFydFJlYWNoQm90dG9tOiBmdW5jdGlvbiBjaGFydFJlYWNoQm90dG9tKCkgewogICAgICB0aGlzLmdldExpc3QoKTsKICAgIH0sCiAgICAvLyDpgInmi6nnlKjmiLcKICAgIHNlbGVjdFVzZXI6IGZ1bmN0aW9uIHNlbGVjdFVzZXIoaXRlbSkgewogICAgICBpZiAodGhpcy5jdXJJZCA9PSBpdGVtLmlkKSByZXR1cm47CiAgICAgIGl0ZW0ubXNzYWdlX251bSA9IDA7CiAgICAgIHRoaXMuY3VySWQgPSBpdGVtLmlkOwogICAgICB0aGlzLiRlbWl0KCdzZXREYXRhSWQnLCBpdGVtKTsKICAgIH0sCiAgICBoYW5kbGVTY3JvbGw6IGZ1bmN0aW9uIGhhbmRsZVNjcm9sbCh2ZXJ0aWNhbCwgaG9yaXpvbnRhbCwgbmF0aXZlRXZlbnQpIHsKICAgICAgaWYgKHZlcnRpY2FsLnByb2Nlc3MgPT0gMSkgewogICAgICAgIHRoaXMuZ2V0TGlzdCgpOwogICAgICB9CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["Socket","dayjs","record","HappyScroll","empty","forEach","name","props","userOnline","type","Object","default","newRecored","searchData","String","components","watch","handler","nVal","oVal","_this","hasOwnProperty","userList","el","index","to_uid","online","$notify","info","title","message","concat","nickname","deep","page","isScroll","getList","data","hdTabCur","hdTab","key","curId","limit","isSearch","ops","vuescroll","mode","enable","tips","deactive","active","start","beforeDeactive","auto","autoLoadDistance","pullRefresh","pushLoad","bar","background","opacity","size","filters","toDay","value","unix","format","mounted","_this2","that","then","ws","$on","status","arr","recored","id","is_tourist","oldVal","splice","$emit","mssage_num","unshift","bus","methods","changeTab","item","_this3","res","length","chartReachBottom","selectUser","handleScroll","vertical","horizontal","nativeEvent","process"],"sources":["src/pages/kefu/pc/components/chatList.vue"],"sourcesContent":["<template>\n  <div class=\"chatList\">\n    <div class=\"tab-head\">\n      <div\n        class=\"item\"\n        :class=\"{ active: item.key == hdTabCur }\"\n        v-for=\"(item, index) in hdTab\"\n        :key=\"index\"\n        @click=\"changeTab(item)\"\n      >\n        {{ item.title }}\n      </div>\n    </div>\n    <div class=\"scroll-box\">\n      <vue-scroll :ops=\"ops\" @handle-scroll=\"handleScroll\" v-if=\"userList.length > 0\">\n        <div\n          class=\"chat-item\"\n          v-for=\"(item, index) in userList\"\n          :key=\"index\"\n          :class=\"{ active: curId == item.id }\"\n          @click=\"selectUser(item)\"\n        >\n          <div class=\"avatar\">\n            <img v-lazy=\"item.wx_avatar\" alt=\"\" />\n            <div class=\"status\" :class=\"{ off: item.online == 0 }\"></div>\n          </div>\n          <div class=\"user-info\">\n            <div class=\"hd\">\n              <span class=\"name line1\">{{ item.nickname }}</span>\n              <template v-if=\"item.type == 2\">\n                <span class=\"label\">小程序</span>\n              </template>\n              <template v-if=\"item.type == 3\">\n                <span class=\"label H5\">H5</span>\n              </template>\n              <template v-if=\"item.type == 1\">\n                <span class=\"label wechat\">公众号</span>\n              </template>\n              <template v-if=\"item.type == 0\">\n                <span class=\"label pc\">PC端</span>\n              </template>\n            </div>\n            <div class=\"bd line1\">\n              <template v-if=\"item.message_type <= 2\">{{ item.message }}</template>\n              <template v-if=\"item.message_type == 3\">[图片]</template>\n              <template v-if=\"item.message_type == 5\">[商品]</template>\n              <template v-if=\"item.message_type == 6\">[订单]</template>\n            </div>\n          </div>\n          <div class=\"right-box\">\n            <div class=\"time\">{{ item.update_time | toDay }}</div>\n            <div class=\"num\" v-if=\"item.mssage_num > 0\">\n              <el-badge :value=\"item.mssage_num\">\n                <a href=\"#\" class=\"demo-badge\"></a>\n              </el-badge>\n            </div>\n          </div>\n        </div>\n      </vue-scroll>\n      <empty v-else msg=\"暂无用户列表\" status=\"1\"></empty>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { Socket } from '@/libs/socket';\nimport dayjs from 'dayjs';\nimport { record } from '@/api/kefu';\nimport { HappyScroll } from 'vue-happy-scroll';\nimport empty from '../../components/empty';\nimport { forEach } from '../../../../libs/tools';\nexport default {\n  name: 'chatList',\n  props: {\n    userOnline: {\n      type: Object,\n      default: function () {\n        return {};\n      },\n    },\n    newRecored: {\n      type: Object,\n      default: function () {\n        return {};\n      },\n    },\n    searchData: {\n      type: String,\n      default: '',\n    },\n  },\n  components: {\n    HappyScroll,\n    empty,\n  },\n  watch: {\n    userOnline: {\n      handler(nVal, oVal) {\n        if (nVal.hasOwnProperty('to_uid')) {\n          this.userList.forEach((el, index) => {\n            if (el.to_uid == nVal.to_uid) {\n              el.online = nVal.online;\n              if (nVal.online == 1) {\n                this.$notify.info({\n                  title: '上线通知',\n                  message: `${el.nickname}上线`,\n                });\n              }\n            }\n          });\n        }\n      },\n      deep: true,\n    },\n    searchData: {\n      handler(nVal, oVal) {\n        if (nVal != oVal) {\n          this.nickname = nVal;\n          this.page = 1;\n          this.isScroll = true;\n          this.userList = [];\n          this.getList();\n        }\n      },\n      deep: true,\n    },\n  },\n  data() {\n    return {\n      hdTabCur: 0,\n      hdTab: [\n        {\n          key: 0,\n          title: '用户列表',\n        },\n        {\n          key: 1,\n          title: '游客列表',\n        },\n      ],\n      userList: [],\n      curId: '',\n      page: 1,\n      limit: 15,\n      isScroll: true,\n      nickname: '',\n      isSearch: false,\n      ops: {\n        vuescroll: {\n          mode: 'native',\n          enable: false,\n          tips: {\n            deactive: 'Push to Load',\n            active: 'Release to Load',\n            start: 'Loading...',\n            beforeDeactive: 'Load Successfully!',\n          },\n          auto: false,\n          autoLoadDistance: 0,\n          pullRefresh: {\n            enable: false,\n          },\n          pushLoad: {\n            enable: true,\n            auto: true,\n            autoLoadDistance: 10,\n          },\n        },\n        bar: {\n          background: '#393232',\n          opacity: '.5',\n          size: '5px',\n        },\n      },\n    };\n  },\n  filters: {\n    toDay: function (value) {\n      if (!value) return '';\n      return dayjs.unix(value).format('M月D日 HH:mm');\n    },\n  },\n  mounted() {\n    let that = this;\n    Socket.then((ws) => {\n      //用户转接\n      ws.$on('transfer', (data) => {\n        let status = false;\n        that.userList.forEach((el, index, arr) => {\n          if (data.recored.id == el.id) {\n            status = true;\n            if (data.recored.is_tourist == that.hdTabCur) {\n              let oldVal = data.recored;\n              arr.splice(index, 1);\n\n              if (index == 0) {\n                this.$emit('setDataId', oldVal);\n                oldVal.mssage_num = 0;\n              }\n              arr.unshift(oldVal);\n            }\n            this.$notify.info({\n              title: '您有一条转接消息！',\n            });\n          }\n        });\n        if (!status) {\n          if (data.recored.is_tourist == this.hdTabCur) this.userList.unshift(data.recored);\n        }\n      });\n      ws.$on('mssage_num', (data) => {\n        if (data.recored.id) {\n          let status = false;\n          that.userList.forEach((el, index, arr) => {\n            if (data.recored.id == el.id) {\n              status = true;\n              if (data.recored.is_tourist == that.hdTabCur) {\n                let oldVal = data.recored;\n                arr.splice(index, 1);\n                arr.unshift(oldVal);\n              }\n            }\n          });\n          if (!status) {\n            if (data.recored.is_tourist == this.hdTabCur) this.userList.unshift(data.recored);\n          }\n        }\n        if (data.recored.is_tourist != this.hdTabCur && data.recored.id) {\n          this.$notify.info({\n            title: this.hdTabCur ? '用户发来消息啦！' : '游客发来消息啦！',\n          });\n        }\n      });\n    });\n    this.bus.$on('change', (data) => {\n      this.nickname = data;\n    });\n    this.getList();\n  },\n  methods: {\n    //切换\n    changeTab(item) {\n      if (this.hdTabCur == item.key) return;\n      this.hdTabCur = item.key;\n      this.isScroll = true;\n      this.page = 1;\n      this.userList = [];\n      this.$emit('changeType', item.key);\n      this.getList();\n    },\n    getList() {\n      if (!this.isScroll) return;\n      record({\n        nickname: this.nickname,\n        page: this.page,\n        limit: this.limit,\n        is_tourist: this.hdTabCur,\n      }).then((res) => {\n        if (res.data.length > 0) {\n          res.data[0].mssage_num = 0;\n          this.isScroll = res.data.length >= this.limit;\n\n          this.userList = this.userList.concat(res.data);\n\n          if (this.page == 1 && res.data.length > 0 && !this.isSearch) {\n            this.curId = res.data[0].id;\n            this.$emit('setDataId', res.data[0]);\n          }\n          this.page++;\n        } else {\n          this.$emit('setDataId', 0);\n        }\n      });\n    },\n    chartReachBottom() {\n      this.getList();\n    },\n    // 选择用户\n    selectUser(item) {\n      if (this.curId == item.id) return;\n      item.mssage_num = 0;\n      this.curId = item.id;\n      this.$emit('setDataId', item);\n    },\n    handleScroll(vertical, horizontal, nativeEvent) {\n      if (vertical.process == 1) {\n        this.getList();\n      }\n    },\n  },\n};\n</script>\n\n<style lang=\"stylus\" scoped>\n.chatList\n    display flex\n    flex-direction column\n    width 320px\n    height 742px\n    border-right 1px solid #ECECEC\n    .tab-head\n        display flex\n        align-items center\n        justify-content space-between\n        height 50px\n        flex-shrink 0\n        padding 0 52px\n        font-size 14px\n        color #000000\n        .item\n            position relative\n            cursor pointer\n            &:after\n                display none\n                content ' '\n                position absolute\n                left 50%\n                bottom -15px\n                transform translateX(-50%)\n                height 2px\n                width 100%\n                background var(--prev-color-primary)\n            &.active\n                color var(--prev-color-primary)\n                &:after\n                    display block\n\n    .scroll-box\n        flex 1\n        height 500px\n        overflow hidden\n    .chat-item\n        display flex\n        align-items center\n        justify-content space-between\n        padding 12px 10px\n        height 74px\n        box-sizing border-box\n        border-left 3px solid transparent\n        cursor pointer\n        &.active\n            background #EFF0F1\n            border-left 3px solid var(--prev-color-primary)\n        .avatar\n            position relative\n            width 40px\n            height 40px\n            img\n                display block\n                width 100%\n                height 100%\n                border-radius 50%\n            .status\n                position absolute\n                right 3px\n                bottom 0\n                width 8px\n                height 8px\n                background #48D452\n                border 1px solid #fff\n                border-radius 50%\n                &.off\n                    background #999999\n        .user-info\n            width 155px\n            margin-left 12px\n            margin-top: 5px;\n            font-size 16px\n            .hd\n                display flex\n                align-items center\n                color: rgba(0, 0, 0, 0.65);\n                .name\n                    max-width 67%\n                .label\n                    margin-left 5px\n                    color #3875EA\n                    font-size 12px\n                    background #D8E5FF\n                    border-radius 2px\n                    padding 1px 5px\n                    &.H5\n                        background #FAF1D0\n                        color #DC9A04\n                    &.wechat\n                        background: rgba(64, 194, 73, 0.16);\n                        color #40C249\n                    &.pc\n                        background: rgba(100, 64, 194, 0.16);;\n                        color #6440C2\n            .bd\n                margin-top 3px\n                font-size 12px\n                color #8E959E\n        .right-box\n            position relative\n            flex 1\n            display flex\n            flex-direction column\n            align-items flex-end\n            color #8E959E\n            .num\n                margin-right 12px\n.chart-scroll\n    margin-top -10px\n</style>\n"],"mappings":"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","ignoreList":[]}]}