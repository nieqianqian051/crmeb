{"remainingRequest":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/babel-loader/lib/index.js!/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/pages/system/maintain/systemFile/login.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/pages/system/maintain/systemFile/login.vue","mtime":1719467759000},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/babel.config.js","mtime":1679965410000},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/.babelrc","mtime":1679965410000},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":1746465018509},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/babel-loader/lib/index.js","mtime":1746465024347},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":1746465018509},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js","mtime":1746465019530}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiL1VzZXJzL25pZXFpYW5xaWFuL0Rvd25sb2Fkcy94aW54aWFuZ211L0NSTUVCL3RlbXBsYXRlL2FkbWluL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9yZWdlbmVyYXRvclJ1bnRpbWUuanMiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL1VzZXJzL25pZXFpYW5xaWFuL0Rvd25sb2Fkcy94aW54aWFuZ211L0NSTUVCL3RlbXBsYXRlL2FkbWluL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudGVzdC5qcyI7CmltcG9ydCB7IG9wZW5kaXJMb2dpbkFwaSB9IGZyb20gJ0AvYXBpL3N5c3RlbSc7CmltcG9ydCB7IHNldENvb2tpZXMgfSBmcm9tICdAL2xpYnMvdXRpbCc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnZmlsZV9sb2dpbicsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHZhciB2YWxpZGF0ZVBob25lID0gZnVuY3Rpb24gdmFsaWRhdGVQaG9uZShydWxlLCB2YWx1ZSwgY2FsbGJhY2spIHsKICAgICAgaWYgKCF2YWx1ZSkgewogICAgICAgIHJldHVybiBjYWxsYmFjayhuZXcgRXJyb3IoJ+ivt+Whq+WGmeaJi+acuuWPtycpKTsKICAgICAgfSBlbHNlIGlmICghL14xWzM0NTY3ODldXGR7OX0kLy50ZXN0KHZhbHVlKSkgewogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcign5omL5py65Y+35qC85byP5LiN5q2j56GuIScpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjYWxsYmFjaygpOwogICAgICB9CiAgICB9OwogICAgcmV0dXJuIHsKICAgICAgZm9ybUlubGluZTogewogICAgICAgIC8vIGFjY291bnQ6ICcnLAogICAgICAgIHBhc3N3b3JkOiAnJwogICAgICB9LAogICAgICBydWxlSW5saW5lOiB7CiAgICAgICAgLy8gYWNjb3VudDogW3sgcmVxdWlyZWQ6IHRydWUsIHZhbGlkYXRvcjogdmFsaWRhdGVQaG9uZSwgdHJpZ2dlcjogJ2JsdXInIH1dLAogICAgICAgIHBhc3N3b3JkOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWl5a+G56CBJywKICAgICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICAgIH1dCiAgICAgIH0KICAgIH07CiAgfSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKICAgIGRvY3VtZW50Lm9ua2V5ZG93biA9IGZ1bmN0aW9uIChlKSB7CiAgICAgIHZhciBrZXkgPSB3aW5kb3cuZXZlbnQua2V5Q29kZTsKICAgICAgaWYgKGtleSA9PT0gMTMpIHsKICAgICAgICBfdGhpcy5oYW5kbGVTdWJtaXQoJ2Zvcm1JbmxpbmUnKTsKICAgICAgfQogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGhhbmRsZVN1Ym1pdDogZnVuY3Rpb24gaGFuZGxlU3VibWl0KG5hbWUpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIHRoaXMuJHJlZnNbbmFtZV0udmFsaWRhdGUoZnVuY3Rpb24gKHZhbGlkKSB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBvcGVuZGlyTG9naW5BcGkoX3RoaXMyLmZvcm1JbmxpbmUpLnRoZW4oIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlKHJlcykgewogICAgICAgICAgICAgIHZhciBleHBpcmVzOwogICAgICAgICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lKCkud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIF90aGlzMi4kbWVzc2FnZS5zdWNjZXNzKCfnmbvlvZXmiJDlip8hJyk7CiAgICAgICAgICAgICAgICAgICAgLy8gICB0aGlzLiRlbWl0KCdvbi1Mb2dpbicsIHJlcy5kYXRhKTsKICAgICAgICAgICAgICAgICAgICBleHBpcmVzID0gX3RoaXMyLmdldEV4cGlyZXNUaW1lKHJlcy5kYXRhLmV4cGlyZXNfdGltZSk7IC8vIOiusOW9leeUqOaIt+eZu+mZhuS/oeaBrwogICAgICAgICAgICAgICAgICAgIHNldENvb2tpZXMoJ2ZpbGVfdG9rZW4nLCByZXMuZGF0YS50b2tlbiwgZXhwaXJlcyk7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICBwYXRoOiBfdGhpczIuJHJvdXRlUHJvU3RyICsgJy9zeXN0ZW0vbWFpbnRhaW4vc3lzdGVtX2ZpbGUvb3BlbmRpcicKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeCkgewogICAgICAgICAgICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9KCkpLmNhdGNoKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgX3RoaXMyLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpOwogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIC8v6K6h566XdG9rZW7ov4fmnJ/ml7bpl7QKICAgIGdldEV4cGlyZXNUaW1lOiBmdW5jdGlvbiBnZXRFeHBpcmVzVGltZShleHBpcmVzVGltZSkgewogICAgICB2YXIgbm93VGltZU51bSA9IE1hdGgucm91bmQobmV3IERhdGUoKSAvIDEwMDApOwogICAgICB2YXIgZXhwaXJlc1RpbWVOdW0gPSBleHBpcmVzVGltZSAtIG5vd1RpbWVOdW07CiAgICAgIHJldHVybiBwYXJzZUZsb2F0KHBhcnNlRmxvYXQocGFyc2VGbG9hdChleHBpcmVzVGltZU51bSAvIDYwKSAvIDYwKSAvIDI0KTsKICAgIH0KICB9Cn07"},{"version":3,"names":["opendirLoginApi","setCookies","name","data","validatePhone","rule","value","callback","Error","test","formInline","password","ruleInline","required","message","trigger","created","_this","document","onkeydown","e","key","window","event","keyCode","handleSubmit","methods","_this2","$refs","validate","valid","then","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","res","expires","wrap","_callee$","_context","prev","next","$message","success","getExpiresTime","expires_time","token","$router","push","path","$routeProStr","stop","_x","apply","arguments","catch","error","msg","expiresTime","nowTimeNum","Math","round","Date","expiresTimeNum","parseFloat"],"sources":["src/pages/system/maintain/systemFile/login.vue"],"sourcesContent":["<template>\n  <div>\n    <el-row >\n      <el-col :span=\"24\">\n        <div class=\"index_from page-account-container\">\n          <div class=\"page-account-top\">\n            <span class=\"page-account-top-tit\">文件管理登录</span>\n          </div>\n          <el-form ref=\"formInline\" :model=\"formInline\" :rules=\"ruleInline\" @submit.native.prevent>\n            <!-- <el-form-item prop=\"sms_account\" class=\"maxInpt\">\n            <el-input type=\"text\" v-model=\"formInline.account\" prefix=\"ios-contact-outline\" placeholder=\"请输入手机号\" />\n          </el-form-item> -->\n            <el-form-item prop=\"sms_token\" class=\"maxInpt\">\n              <el-input\n                type=\"password\"\n                size=\"large\"\n                v-model=\"formInline.password\"\n                prefix=\"ios-lock-outline\"\n                placeholder=\"请输入密码\"\n              />\n              <div class=\"trip\">提示：密码配置在 /config/filesystem.php 文件中修改 'password' => '密码'</div>\n            </el-form-item>\n            <el-form-item class=\"maxInpt\">\n              <el-button type=\"primary\" long size=\"large\" @click=\"handleSubmit('formInline')\" class=\"btn\">登录</el-button>\n            </el-form-item>\n          </el-form>\n        </div>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport { opendirLoginApi } from '@/api/system';\nimport { setCookies } from '@/libs/util';\n\nexport default {\n  name: 'file_login',\n  data() {\n    const validatePhone = (rule, value, callback) => {\n      if (!value) {\n        return callback(new Error('请填写手机号'));\n      } else if (!/^1[3456789]\\d{9}$/.test(value)) {\n        callback(new Error('手机号格式不正确!'));\n      } else {\n        callback();\n      }\n    };\n    return {\n      formInline: {\n        // account: '',\n        password: '',\n      },\n      ruleInline: {\n        // account: [{ required: true, validator: validatePhone, trigger: 'blur' }],\n        password: [{ required: true, message: '请输入密码', trigger: 'blur' }],\n      },\n    };\n  },\n  created() {\n    var _this = this;\n    document.onkeydown = function (e) {\n      let key = window.event.keyCode;\n      if (key === 13) {\n        _this.handleSubmit('formInline');\n      }\n    };\n  },\n  methods: {\n    handleSubmit(name) {\n      this.$refs[name].validate((valid) => {\n        if (valid) {\n          opendirLoginApi(this.formInline)\n            .then(async (res) => {\n              this.$message.success('登录成功!');\n              //   this.$emit('on-Login', res.data);\n              let expires = this.getExpiresTime(res.data.expires_time);\n              // 记录用户登陆信息\n              setCookies('file_token', res.data.token, expires);\n              this.$router.push({\n                path: this.$routeProStr + '/system/maintain/system_file/opendir',\n              });\n            })\n            .catch((res) => {\n              this.$message.error(res.msg);\n            });\n        } else {\n          return false;\n        }\n      });\n    },\n    //计算token过期时间\n    getExpiresTime(expiresTime) {\n      let nowTimeNum = Math.round(new Date() / 1000);\n      let expiresTimeNum = expiresTime - nowTimeNum;\n      return parseFloat(parseFloat(parseFloat(expiresTimeNum / 60) / 60) / 24);\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"stylus\">\n\n.maxInpt{\n    max-width: 500px;\n    margin-left: auto;\n    margin-right: auto;\n}\n.index_from{\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n}\n.trip{\n    width: 580px;\n    text-align: left;\n    color: #aaa;\n}\n.page-account-container{\n    text-align: center;\n    padding: 200px 0;\n}\n.page-account-top{\n    margin-bottom: 50px;\n}\n.page-account-top-tit{\n  font-size:30px;\n  color:var(--prev-color-primary);\n  font-weight:500;\n}\n\n.page-account-other{\n  text-align:center;\n  color:var(--prev-color-primary);\n  font-size:12px;\n  span{\n    cursor: pointe;\n  }\n}\n\n\n::v-deep .btn{\n  font-size: 15px !important;\n}\n</style>\n"],"mappings":";;;;;;AAiCA,SAAAA,eAAA;AACA,SAAAC,UAAA;AAEA;EACAC,IAAA;EACAC,IAAA,WAAAA,KAAA;IACA,IAAAC,aAAA,YAAAA,cAAAC,IAAA,EAAAC,KAAA,EAAAC,QAAA;MACA,KAAAD,KAAA;QACA,OAAAC,QAAA,KAAAC,KAAA;MACA,gCAAAC,IAAA,CAAAH,KAAA;QACAC,QAAA,KAAAC,KAAA;MACA;QACAD,QAAA;MACA;IACA;IACA;MACAG,UAAA;QACA;QACAC,QAAA;MACA;MACAC,UAAA;QACA;QACAD,QAAA;UAAAE,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;MACA;IACA;EACA;EACAC,OAAA,WAAAA,QAAA;IACA,IAAAC,KAAA;IACAC,QAAA,CAAAC,SAAA,aAAAC,CAAA;MACA,IAAAC,GAAA,GAAAC,MAAA,CAAAC,KAAA,CAAAC,OAAA;MACA,IAAAH,GAAA;QACAJ,KAAA,CAAAQ,YAAA;MACA;IACA;EACA;EACAC,OAAA;IACAD,YAAA,WAAAA,aAAAvB,IAAA;MAAA,IAAAyB,MAAA;MACA,KAAAC,KAAA,CAAA1B,IAAA,EAAA2B,QAAA,WAAAC,KAAA;QACA,IAAAA,KAAA;UACA9B,eAAA,CAAA2B,MAAA,CAAAjB,UAAA,EACAqB,IAAA;YAAA,IAAAC,IAAA,GAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,UAAAC,QAAAC,GAAA;cAAA,IAAAC,OAAA;cAAA,OAAAJ,mBAAA,GAAAK,IAAA,UAAAC,SAAAC,QAAA;gBAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;kBAAA;oBACAhB,MAAA,CAAAiB,QAAA,CAAAC,OAAA;oBACA;oBACAP,OAAA,GAAAX,MAAA,CAAAmB,cAAA,CAAAT,GAAA,CAAAlC,IAAA,CAAA4C,YAAA,GACA;oBACA9C,UAAA,eAAAoC,GAAA,CAAAlC,IAAA,CAAA6C,KAAA,EAAAV,OAAA;oBACAX,MAAA,CAAAsB,OAAA,CAAAC,IAAA;sBACAC,IAAA,EAAAxB,MAAA,CAAAyB,YAAA;oBACA;kBAAA;kBAAA;oBAAA,OAAAX,QAAA,CAAAY,IAAA;gBAAA;cAAA,GAAAjB,OAAA;YAAA,CACA;YAAA,iBAAAkB,EAAA;cAAA,OAAAtB,IAAA,CAAAuB,KAAA,OAAAC,SAAA;YAAA;UAAA,KACAC,KAAA,WAAApB,GAAA;YACAV,MAAA,CAAAiB,QAAA,CAAAc,KAAA,CAAArB,GAAA,CAAAsB,GAAA;UACA;QACA;UACA;QACA;MACA;IACA;IACA;IACAb,cAAA,WAAAA,eAAAc,WAAA;MACA,IAAAC,UAAA,GAAAC,IAAA,CAAAC,KAAA,KAAAC,IAAA;MACA,IAAAC,cAAA,GAAAL,WAAA,GAAAC,UAAA;MACA,OAAAK,UAAA,CAAAA,UAAA,CAAAA,UAAA,CAAAD,cAAA;IACA;EACA;AACA","ignoreList":[]}]}