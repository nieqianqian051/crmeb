{"remainingRequest":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/babel-loader/lib/index.js!/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/pages/system/crontab/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/src/pages/system/crontab/index.vue","mtime":1719467759000},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/babel.config.js","mtime":1679965410000},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/.babelrc","mtime":1679965410000},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":1746465018509},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/babel-loader/lib/index.js","mtime":1746465024347},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/cache-loader/dist/cjs.js","mtime":1746465018509},{"path":"/Users/nieqianqian/Downloads/xinxiangmu/CRMEB/template/admin/node_modules/vue-loader/lib/index.js","mtime":1746465019530}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0IHsgdGltZXJJbmRleCwgc2hvd1RpbWVyIH0gZnJvbSAnQC9hcGkvc3lzdGVtJzsKaW1wb3J0IGNyZWF0VGFzayBmcm9tICcuL2NyZWF0ZU1vZGFsLnZ1ZSc7CmltcG9ydCBzZXR0aW5nIGZyb20gJ0Avc2V0dGluZyc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnc3lzdGVtX2Nyb250YWInLAogIGNvbXBvbmVudHM6IHsKICAgIGNyZWF0VGFzazogY3JlYXRUYXNrCiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIHRhYmxlRGF0YTogW10sCiAgICAgIHBhZ2U6IDEsCiAgICAgIGxpbWl0OiAxNSwKICAgICAgdG90YWw6IDEsCiAgICAgIGFwaUJhc2VVUkw6ICcnCiAgICB9OwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMuYXBpQmFzZVVSTCA9IHNldHRpbmcuYXBpQmFzZVVSTDsKICAgIHRoaXMuZ2V0TGlzdCgpOwogIH0sCiAgbWV0aG9kczogewogICAgdGFza1RyaXA6IGZ1bmN0aW9uIHRhc2tUcmlwKHJvdykgewogICAgICBzd2l0Y2ggKHJvdy50eXBlKSB7CiAgICAgICAgY2FzZSAxOgogICAgICAgICAgcmV0dXJuICJcdTZCQ0ZcdTk2OTQiLmNvbmNhdChyb3cuc2Vjb25kLCAiXHU3OUQyXHU2MjY3XHU4ODRDXHU0RTAwXHU2QjIxIik7CiAgICAgICAgY2FzZSAyOgogICAgICAgICAgcmV0dXJuICJcdTZCQ0ZcdTk2OTQiLmNvbmNhdChyb3cubWludXRlLCAiXHU1MjA2XHU5NDlGXHU2MjY3XHU4ODRDXHU0RTAwXHU2QjIxIik7CiAgICAgICAgY2FzZSAzOgogICAgICAgICAgcmV0dXJuICJcdTZCQ0ZcdTk2OTQiLmNvbmNhdChyb3cuaG91ciwgIlx1NUMwRlx1NjVGNlx1NjI2N1x1ODg0Q1x1NEUwMFx1NkIyMSIpOwogICAgICAgIGNhc2UgNDoKICAgICAgICAgIHJldHVybiAiXHU2QkNGXHU5Njk0Ii5jb25jYXQocm93LmRheSwgIlx1NTkyOVx1NjI2N1x1ODg0Q1x1NEUwMFx1NkIyMSIpOwogICAgICAgIGNhc2UgNToKICAgICAgICAgIHJldHVybiAiXHU2QkNGXHU1OTI5Ii5jb25jYXQocm93LmhvdXIsICJcdTY1RjYiKS5jb25jYXQocm93Lm1pbnV0ZSwgIlx1NTIwNiIpLmNvbmNhdChyb3cuc2Vjb25kLCAiXHU3OUQyXHU2MjY3XHU4ODRDXHU0RTAwXHU2QjIxIik7CiAgICAgICAgY2FzZSA2OgogICAgICAgICAgcmV0dXJuICJcdTZCQ0ZcdTRFMkFcdTY2MUZcdTY3MUYiLmNvbmNhdChyb3cud2VlaywgIlx1NzY4NCIpLmNvbmNhdChyb3cuaG91ciwgIlx1NjVGNiIpLmNvbmNhdChyb3cubWludXRlLCAiXHU1MjA2IikuY29uY2F0KHJvdy5zZWNvbmQsICJcdTc5RDJcdTYyNjdcdTg4NENcdTRFMDBcdTZCMjEiKTsKICAgICAgICBjYXNlIDc6CiAgICAgICAgICByZXR1cm4gIlx1NkJDRlx1NjcwOCIuY29uY2F0KHJvdy5kYXksICJcdTY1RTVcdTc2ODQiKS5jb25jYXQocm93LmhvdXIsICJcdTY1RjYiKS5jb25jYXQocm93Lm1pbnV0ZSwgIlx1NTIwNiIpLmNvbmNhdChyb3cuc2Vjb25kLCAiXHU3OUQyXHU2MjY3XHU4ODRDXHU0RTAwXHU2QjIxIik7CiAgICAgIH0KICAgIH0sCiAgICAvLyDliJfooagKICAgIGdldExpc3Q6IGZ1bmN0aW9uIGdldExpc3QoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgIHRpbWVySW5kZXgoewogICAgICAgIHBhZ2U6IHRoaXMucGFnZSwKICAgICAgICBsaW1pdDogdGhpcy5saW1pdAogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBfdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgICAgdmFyIF9yZXMkZGF0YSA9IHJlcy5kYXRhLAogICAgICAgICAgY291bnQgPSBfcmVzJGRhdGEuY291bnQsCiAgICAgICAgICBsaXN0ID0gX3JlcyRkYXRhLmxpc3Q7CiAgICAgICAgX3RoaXMudG90YWwgPSBjb3VudDsKICAgICAgICBfdGhpcy50YWJsZURhdGEgPSBsaXN0OwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgX3RoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgIF90aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpOwogICAgICB9KTsKICAgIH0sCiAgICBhZGRUYXNrOiBmdW5jdGlvbiBhZGRUYXNrKCkgewogICAgICB0aGlzLiRyZWZzLmFkZFRhc2subW9kYWwgPSB0cnVlOwogICAgfSwKICAgIGVkaXQ6IGZ1bmN0aW9uIGVkaXQoaWQpIHsKICAgICAgdGhpcy4kcmVmcy5hZGRUYXNrLnRpbWVySW5mbyhpZCk7CiAgICB9LAogICAgLy8g5Yig6ZmkCiAgICBoYW5kbGVEZWxldGU6IGZ1bmN0aW9uIGhhbmRsZURlbGV0ZShyb3csIHRpdCwgbnVtKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwogICAgICB2YXIgZGVsZnJvbURhdGEgPSB7CiAgICAgICAgdGl0bGU6IHRpdCwKICAgICAgICBudW06IG51bSwKICAgICAgICB1cmw6ICJzeXN0ZW0vY3JvbnRhYi9kZWwvIi5jb25jYXQocm93LmlkKSwKICAgICAgICBtZXRob2Q6ICdkZWxldGUnLAogICAgICAgIGlkczogJycKICAgICAgfTsKICAgICAgdGhpcy4kbW9kYWxTdXJlKGRlbGZyb21EYXRhKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBfdGhpczIuJG1lc3NhZ2Uuc3VjY2VzcyhyZXMubXNnKTsKICAgICAgICBfdGhpczIuZ2V0TGlzdCgpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgX3RoaXMyLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDmmK/lkKblvIDlkK8KICAgIGhhbmRsZUNoYW5nZTogZnVuY3Rpb24gaGFuZGxlQ2hhbmdlKF9yZWYpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIHZhciBpZCA9IF9yZWYuaWQsCiAgICAgICAgaXNfb3BlbiA9IF9yZWYuaXNfb3BlbjsKICAgICAgc2hvd1RpbWVyKGlkLCBpc19vcGVuKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBfdGhpczMuJG1lc3NhZ2Uuc3VjY2VzcyhyZXMubXNnKTsKICAgICAgICBfdGhpczMuZ2V0TGlzdCgpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgX3RoaXMzLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpOwogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"names":["timerIndex","showTimer","creatTask","setting","name","components","data","loading","tableData","page","limit","total","apiBaseURL","created","getList","methods","taskTrip","row","type","concat","second","minute","hour","day","week","_this","then","res","_res$data","count","list","catch","$message","error","msg","addTask","$refs","modal","edit","id","timerInfo","handleDelete","tit","num","_this2","delfromData","title","url","method","ids","$modalSure","success","handleChange","_ref","_this3","is_open"],"sources":["src/pages/system/crontab/index.vue"],"sourcesContent":["<template>\n  <el-card :bordered=\"false\" shadow=\"never\">\n    <el-alert type=\"warning\" :closable=\"false\">\n      <template slot=\"title\">\n        启动定时任务两种方式：<br />\n        1、使用命令启动：php think timer start\n        --d；如果更改了执行周期、编辑是否开启、删除定时任务需要重新启动下定时任务确保生效；<br />\n        2、使用接口触发定时任务，建议每分钟调用一次，接口地址 {{apiBaseURL}}/api/crontab/run <br />\n        开发说明：新增定时任务在 /crmeb/app/services/system/crontab/CrontabRunServices.php 文件中新增任务方法代码\n      </template>\n    </el-alert>\n    <el-button type=\"primary\" @click=\"addTask\" class=\"mt14\">添加定时任务</el-button>\n    <el-table :data=\"tableData\" v-loading=\"loading\" class=\"ivu-mt\">\n      <el-table-column label=\"标题\" min-width=\"150\">\n        <template slot-scope=\"scope\">\n          <span>{{ scope.row.name }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"任务说明\" min-width=\"130\">\n        <template slot-scope=\"scope\">\n          <span>{{ scope.row.content }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"执行周期\" min-width=\"130\">\n        <template slot-scope=\"scope\">\n          <span>{{ taskTrip(scope.row) }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"是否开启\" min-width=\"130\">\n        <template slot-scope=\"scope\">\n          <el-switch\n            class=\"defineSwitch\"\n            :active-value=\"1\"\n            :inactive-value=\"0\"\n            v-model=\"scope.row.is_open\"\n            size=\"large\"\n            @change=\"handleChange(scope.row)\"\n            active-text=\"开启\"\n            inactive-text=\"关闭\"\n          >\n          </el-switch>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"操作\" width=\"100\">\n        <template slot-scope=\"scope\">\n          <a @click=\"edit(scope.row.id)\">编辑</a>\n          <el-divider direction=\"vertical\"></el-divider>\n          <a v-permission=\"'seckill'\" @click=\"handleDelete(scope.row, '删除秒杀商品', scope.$index)\">删除</a>\n        </template>\n      </el-table-column>\n    </el-table>\n    <div class=\"acea-row row-right page\">\n      <pagination v-if=\"total\" :total=\"total\" :page.sync=\"page\" :limit.sync=\"limit\" @pagination=\"getList\" />\n    </div>\n    <creatTask ref=\"addTask\" @submitAsk=\"getList\"></creatTask>\n  </el-card>\n</template>\n\n<script>\nimport { timerIndex, showTimer } from '@/api/system';\nimport creatTask from './createModal.vue';\nimport setting from '@/setting';\nexport default {\n  name: 'system_crontab',\n  components: { creatTask },\n  data() {\n    return {\n      loading: false,\n      tableData: [],\n      page: 1,\n      limit: 15,\n      total: 1,\n      apiBaseURL: '',\n    };\n  },\n  created() {\n    this.apiBaseURL = setting.apiBaseURL\n    this.getList();\n  },\n  methods: {\n    taskTrip(row) {\n      switch (row.type) {\n        case 1:\n          return `每隔${row.second}秒执行一次`;\n        case 2:\n          return `每隔${row.minute}分钟执行一次`;\n        case 3:\n          return `每隔${row.hour}小时执行一次`;\n        case 4:\n          return `每隔${row.day}天执行一次`;\n        case 5:\n          return `每天${row.hour}时${row.minute}分${row.second}秒执行一次`;\n        case 6:\n          return `每个星期${row.week}的${row.hour}时${row.minute}分${row.second}秒执行一次`;\n        case 7:\n          return `每月${row.day}日的${row.hour}时${row.minute}分${row.second}秒执行一次`;\n      }\n    },\n    // 列表\n    getList() {\n      this.loading = true;\n      timerIndex({\n        page: this.page,\n        limit: this.limit,\n      })\n        .then((res) => {\n          this.loading = false;\n          let { count, list } = res.data;\n          this.total = count;\n          this.tableData = list;\n        })\n        .catch((res) => {\n          this.loading = false;\n          this.$message.error(res.msg);\n        });\n    },\n    addTask() {\n      this.$refs.addTask.modal = true;\n    },\n    edit(id) {\n      this.$refs.addTask.timerInfo(id);\n    },\n    // 删除\n    handleDelete(row, tit, num) {\n      let delfromData = {\n        title: tit,\n        num: num,\n        url: `system/crontab/del/${row.id}`,\n        method: 'delete',\n        ids: '',\n      };\n      this.$modalSure(delfromData)\n        .then((res) => {\n          this.$message.success(res.msg);\n          this.getList();\n        })\n        .catch((res) => {\n          this.$message.error(res.msg);\n        });\n    },\n    // 是否开启\n    handleChange({ id, is_open }) {\n      showTimer(id, is_open)\n        .then((res) => {\n          this.$message.success(res.msg);\n          this.getList();\n        })\n        .catch((res) => {\n          this.$message.error(res.msg);\n        });\n    },\n  },\n};\n</script>\n\n<style lang=\"stylus\" scoped>\n.ivu-mt {\n  padding-top:10px\n}\n</style>\n"],"mappings":"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","ignoreList":[]}]}